<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.14: http://docutils.sourceforge.net/" />
<meta name="version" content="S5 1.1" />
<title>Review Opticks + JUNO</title>
<meta content="Navigate the HTML slides by entering a page number and pressing return" name="note" />
<meta content="Review JUNO + Opticks : GPU Optical Photon Simulation with NVIDIA OptiX" name="title" />
<meta content="Awareness Jump, Hits completed, Plan" name="description" />
<meta content="JUNO Collaboration Meeting, IHEP Virtual" name="event" />
<meta content="1 Feb 2021" name="date" />
<meta content="20 minutes" name="length" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<script src="ui/my-small-white/slides.js" type="text/javascript"></script>
<link rel="stylesheet" href="ui/my-small-white/slides.css"
      type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/my-small-white/outline.css"
      type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/my-small-white/print.css"
      type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/my-small-white/opera.css"
      type="text/css" media="projection" id="operaFix" />
</head>
<body>
<div class="layout">
<div id="controls"></div>
<div id="currentSlide"></div>
<div id="header">

</div>
<div id="footer">
<h1><span class="i">Review Opticks + JUNO</span></h1>

</div>
</div>
<div class="presentation">
<div class="slide" id="slide0">
<h1 class="title"><span class="i">Review Opticks + JUNO</span></h1>

<!-- comment

https://docutils.sourceforge.io/docutils/parsers/rst/include/

https://docutils.sourceforge.io/docutils/parsers/rst/include/isogrk1.txt

.. raw:: html

   <span>&nbsp;</span>

.. raw:: html

   <hr/>

.. class:: small


    +- - - - - - - - - - - -+- - - - - - - - - - - -+- - - - - - - - - - -+
    | Header 1     Header 2     Header 3  |
    +- - - - - - - - - - - -+- - - - - - - - - - - -+- - - - - - - - - - -+
    | Header 1   | Header 2   | Header 3  |
    +============+============+===========+
    | body row 1 | column 2   | column 3  |
    +- - - - - - - - - - - -+- - - - - - - - - - - -+- - - - - - - - - - -+
    | body row 2 | Cells may span columns.|
    +- - - - - - - - - - - -+- - - - - - - - - - - -+- - - - - - - - - - -+
    | body row 3 | Cells may  | - Cells   |
    +- - - - - - - - - - - -+ span rows. | - contain |
    | body row 4 |            | - blocks. |
    +- - - - - - - - - - - -+- - - - - - - - - - - -+- - - - - - - - - - -+ -->
<!-- Definitions of interpreted text roles (classes) for S5/HTML data. -->
<!-- This data file has been placed in the public domain. -->
<!-- Colours
======= -->
<!-- Text Sizes
========== -->
<!-- Display in Slides (Presentation Mode) Only
========================================== -->
<!-- Display in Outline Mode Only
============================ -->
<!-- Display in Print Only
===================== -->
<!-- Display in Handout Mode Only
============================ -->
<!-- Incremental Display
=================== -->
<!-- This data file has been placed in the public domain. -->
<!-- Derived from the Unicode character mappings available from
<http://www.w3.org/2003/entities/xml/>.
Processed by unicode2rstsubs.py, part of Docutils:
<http://docutils.sourceforge.net>. -->
<!-- This data file has been placed in the public domain. -->
<!-- Derived from the Unicode character mappings available from
<http://www.w3.org/2003/entities/xml/>.
Processed by unicode2rstsubs.py, part of Docutils:
<http://docutils.sourceforge.net>. -->

       <style type="text/css">

          div.slide { 
             background-clip: border-box;
             background-repeat: no-repeat;
             height: 100%;
          }
          div.slide#slide0{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-wide_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-benefits{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-wide_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#visualizing-an-optical-photon-simulation{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-wide_crop.png);
             background-size: 640px 360px;
             background-position: 600px 100px;
             
          }
          div.slide#overview{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-wide_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#g4daeview-py-fast-opengl-3d-viewer-for-g4dae-files{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20140419-170713.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#cerenkov-photons-simulation-top-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-115923.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#cerenkov-photons-simulation-side-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-115935.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#scintillation-photons-simulation-top-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-121444.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#scintillation-photons-simulation-side-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-121435.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#standard-geant4-workflow{
             background-image: url(/env/keynotefigs/G4DAEChroma/G4DAEChroma.001.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#external-photon-simulation-workflow{
             background-image: url(/env/keynotefigs/G4DAEChroma/G4DAEChroma.002.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#geant4opticksworkflow{
             background-image: url(/env/Documents/Geant4OpticksWorkflow/Geant4OpticksWorkflow.001.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#ggeoview{
             background-image: url(/env/graphics/ggeoview/ggeoview-cerenkov-001.png);
             background-size: 1047px 795px;
             background-position: 0px 0px;
             
          }
          div.slide#ggeoview-m1-points{
             background-image: url(/env/graphics/ggeoview/ggeoview-scintillation-points-mat1.png);
             background-size: 1435px 848px;
             background-position: 0px 0px;
             
          }
          div.slide#ggeoview-flag-selection{
             background-image: url(/env/graphics/ggeoview/ggeoview-scintillation-flag-seq-select.png);
             background-size: 1436px 842px;
             background-position: 0px 0px;
             
          }
          div.slide#ggeoview-cerenkov-geom-m1{
             background-image: url(/env/graphics/ggeoview/ggeoview-cerenkov-m1-geom.png);
             background-size: 1416px 845px;
             background-position: 0px 0px;
             
          }
          div.slide#detecting-neutrinos-via-optical-photons-1{
             background-image: url(/env/presentation/dayabay-principal_half.png);
             background-size: 1417px 830px;
             background-position: 0px 0px;
             
          }
          div.slide#detecting-neutrinos-via-optical-photons-2{
             background-image: url(/env/presentation/dayabay-principal_half.png);
             background-size: 1417px 830px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-inside-wide{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-wide_half.png);
             background-size: 1432px 844px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-wide{
             background-image: url(/env/graphics/ggeoview/jpmt-wide_half.png);
             background-size: 1409px 836px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-headview{
             background-image: url(/env/graphics/ggeoview/jpmt-headview_half.png);
             background-size: 1308px 783px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-backview{
             background-image: url(/env/graphics/ggeoview/jpmt-backview_half.png);
             background-size: 1149px 794px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-approach{
             background-image: url(/env/graphics/ggeoview/jpmt-approach_half.png);
             background-size: 1431px 839px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-arrival{
             background-image: url(/env/graphics/ggeoview/jpmt-arrival_half.png);
             background-size: 1427px 841px;
             background-position: 0px 0px;
             
          }
          div.slide#optical-photon-simulation-problem{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-optical-photon-simulation-problem{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-before-contact{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-before-contact-2{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-before-contact-3{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-after-contact{
             background-image: url(/env/graphics/ggeoview/jpmt-after-contact_half.png);
             background-size: 1425px 840px;
             background-position: 0px 0px;
             
          }
          div.slide#jpmt-inside-outside{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-outside_half.png);
             background-size: 1401px 842px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-optix-in-action{
             background-image: url(/env/presentation/optix-in-action_half.png);
             background-size: 966px 646px;
             background-position: 100px 50px;
             
          }
          div.slide#pmtinbox-approach-1{
             background-image: url(/env/graphics/ggeoview/PmtInBox-approach.png);
             background-size: 1069px 769px;
             background-position: 0px 0px;
             
          }
          div.slide#pmtinbox-approach-2{
             background-image: url(/env/graphics/ggeoview/PmtInBox-approach.png);
             background-size: 1069px 769px;
             background-position: 0px 0px;
             
          }
          div.slide#pmtinbox-after-1{
             background-image: url(/env/graphics/ggeoview/PmtInBox-after.png);
             background-size: 1057px 760px;
             background-position: 0px 0px;
             
          }
          div.slide#pmtinbox-after-2{
             background-image: url(/env/graphics/ggeoview/PmtInBox-after.png);
             background-size: 1057px 760px;
             background-position: 0px 0px;
             
          }
          div.slide#daya-bay-pmt-wall-photo-1{
             background-image: url(/env/presentation/gtc2016/dyb-pmt-wall-photo.png);
             background-size: 1329px 798px;
             background-position: 0px 0px;
             
          }
          div.slide#daya-bay-pmt-wall-photo-2{
             background-image: url(/env/presentation/gtc2016/dyb-pmt-wall-photo.png);
             background-size: 1329px 798px;
             background-position: 0px 0px;
             
          }
          div.slide#super-kamiokande-pmts-not-16-9{
             background-image: url(/env/presentation/gtc2016/sk-PH20-water-withboat-apr23-wm.png);
             background-size: 1181px 771px;
             background-position: 0px 0px;
             
          }
          div.slide#super-kamiokande-pmts-1{
             background-image: url(/env/presentation/PH20-water-withboat-apr23-wm_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#super-kamiokande-pmts-2{
             background-image: url(/env/presentation/PH20-water-withboat-apr23-wm_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#super-kamiokande-pmts-3{
             background-image: url(/env/presentation/PH20-water-withboat-apr23-wm_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#super-kamiokande-pmts-4{
             background-image: url(/env/presentation/PH20-water-withboat-apr23-wm_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#kamiokande-ii-1{
             background-image: url(/env/presentation/1987a.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#kamiokande-ii-2{
             background-image: url(/env/presentation/1987a.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#kamiokande-ii-3{
             background-image: url(/env/presentation/1987a.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#fast-optical-photon-simulation{
             background-image: url(/env/presentation/newtons-opticks.png);
             background-size: 374px 684px;
             background-position: 800px 0px;
             
          }
          div.slide#photomultiplier-tubes-pmts{
             background-image: url(/env/presentation/hamamatsu-pmt-16x9.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#photomultiplier-tube-operation{
             background-image: url(/env/presentation/hamamatsu-pmt-16x9.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#old-hamamatsu-photomultiplier-tubes-pmts{
             background-image: url(/env/presentation/hamamatsu-pmt.png);
             background-size: 1099px 734px;
             background-position: 0px 0px;
             
          }
          div.slide#old-photomultiplier-tube-operation{
             background-image: url(/env/presentation/hamamatsu-pmt.png);
             background-size: 1099px 734px;
             background-position: 0px 0px;
             
          }
          div.slide#jiangmen-underground-neutrino-observatory-juno{
             background-image: url(/env/presentation/juno-schematic-5.png);
             background-size: 1391px 734px;
             background-position: 0px 0px;
             
          }
          div.slide#jiangmen-underground-neutrino-observatory-goals{
             background-image: url(/env/presentation/juno-schematic-5.png);
             background-size: 1391px 734px;
             background-position: 0px 0px;
             
          }
          div.slide#dayabay-reactor-neutrino-expt-far-site{
             background-image: url(/env/presentation/DybFar_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#daya-bay-far-site-2{
             background-image: url(/env/presentation/DybFar_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#daya-bay-far-site-3{
             background-image: url(/env/presentation/DybFar_crop.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#geant4-monte-carlo-simulation-toolkit{
             background-image: url(/env/presentation/g4-hep.png);
             background-size: 1025px 621px;
             background-position: 100px 100px;
             
          }
          div.slide#geant4-monte-carlo-simulation-toolkit-generality{
             background-image: url(/env/presentation/g4-hep.png);
             background-size: 1025px 621px;
             background-position: 100px 100px;
             
          }
          div.slide#seeing-neutrinos-via-scintillation-cherenkov-light{
             background-image: url(/env/presentation/cherenkov.png);
             background-size: 316px 203px;
             background-position: 850px 400px;
             
          }
          div.slide#opticks-auto-instancing{
             background-image: url(/env/graphics/ggeoview/ggv-juno-instancing.png);
             background-size: 852px 592px;
             background-position: 450px 80px;
             
          }
          div.slide#nvidia-optix-1{
             background-image: url(/env/presentation/NVIDIAOptiXWebsite_Oct2016.png);
             background-size: 1280px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-optix-2{
             background-image: url(/env/presentation/NVIDIAOptiXWebsite_Oct2016.png);
             background-size: 1280px;
             background-position: 0px 0px;
             
          }
          div.slide#opticksdocs{
             background-image: url(/env/presentation/OpticksDocs.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#daya-bay-antineutrino-detection-via-inverse-beta-decay-1{
             background-image: url(/env/presentation/AntineutrinoDetectionViaIBDJetterSept2014.png);
             background-size: 809px 576px;
             background-position: 100px 100px;
             
          }
          div.slide#daya-bay-antineutrino-detection-via-inverse-beta-decay-2{
             background-image: url(/env/presentation/AntineutrinoDetectionViaIBDJetterSept2014.png);
             background-size: 809px 576px;
             background-position: 100px 100px;
             
          }
          div.slide#daya-bay-energy-response-model-1{
             background-image: url(/env/presentation/ZheTaupDetectorResponseModel.png);
             background-size: 968px 576px;
             background-position: 100px 100px;
             
          }
          div.slide#daya-bay-energy-response-model-2{
             background-image: url(/env/presentation/ZheTaupDetectorResponseModel.png);
             background-size: 968px 576px;
             background-position: 100px 100px;
             
          }
          div.slide#daya-bay-energy-response-model-fit-to-calibration-data-1{
             background-image: url(/env/presentation/EnergyResponseModel.png);
             background-size: 693px 504px;
             background-position: 0px 100px;
             
          }
          div.slide#daya-bay-energy-response-model-fit-to-calibration-data-2{
             background-image: url(/env/presentation/ConstrainingNonLinearity.png);
             background-size: 761px 553px;
             background-position: 0px 80px;
             
          }
          div.slide#daya-bay-ngd-analysis-most-precise-theta13{
             background-image: url(/env/presentation/DYBZheTaup2015Theta13OscillationAnalysis.png);
             background-size: 1057px 625px;
             background-position: 100px 60px;
             
          }
          div.slide#opticks-analytic-daya-bay-near-site-gpu-raytrace-3{
             background-image: url(/env/presentation/op_full_raytrace_3.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-analytic-daya-bay-near-site-gpu-raytrace-1{
             background-image: url(/env/presentation/op_full_raytrace_1.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-analytic-daya-bay-near-site-gpu-raytrace-0{
             background-image: url(/env/presentation/op_full_raytrace_0.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-analytic-daya-bay-near-site-gpu-raytrace-2{
             background-image: url(/env/presentation/op_full_raytrace_2.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-analytic-juno-chimney-gpu-raytrace-0{
             background-image: url(/env/presentation/j1707_chimney_analytic_raytrace.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-analytic-juno-pmt-snap-gpu-raytrace-1{
             background-image: url(/env/presentation/j1707-okop-snap.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#gpu-instance-culling-with-level-of-detail{
             background-image: url(/env/presentation/j1707_lod_oglrap_instcull.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-export-of-g4-geometry-to-gltf-2-0{
             background-image: url(/env/yoctoglrap/dyb_near_venice_half.png);
             background-size: 1020px 737px;
             background-position: 0px 0px;
             
          }
          div.slide#what-are-numpy-arrays{
             background-image: url(/env/presentation/what_are_numpy_arrays.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#what-are-numpy-arrays-2{
             background-image: url(/env/presentation/what_are_numpy_arrays.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#bvh{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_029.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#spatial-index-acceleration-structure{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_029.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#rendering-five-decades-of-research-1{
             background-image: url(/env/presentation/nvidia/rendering_five_decades_of_research.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#rendering-five-decades-of-research-2{
             background-image: url(/env/presentation/nvidia/rendering_five_decades_of_research.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#path-tracing-in-production-1{
             background-image: url(/env/presentation/sigraph/PathTracingInProduction_001.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#path-tracing-in-production-2{
             background-image: url(/env/presentation/sigraph/PathTracingInProduction_001.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#bvh-pascal{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_030.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#bvh-turing{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_031.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#hardware-traversal-of-bvh-spatial-index{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_031.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#siggraph-2018-announcing-worlds-first-ray-tracing-gpu{
             background-image: url(/env/presentation/nvidia/SIGGRAPH_2018_Announcing_Worlds_First_Ray_Tracing_GPU_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#siggraph-2019-eric-enderton-rt-cores{
             background-image: url(/env/presentation/nvidia/SIGGRAPH_2019_Eric_Enderton_RT_Cores.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-optix-ai-denoiser-1{
             background-image: url(/env/presentation/nvidia_demo/nvidia_optix_ai_denoiser.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-optix-ai-denoiser-2{
             background-image: url(/env/presentation/nvidia_demo/nvidia_optix_ai_denoiser.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#samples-per-pixel-1{
             background-image: url(/env/presentation/nvidia/NVIDIA_samples_per_pixel_MDL_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#samples-per-pixel-2{
             background-image: url(/env/presentation/nvidia/NVIDIA_samples_per_pixel_MDL_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#photon-mapping-1{
             background-image: url(/env/presentation/photon_mapping/PhotonMapping_001.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#photon-mapping-2{
             background-image: url(/env/presentation/photon_mapping/PhotonMapping_002.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#eric-haines-nvidia-ray-tracing-essentials-part-6-the-rendering-equation{
             background-image: url(/env/presentation/nvidia/NVIDIA_Eric_Haines_Ray_Tracing_Essentials_Part_6_The_Rendering_Equation.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#physically-based-rendering-book-www-pbr-book-org{
             background-image: url(/env/presentation/pbr/Physically_Based_Rendering_Book_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#the-rendering-equation-1{
             background-image: url(/env/presentation/rendering_equation/TheRenderingEquation_001.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#the-rendering-equation-2{
             background-image: url(/env/presentation/rendering_equation/TheRenderingEquation_002.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#project-sol{
             background-image: url(/env/presentation/nvidia_demo/project_sol_jacob_norris_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-turing-gpu-72-sm-4608-cuda-cores{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_009.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-turing-gpu-72-sm-4608-cuda-cores-spec{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_009.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#raytrace-vs-raster{
             background-image: url(/env/presentation/nvidia/NV_Turing_Editors_Day_132.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#ray-tracing-vs-rasterization{
             background-image: url(/env/presentation/nvidia/black.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#raytrace-diagram{
             background-image: url(/env/presentation/graphics/1024px-ray_trace_diagram.svg.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#j1808-top-ogl{
             background-image: url(/env/presentation/j1808/j1808_top_ogl.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#j1808-top-rtx{
             background-image: url(/env/presentation/j1808/j1808_top_rtx.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#j1808-escapes{
             background-image: url(/env/presentation/j1808/j1808_escapes.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#geocache-360{
             background-image: url(/env/presentation/geocache_360.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#geocache-360-2{
             background-image: url(/env/presentation/geocache_360.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-360-benchmark-with-optix-6-0-0-rtx-mode{
             background-image: url(/env/presentation/geocache_360.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#absmry-1m{
             background-image: url(/env/presentation/ana/absmry_1M.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#absmry-1m-2{
             background-image: url(/env/presentation/ana/absmry_1M.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#ta34-1m{
             background-image: url(/env/presentation/ana/ta34_1M.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#ta34-1m-2{
             background-image: url(/env/presentation/ana/ta34_1M.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#tv34-1m-a{
             background-image: url(/env/presentation/ana/tv34_1M_a.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#tv34-1m-b{
             background-image: url(/env/presentation/ana/tv34_1M_b.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#tv21-1m-a{
             background-image: url(/env/presentation/ana/tv21_1M_a.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#tv21-1m-a-2{
             background-image: url(/env/presentation/ana/tv21_1M_a.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#tv21-1m-c{
             background-image: url(/env/presentation/ana/tv21_1M_c.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#rtx-speedup{
             background-image: url(/env/presentation/ana/RTX_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#overheads{
             background-image: url(/env/presentation/ana/Overheads.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-speedup{
             background-image: url(/env/presentation/ana/Opticks_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-vs-geant4{
             background-image: url(/env/presentation/ana/Opticks_vs_Geant4.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-vs-geant4-2{
             background-image: url(/env/presentation/ana/Opticks_vs_Geant4.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nhit{
             background-image: url(/env/presentation/ana/NHit.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#interval-over-launch{
             background-image: url(/env/presentation/ana/Interval_over_Launch.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#titan-rtx-72-raytrace-dedicated-rt-cores-4608-cuda-cores-24gb-vram-2500-usd{
             background-image: url(/env/presentation/nvidia/TITAN_RTX.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#bench-20190526-143808{
             background-image: url(/env/presentation/ana/bench_20190526_143808.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#bench-20190526-143808-2{
             background-image: url(/env/presentation/ana/bench_20190526_143808.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#bench-20190526-202537{
             background-image: url(/env/presentation/ana/bench_20190526_202537.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#bench-20190526-202537-2{
             background-image: url(/env/presentation/ana/bench_20190526_202537.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#tv16-fastener{
             background-image: url(/env/presentation/tv/tv16_Fastener.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#tv20-polycone-neck{
             background-image: url(/env/presentation/tv/tv20_polycone_neck.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#tubs-torus-polycone-pmt20inch-polycone-neck{
             background-image: url(/env/presentation/tv/tv20_polycone_neck.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#inch-pmt-neck-cylinder-torus-polycone{
             background-image: url(/env/presentation/tv/tv20_polycone_neck.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#genstep-interface{
             background-image: url(/env/presentation/simulation/genstep_interface.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#introducing-optix-7{
             background-image: url(/env/presentation/nvidia/Introducing_OptiX_7.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#where-next-for-opticks{
             background-image: url(/env/presentation/nvidia/Introducing_OptiX_7.png);
             background-size: 640px 360px;
             background-position: 670px 300px;
             
          }
          div.slide#opticks-experience-problems-with-using-nvidia-optix{
             background-image: url(/env/presentation/nvidia/Introducing_OptiX_7.png);
             background-size: 640px 360px;
             background-position: 670px 300px;
             
          }
          div.slide#nvidia-optix-7-entirely-new-thin-api{
             background-image: url(/env/presentation/nvidia/Introducing_OptiX_7.png);
             background-size: 640px 360px;
             background-position: 670px 300px;
             
          }
          div.slide#turing-built-for-rtx{
             background-image: url(/env/presentation/nvidia/TURING_Built_for_RTX_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#turing-built-for-rtx-2{
             background-image: url(/env/presentation/nvidia/TURING_Built_for_RTX_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-rtx-metro-exodus{
             background-image: url(/env/presentation/nvidia/NVIDIA_RTX_Metro_Exodus_half.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#modern-gpu-ray-tracing{
             background-image: url(/env/presentation/nvidia/Modern_GPU_RAY_Tracing.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-optix-programming-model-analogous-to-rasterization-apis-opengl-shaders{
             background-image: url(/env/presentation/nvidia/Modern_GPU_RAY_Tracing.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#nvidia-quadro-rtx-8000-48g{
             background-image: url(/env/presentation/nvidia/NVIDIA_Quadro_RTX.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#siggraph-2010-optix-a-general-purpose-ray-tracing-engine{
             background-image: url(/env/presentation/nvidia/SIGGRAPH_2010_OptiX_A_General_Purpose_Ray_Tracing_Engine.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#useful-speedup-1500x-but-why-not-giga-rays-s-1-photon-10-rays{
             background-image: url(/env/presentation/nvidia/dhart/dhart_siggraph_2019_RTX_traversal_custom_primitives.png);
             background-size: 720px 405px;
             background-position: 10px 210px;
             
          }
          div.slide#juno-intro-1{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.001.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-2{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.002.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-3{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.003.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-4{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.004.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-5{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.005.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-6{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.006.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-7{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.007.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-8{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.008.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-9{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.009.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-intro-10{
             background-image: url(/env/Documents/JUNOIntro/JUNOIntro.010.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#juno-multipurpose-pedro-nufact-2019{
             background-image: url(/env/presentation/juno/JUNO_Multipurpose_Pedro_NuFact_2019.png);
             background-size: 960px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#dhart-siggraph-2019-optix-5-traversal{
             background-image: url(/env/presentation/nvidia/dhart_siggraph_2019_OptiX_5_traversal.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#dhart-siggraph-2019-optix-5-traversal{
             background-image: url(/env/presentation/nvidia/dhart_siggraph_2019_OptiX_5_traversal.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-check-gui-to-bt5-sd{
             background-image: url(/env/presentation/ana/scan-pf-1/scan-pf-check-GUI-TO-BT5-SD.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-check-gui-to-sc-bt5-sd{
             background-image: url(/env/presentation/ana/scan-pf-1/scan-pf-check-GUI-TO-SC-BT5-SD.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-interval-over-launch{
             background-image: url(/env/presentation/ana/scan-pf-0/Interval_over_Launch.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-nhit{
             background-image: url(/env/presentation/ana/scan-pf-0/NHit.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-opticks-speedup{
             background-image: url(/env/presentation/ana/scan-pf-0/Opticks_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-opticks-vs-geant4{
             background-image: url(/env/presentation/ana/scan-pf-0/Opticks_vs_Geant4.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-overheads{
             background-image: url(/env/presentation/ana/scan-pf-0/Overheads.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-rtx-speedup{
             background-image: url(/env/presentation/ana/scan-pf-0/RTX_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-0-rtx-speedup-2{
             background-image: url(/env/presentation/ana/scan-pf-0/RTX_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-interval-over-launch{
             background-image: url(/env/presentation/ana/scan-pf-1/Interval_over_Launch.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-nhit{
             background-image: url(/env/presentation/ana/scan-pf-1/NHit.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-opticks-speedup{
             background-image: url(/env/presentation/ana/scan-pf-1/Opticks_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-opticks-speedup-2{
             background-image: url(/env/presentation/ana/scan-pf-1/Opticks_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-opticks-vs-geant4{
             background-image: url(/env/presentation/ana/scan-pf-1/Opticks_vs_Geant4.png);
             background-size: 1280px 720pxS;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-opticks-vs-geant4-2{
             background-image: url(/env/presentation/ana/scan-pf-1/Opticks_vs_Geant4.png);
             background-size: 1280px 720pxS;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-opticks-vs-geant4-with-html-table{
             background-image: url(/env/presentation/ana/scan-pf-1/Opticks_vs_Geant4_with_HTML_Table.png);
             background-size: 1280px 720pxS;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-overheads{
             background-image: url(/env/presentation/ana/scan-pf-1/Overheads.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#scan-pf-1-rtx-speedup{
             background-image: url(/env/presentation/ana/scan-pf-1/RTX_Speedup.png);
             background-size: 1280px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-translates-g4-geometry-to-gpu-without-approximation{
             background-image: url(/env/presentation/face_view_PMTs.png);
             background-size: 640px 360px;
             background-position: 20px 340px;
             
          }
          div.slide#cupy-numpy-api-some-of-scipy-accelerated-by-nvidia-cuda-curand-cublas-cusolver-cusparse-thrust-nccl{
             background-image: url(/env/presentation/cupy/cupy_is2.png);
             background-size: 1016px 377px;
             background-position: 150px 150px;
             
          }
          div.slide#cupy-easy-interface-to-nvidia-cuda-stack{
             background-image: url(/env/presentation/cupy/cupy_stack.png);
             background-size: 1075px 429px;
             background-position: 100px 100px;
             
          }
          div.slide#c-union-trick-common-with-cuda-mixed-type-arrays-simpler-faster{
             background-image: url(/env/presentation/cuda/float_as_int.png);
             background-size: 600px 89px;
             background-position: 40px 570px;
             
          }
          div.slide#neutrino-understanding{
             background-image: url(/env/presentation/neutrino/understanding_universe_planet_sun.png);
             background-size: 1111px 720px;
             background-position: 0px 0px;
             
          }
          div.slide#gpltcf-hamamatsur12860lmaskvirtual-subplotsfig{
             background-image: url(/env/presentation/ana/PolyconeNeck/gpltcf_HamamatsuR12860lMaskVirtual_SubPlotsFig.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#gpltcf-hamamatsur12860lmaskvirtual-subplotsfig-zoom{
             background-image: url(/env/presentation/ana/PolyconeNeck/gpltcf_HamamatsuR12860lMaskVirtual_SubPlotsFig_Zoom.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#gpltcf-hamamatsur12860lmaskvirtual-combizoom-subplotsfig{
             background-image: url(/env/presentation/ana/PolyconeNeck/gpltcf_HamamatsuR12860lMaskVirtual_combiZoom_SubPlotsFig.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#gpltcf-nnvtmcppmtlmaskvirtual-subplotsfig{
             background-image: url(/env/presentation/ana/PolyconeNeck/gpltcf_NNVTMCPPMTlMaskVirtual_SubPlotsFig.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#gpltcf-nnvtmcppmtlmaskvirtual-subplotsfig-zoom{
             background-image: url(/env/presentation/ana/PolyconeNeck/gpltcf_NNVTMCPPMTlMaskVirtual_SubPlotsFig_Zoom.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#gpltcf-nnvtmcppmtlmaskvirtual-combizoom-subplotsfig{
             background-image: url(/env/presentation/ana/PolyconeNeck/gpltcf_NNVTMCPPMTlMaskVirtual_combiZoom_SubPlotsFig.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#g4optickstest-demonstrates-geant4-opticks-hybrid-workflow{
             background-image: url(/env/presentation/fermilab_geant4_team/hans_nov2020_lar_tpc_p1_half.png),url(/env/presentation/fermilab_geant4_team/hans_nov2020_lar_tpc_p13_half.png);
             background-size: 640px 360px,640px 360px;
             background-position: 0px 360px,640px 360px;
              
          }
          div.slide#geant4-bug-2305{
             background-image: url(/env/presentation/fermilab_geant4_team/geant4_bugzilla_2305_half.png);
             background-size: 1180px 310px;
             background-position: 50px 10px;
             
          }
          div.slide#geant4-bug-2311{
             background-image: url(/env/presentation/fermilab_geant4_team/geant4_bugzilla_2311_half.png);
             background-size: 1180px 310px;
             background-position: 50px 10px;
             
          }
          div.slide#lhcb-rich-ring-imaging-cherenkov-with-opticks-sajan-easo{
             background-image: url(/env/presentation/lhcb_rich_sajan_easo/sajan_easo_prospects_june_2020_p3_half.png),url(/env/presentation/lhcb_rich_sajan_easo/sajan_easo_prospects_june_2020_p8_half.png);
             background-size: 640px 360px,640px 360px;
             background-position: 0px 360px,640px 360px;
              
          }
          div.slide#groups-io-1{
             background-image: url(/env/presentation/groups_io/groups_io_jan_2021_25_members_33_topics_half.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#groups-io-2{
             background-image: url(/env/presentation/groups_io/groups_io_jan_2021_message_history_table_half.png);
             background-size: auto auto;
             background-position: 0px 0px;
             
          }
          div.slide#opticks-corsika8-for-next-generation-neutrino-telescope-optimization{
             background-image: url(/env/presentation/sjtu_fan_hu_oceanic/fan_hu_pod_strings_geometry_half.png);
             background-size: 640px 360px;
             background-position: 640px 360px;
             
          }
          div.slide#uk-swift-hep-grant-software-infrastructure-and-technology-for-hep{
             background-image: url(/env/presentation/ben_morgan_SwiftHEP_jan_2021/detector_simulation_swiftHEP_p1_half.png),url(/env/presentation/ben_morgan_SwiftHEP_jan_2021/detector_simulation_swiftHEP_p19_half.png);
             background-size: 640px 360px,640px 360px;
             background-position: 0px 360px,640px 360px;
              
          }
          div.slide#lz-opticks-history-2018-2021-contacts-with-5-lz-people{
             background-image: url(/env/presentation/nersc_creaner/optical_sims_using_gpus_half.png),url(/env/presentation/nersc_creaner/lz_motivation_to_gpus_half.png);
             background-size: 640px 360px,640px 360px;
             background-position: 0px 360px,640px 360px;
              
          }
          div.slide#lz-opticks-simulation-on-perlmutter-6000-nvidia-a100{
             background-image: url(/env/presentation/nersc_creaner/perlmutter_half.png);
             background-size: 640px 360px;
             background-position: 640px 360px;
             
          }
          div.slide#opticks-juno-progress-efficiency-hit-culling-on-gpu{
             background-image: url(/env/presentation/optixrap/OSensorLibGeoTest_half.png);
             background-size: 640px 360px;
             background-position: 640px 360px;
             
          } 

       </style>
    <!-- comment

1280px_720px
640px_360px

NVIDIA
                    Memory    Bandwidth     CUDA(RT) Cores
TITAN V             12 GB       651 GB/s    5120(0)
Tesla V100          32 GB       900 GB/s    5120(0)
TITAN RTX           24 GB       672 GB/s    4608(72)
Quadro RTX 8000     48 GB       672 GB/s    4608(72)

SM*64 gives cores

https://www.techpowerup.com/gpu-specs/titan-v.c3051
https://www.techpowerup.com/gpu-specs/titan-rtx.c3311
https://www.techpowerup.com/gpu-specs/quadro-rtx-8000.c3306 -->
<style type="text/css">

    .strike { text-decoration: line-through; }
    .center {text-align: center;}

    span.alarm { color: red; }
    span.blue { color: blue; }
    span.warn { color: orange; }
    span.ok { color: green; }
    span.i { display: none; }
    pre.sliteral { class:"literal-block small"; }
    pre.mypre {
         display: block;
         font-family: monospace;
         font-size: 20px;
         white-space: pre;
         margin: 1em 0;
    }

    pre.mypretiny {
         display: block;
         font-family: monospace;
         font-size: 15px;
         white-space: pre;
         margin: 1em 0;
    }

    pre.myfoot {
         display: block;
         font-family: monospace;
         font-size: 18px;
         white-space: pre;
         color: white;
         position: absolute; top:86%; left:4%; width:50%; height:10% ;
    }

    a.mylink {
         display: block;
         font-family: monospace;
         font-size: 18px;
         white-space: pre;
         color: black;
         position: absolute; top:86%; left:4%; width:50%; height:10% ;
    }


    div.mytitle {
         font-size: 20px;
         color: black;
         position: absolute; top:0%; left:5%; width:90%; height:10% ;
    }

    div.mytitle2 {
         font-size: 20px;
         color: black;
         position: absolute; top:5%; left:5%; width:90%; height:10% ;
    }



    div.mycredit {
         font-size: 20px;
         color: black;
         position: absolute; top:90%; left:5%; width:80%; height:10% ;
    }

    div.mysidebar {
        margin: 0 0 0.5em 1em;
        border: medium outset;
        padding: 1em;
        background-color: #ffffee;
        width: 20%;
        float: right;
        clear: right;
    }

    table.mytable th {
         background-color: #ede;
    }
    table.mytable tr:nth-child(even) {
        background-color: #F3F3FF;
    }
    table.mytable tr:nth-child(odd) {
        background-color: #FFFFEE;
    }


</style><!-- comment

TODO

p19: Improve task titles, shortening if possible + add (progress summary or estimate) -->
<div class="mytitle">
<header>
<h1 style="background-color:lightgrey;text-align:center;">
      <span class="alarm">Review  </span> JUNO + <i>Opticks</i> : <br> GPU Optical Simulation with NVIDIA OptiX
    <h2 style="background-color:lightgrey;text-align:center"> Open source, https://bitbucket.org/simoncblyth/opticks </h2>
</h1>
</header>
</div>

<div class="mycredit">
<h2 style="background-color:lightgrey"> Simon C Blyth, IHEP, CAS &mdash; JUNO Collaboration Meeting, Jan/Feb 2021, Virtual</h2>
</div>
</div>
<div class="slide" id="review-opticks-juno-talk">
<h1><span class="i">Review Opticks + JUNO</span>  Talk</h1>
<p class="normal">This talk will review progress with Opticks and with its use in JUNO.</p>
<!-- comment

00:Title Page
01:Outline

Intro

    02:JUNO Optical Photon Simulation Problem...
    03:NVIDIA OptiX Ray Tracing Engine - - http://developer.nvidia.com/optix
    04:NVIDIA OptiX 7
    05:Geant4 Opticks Workflow
    06:Opticks : Translates G4 Geometry to GPU, Without Approximation
    07:Ray Trace Render

Leap+Group

    08:2020 : Leap in Opticks Awareness : Meetings, Publications >>> New Users
    09:2020 : Leap in Opticks Awareness >>> Some Users Getting Serious
    10:groups.io : Email Group + Web Archive

Geant4+Opticks News

    11:G4OpticksTest : Demonstrates Geant4 + Opticks hybrid workflow
    12:Geant4_Bug_2305
    13:Geant4_Bug_2311
    14:UK SWIFT-HEP grant : SoftWare InFrastructure and Technology for HEP

Opticks User News

    15:LHCb RICH (Ring Imaging Cherenkov) with Opticks : Sajan Easo
    16:Opticks+CORSIKA8 for next-generation neutrino telescope optimization ?
    17:LZ+Opticks history : 2018-2021 : contacts with >5 LZ people
    18:2021 : LZ+Opticks simulation on Perlmutter (>6000 NVIDIA A100)

JUNO+Opticks Progress

    19:Opticks + JUNP Progress : Efficiency Hit Culling on GPU
    20:Completing JUNO Hits : G4OpticksHit (4,4) + G4OpticksHitExtra (2,4)

Planning

    21:Opticks : Three Levels of Performance
    22:OpticksServer + Lightweight OpticksClients
    23:Releases for Opticks+JUNO validation comparing G4+Opticks vs G4

24:Summary and Links
25:Space

Extras

    26:Integration of JUNO + Opticks : Opticks is a JunoENV External
    27:Integration of Offline + Opticks : Where WITH_G4OPTICKS used ?
    28:Integration of Offline + Opticks : tut_detsim.py options
    29:JUNO Geometry : Remove Torus to enable translation to GPU -->
</div>
<div class="slide" id="outline">
<h1>Outline</h1>
<!-- comment

Title marker needs to be long for rst2rst.py matching -->
<img alt="/env/presentation/newtons-opticks.png" class="align-right" src="/env/presentation/newtons-opticks.png" style="width: 299px; height: 547px;" />
<ul class="small simple">
<li><span class="blue">Introduction (pp 2-7)</span><ul>
<li>Optical Photon Simulation Problem...</li>
<li>NVIDIA OptiX Ray Tracing Engine, NVIDIA OptiX 7</li>
<li>Geant4 + Opticks Hybrid Workflow</li>
<li>Opticks : Translates G4 Geometry to GPU, Without Approximation</li>
</ul>
</li>
<li><span class="blue">2020 : Leap in Opticks awareness and Users (pp 8-10)</span></li>
<li>Geant4+Opticks News (pp 11-14)<ul>
<li>G4OpticksTest : Fermilab Geant4 team</li>
<li>Geant4 Bugs 2305,2311</li>
<li>UK SWIFT-HEP grant : SoftWare InFrastructure and Technology for HEP</li>
</ul>
</li>
<li>Opticks User News (pp 15-18)<ul>
<li>LHCb RICH study, Sajan Easo</li>
<li>Opticks+CORSIKA8 next-generation neutrino telescope optimization, Fan Hu</li>
<li>LZ(dark matter search) prepare for Perlmutter with NVIDIA/NERSC engineers</li>
</ul>
</li>
<li>JUNO+Opticks Progress (pp 19-20)<ul>
<li>Efficiency Hit Culling on GPU</li>
<li>Completing JUNO hits</li>
</ul>
</li>
<li>JUNO+Opticks Plan (pp 21-23)<ul>
<li>Three levels of performance</li>
<li>OpticksServer + Lightweight OpticksClients</li>
<li>Releases for Opticks+JUNO validation comparing G4+Opticks vs G4</li>
</ul>
</li>
<li><span class="blue">Summary and Links (p24)</span></li>
</ul>
</div>
<div class="slide" id="outline-talk">
<h1>Outline Talk</h1>
<p class="normal">After a brief introduction I will cover:</p>
<ul class="normal simple">
<li>integration of Opticks with Geant4,</li>
<li>its increasingly widespread usage</li>
<li>progress on integration of Opticks with JUNO Offline</li>
<li>and the next steps.</li>
</ul>
</div>
<div class="slide" id="juno-optical-photon-simulation-problem">
<h1><span class="incremental">JUNO Optical Photon Simulation Problem...</span></h1>
<pre>







</pre><div class="sidebar">
<p class="first sidebar-title"><span class="small">Huge CPU Memory+Time Expense</span></p>
<dl class="small last docutils">
<dt><strong>JUNO Muon Simulation Bottleneck</strong></dt>
<dd>~99% CPU time, memory constraints</dd>
<dt><strong>Ray-Geometry intersection Dominates</strong></dt>
<dd>simulation is not alone in this problem...</dd>
<dt><strong>Optical photons : naturally parallel, simple :</strong></dt>
<dd><ul class="first last simple">
<li>produced by Cherenkov+Scintillation</li>
<li>yield only Photomultiplier hits</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="slide" id="juno-optical-photon-simulation-problem-talk">
<h1><span class="incremental">JUNO Optical Photon Simulation Problem...</span> Talk</h1>
<ul class="normal simple">
<li>I am sure your are all painfully familiar with the optical photon simulation problem,
not just in processing time but also the memory for all those millions of photons</li>
<li>Most of the time is taken finding intersections between photons and geometry.</li>
<li>This ray tracing bottleneck is exactly the same as faced by ray trace image rendering in computer graphics.</li>
</ul>
</div>
<div class="slide" id="nvidia-optix-ray-tracing-engine-http-developer-nvidia-com-optix">
<h1><span class="small">NVIDIA OptiX Ray Tracing Engine -- http://developer.nvidia.com/optix</span></h1>
<div class="sidebar">
<p class="first sidebar-title">OptiX Raytracing Pipeline</p>
<p class="small">Analogous to OpenGL rasterization pipeline:</p>
<img alt="/env/optix/docs/optix-model.png" class="last align-right" src="/env/optix/docs/optix-model.png" style="width: 450px;" />
</div>
<p class="small"><strong>OptiX makes GPU ray tracing accessible</strong></p>
<ul class="small simple">
<li><strong>accelerates</strong> ray-geometry intersections</li>
<li>simple : single-ray programming model</li>
<li>&quot;...free to use within any application...&quot;</li>
<li><span class="red">access RT Cores[1] with OptiX 6.0.0+ via RTX mode</span></li>
</ul>
<p class="small"><strong>NVIDIA expertise:</strong></p>
<ul class="small simple">
<li><span class="red">~linear scaling up to 4 GPUs</span></li>
<li>acceleration structure creation + traversal (Blue)</li>
<li>instanced sharing of geometry + acceleration structures</li>
<li>compiler optimized for GPU ray tracing</li>
</ul>
<p class="tiny"><tt class="docutils literal"><span class="pre">https://developer.nvidia.com/rtx</span></tt></p>
<p class="small"><strong>User provides (Yellow):</strong></p>
<ul class="small simple">
<li>ray generation</li>
<li>geometry bounding box, intersects</li>
</ul>
<p class="tiny">[1] Turing+ GPUs eg NVIDIA TITAN RTX</p>
</div>
<div class="slide" id="nvidia-optix-ray-tracing-engine-http-developer-nvidia-com-optix-talk">
<h1><span class="small">NVIDIA OptiX Ray Tracing Engine -- http://developer.nvidia.com/optix</span> Talk</h1>
<ul class="normal simple">
<li>NVIDIA OptiX provides GPUs accelerated ray-geometry intersection</li>
<li>but to benefit from it the geometry must be translated into
GPU appropriate forms totally different to the Geant4 geometry model</li>
</ul>
</div>
<div class="slide" id="nvidia-optix-7-entirely-new-thin-api">
<h1><span class="small">NVIDIA OptiX 7 : Entirely new thin API</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">NVIDIA OptiX 7 : Entirely new API</span></p>
<ul class="small last simple">
<li>introduced August 2019</li>
<li>low-level CUDA-centric thin API (Vulkan-ized)</li>
<li><span class="strike">near perfect scaling to 4 GPUs, for free</span></li>
<li>Major effort needed to support in Opticks</li>
</ul>
</div>
<p class="small"><strong>NVIDIA OptiX 7 Features</strong></p>
<ul class="small simple">
<li>Minimal host state</li>
<li>GPU memory <em>managed by application</em></li>
<li>GPU launches : explicit, asynchronous (CUDA streams)</li>
<li><span class="red">All host functions are thread-safe</span></li>
<li>Multi-GPU <em>managed by application</em></li>
</ul>
<p class="small"><strong>&quot;managed by application&quot; -&gt; difficult development</strong></p>
<ul class="small simple">
<li>lots of learning + expert assistance needed</li>
</ul>
<dl class="small docutils">
<dt><strong>Disadvantage</strong></dt>
<dd>Demands much more developer effort than OptiX 6</dd>
<dt><strong>Advantage</strong></dt>
<dd><p class="first">More control/flexibility over everything.</p>
<ul class="last simple">
<li>thread-safe : important for distributed Server/Client Opticks</li>
</ul>
</dd>
</dl>
</div>
<div class="slide" id="nvidia-optix-7-entirely-new-thin-api-talk">
<h1><span class="small">NVIDIA OptiX 7 : Entirely new thin API</span> Talk</h1>
<ul class="normal simple">
<li>Opticks current works with NVIDIA OptiX 6</li>
<li>OptiX 7 is an entirely new (and much slimmer) API</li>
<li>migration is unavoidable</li>
</ul>
</div>
<div class="slide" id="geant4opticksworkflow">
<h1><span class="i">Geant4OpticksWorkflow</span></h1>
</div>
<div class="slide" id="geant4opticksworkflow-talk">
<h1><span class="i">Geant4OpticksWorkflow</span> Talk</h1>
<p class="small">SMALL
This compares the standard workflow on the left to the hybrid approach on the right</p>
<p class="small">In the hybrid workflow, the generation of photons is moved
from the CPU to the GPU using &quot;Gensteps&quot; as a bridge.
The Genstep parameters include a number of photons, and the line segment
along which to generate them and anything else needed in the generation loop.</p>
<p class="small">Of course a port of the generation loop to CUDA is needed too.</p>
<p class="small">The hybrid approach means:</p>
<ul class="small simple">
<li>the optical photon simulation is entirely offloaded to the GPU</li>
<li>only PMT hits need CPU memory</li>
<li>actually I have recently taken this further, reducing the CPU memory
by a factor of the collection efficiency by making the collection
efficiency decision on the GPU</li>
<li>the green arrows represent the geometry translation<ul>
<li>most of the work and problems of Opticks are with the geometry translation</li>
</ul>
</li>
</ul>
</div>
<div class="slide" id="opticks-translates-g4-geometry-to-gpu-without-approximation">
<h1><span class="small">Opticks : Translates G4 Geometry to GPU, Without Approximation</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Materials/Surfaces -&gt; GPU Texture</span></p>
<p class="small"><strong>Material/Surface/Scintillator properties</strong></p>
<ul class="small simple">
<li>interpolated to standard wavelength domain</li>
<li>interleaved into &quot;boundary&quot; texture</li>
<li>&quot;reemission&quot; texture for wavelength generation</li>
</ul>
<p class="small"><strong>Material/surface boundary : 4 indices</strong></p>
<ul class="small simple">
<li>outer material (parent)</li>
<li>outer surface (inward photons, parent -&gt; self)</li>
<li>inner surface (outward photons, self -&gt; parent)</li>
<li>inner material (self)</li>
</ul>
<p class="small">Primitives labelled with unique boundary index</p>
<ul class="small simple">
<li>ray primitive intersection -&gt; boundary index</li>
<li>texture lookup -&gt; material/surface properties</li>
</ul>
<p class="small last"><span class="red">simple/fast properties + reemission wavelength</span></p>
</div>
<p class="small"><strong>G4 Structure Tree -&gt; Instance+Global Arrays -&gt; OptiX</strong></p>
<p class="small">Group structure into repeated instances + global remainder:</p>
<ul class="small simple">
<li>auto-identify repeated geometry with &quot;progeny digests&quot;<ul>
<li>JUNO (SVN trunk) : 9 distinct instances + 1 global</li>
</ul>
</li>
<li>instance transforms used in OptiX/OpenGL geometry</li>
</ul>
<p class="small"><span class="red">instancing -&gt; huge memory savings for JUNO PMTs</span></p>
<pre>
</pre><!-- comment

**Automated : Geant4 "World" -> Opticks CSG -> CUDA/OptiX**

**Solids : analytic CSG + triangulated**

* intersection functions for ~10 primitives
* intersection program for arbitrarily complex CSG shapes

  * :red:`automated : G4 -> Opticks -> OptiX` -->
</div>
<div class="slide" id="opticks-translates-g4-geometry-to-gpu-without-approximation-talk">
<h1><span class="small">Opticks : Translates G4 Geometry to GPU, Without Approximation</span> Talk</h1>
<p class="normal">The translation of geometry structure starts by
identifying repeated geometry and its transforms using
geometry tree digests for every node.</p>
<p class="normal">Effectively the original JUNO geometry of hundreds of thousands of
volumes is factorised down to only a handful of repeated assemblies of volumes
with arrays of thousands of 4x4 transforms representing the position and orientation
of each assembly.</p>
<p class="normal">This factorisation of the geoometry allows the use of <strong>instancing</strong>
with OptiX and OpenGL which leads to a huge memory savings
and performance improvement for simulation and visualization.</p>
</div>
<div class="slide" id="j1808-top-rtx">
<h1><span class="i">j1808_top_rtx</span></h1>
</div>
<div class="slide" id="j1808-top-rtx-talk">
<h1><span class="i">j1808_top_rtx</span> Talk</h1>
<p class="normal">The upshot is that full Geant4 detector geometries
can be automatically translated into NVIDIA OptiX geometries.</p>
<p class="normal">This is an OptiX ray trace image from the chimney region at the
top of the JUNO scintillator.</p>
</div>
<div class="slide" id="leap-in-opticks-awareness-meetings-publications-new-users">
<h1><span class="small">2020 : Leap in Opticks Awareness : Meetings, Publications &gt;&gt;&gt; New Users</span></h1>
<p class="small"><strong>(Feb 2020) Workshop on Efficient Computing for HEP, Edinburgh</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico.ph.ed.ac.uk/event/66/">https://indico.ph.ed.ac.uk/event/66/</a> &quot;Full Simulation of HEP Detectors with Geant4&quot;, Ben Morgan</li>
</ul>
<p class="small"><strong>(May 2020) HSF (HEP Software Foundation) Meeting : GPUs in Simulations</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico.cern.ch/event/921244/">https://indico.cern.ch/event/921244/</a> &quot;Opticks Development Experience : Problems and Successes&quot;, Simon Blyth</li>
</ul>
<p class="small"><strong>(10+24 June 2020) HSF Meeting : R&amp;D on accelerators in Simulations</strong> <span class="red">3/9 talks discussed Opticks</span></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico.cern.ch/event/925887/">https://indico.cern.ch/event/925887/</a> <a class="reference external" href="https://indico.cern.ch/event/930881/">https://indico.cern.ch/event/930881/</a></li>
<li>&quot;e/ (GPU) calorimeter simulation.. &quot;, John Apostolakis, &quot;Prototyping simulation .. on GPUs&quot;, Andrei Gheata</li>
<li>&quot;Prospects for (LHCb) RICH detector simulation using OptiX in GPUs&quot;, Sajan Easo</li>
</ul>
<p class="small"><strong>(Aug 2020) HSF Publication : HL-LHC Computing Review: Common Tools and Community Software</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://zenodo.org/record/4009114">https://zenodo.org/record/4009114</a> Graeme Stewart,... <span class="red">HL-LHC Computing Review discusses Opticks</span></li>
</ul>
<p class="small"><strong>(Sep 2020) Geant4 : R&amp;D Task Force Meeting</strong> <span class="red">3+ Geant4 teams pursuing GPUs, 1 based on Opticks</span></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico.cern.ch/event/942142/sessions/363813/#20200915">https://indico.cern.ch/event/942142/sessions/363813/#20200915</a></li>
</ul>
<ol class="small arabic simple">
<li>&quot;G4Opticks for liquid Argon TPCs&quot;, Fermilab Geant4 Team, Hans Wenzel</li>
<li>&quot;<a class="reference external" href="mailto:VecGeom&#64;GPU">VecGeom&#64;GPU</a>&quot;, CERN Geant4 Team, Andrei Gheata</li>
</ol>
</div>
<div class="slide" id="leap-in-opticks-awareness-meetings-publications-new-users-talk">
<h1><span class="small">2020 : Leap in Opticks Awareness : Meetings, Publications &gt;&gt;&gt; New Users</span> Talk</h1>
<p class="normal">There has been quite a leap in Opticks awareness over the past year.</p>
<ul class="normal simple">
<li>a few of the talks and publications discussing Opticks are listed here.</li>
<li>it is being actively evaluated by an increasing number of groups</li>
</ul>
<p class="normal">Why the leap ?</p>
<ul class="normal simple">
<li>i guess my plenary presentation at the CHEP conference at the end of 2019 is the main cause</li>
<li>also using GPUs with Geant4 has become a hot topic over the past year, with
several high profile projects (Celeritas, AdePT) getting started</li>
</ul>
</div>
<div class="slide" id="leap-in-opticks-awareness-some-users-getting-serious">
<h1><span class="small">2020 : Leap in Opticks Awareness &gt;&gt;&gt; Some Users Getting Serious</span></h1>
<p class="small"><strong>(Aug 2020) Shanghai SJTU : Next-gen Neutrino Telescope Simulation Workshop</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico-tdli.sjtu.edu.cn/event/238/sessions/109/#20200813">https://indico-tdli.sjtu.edu.cn/event/238/sessions/109/#20200813</a></li>
<li>&quot;Opticks : GPU/Graphics backgroup + Application to underwater neutrino telescope simulations ?&quot;, Simon Blyth</li>
<li><span class="red">SJTU team evaluating Opticks for deep ocean expt simulations (Fan Hu, Donglian Xu)</span></li>
</ul>
<p class="small"><strong>(Aug 2020) Snowmass 2021 : Three LoI based on Opticks</strong> : <span class="red">Multi-expt Dark Matter group invited me to sign LoI</span></p>
<ol class="small arabic simple">
<li>&quot;Opticks : GPU photon simulation via NVIDIA OptiX&quot;, Simon Blyth</li>
<li>&quot;Fast simulations for Noble Liquid experiments&quot;, XENON, DARWIN, LZ teams, Simon Blyth</li>
<li>&quot;Simulating Optical Photons in HEP experiments on GPUs&quot;, Fermilab Geant4 team</li>
</ol>
<p class="small"><strong>(Aug 2020) NERSC Users Group (NUG) meeting</strong> : <span class="red">LZ aiming to deploy Opticks on Perlmutter supercomputer</span></p>
<ul class="small simple">
<li><a class="reference external" href="https://www.nersc.gov/users/NUG/annual-meetings/nug-2020/">https://www.nersc.gov/users/NUG/annual-meetings/nug-2020/</a></li>
<li><a class="reference external" href="https://www.nersc.gov/assets/Uploads/1400-Opticks-on-CoriGPU.pdf">https://www.nersc.gov/assets/Uploads/1400-Opticks-on-CoriGPU.pdf</a></li>
<li>&quot;Opticks on CoriGPU&quot;, O.Creaner, 5 authors from : NERSC/LBL/LZ/Stanford/Bristol</li>
<li><span class="red">Opticks in Shifter/Docker container -&gt; CoriGPU -&gt; Perlmutter Cray/NVIDIA supercomputer</span></li>
<li>Perlmutter : &gt; 6000 NVIDIA A100 (Ampere Architecture GPU)</li>
</ul>
<p class="tiny"><a class="reference external" href="https://insidehpc.com/2020/05/perlmutter-supercomputer-to-include-more-than-6000-nvidia-a100-processors/">https://insidehpc.com/2020/05/perlmutter-supercomputer-to-include-more-than-6000-nvidia-a100-processors/</a></p>
</div>
<div class="slide" id="leap-in-opticks-awareness-some-users-getting-serious-talk">
<h1><span class="small">2020 : Leap in Opticks Awareness &gt;&gt;&gt; Some Users Getting Serious</span>  Talk</h1>
<p class="normal">Several groups that have been evaluating Opticks for years are now starting to get serious.</p>
<p class="normal">The LZ(LUX-Zepelin) dark matter experiment is the most advanced</p>
<ul class="normal simple">
<li>they aim to get Opticks going on the new Perlmutter supercomputer at NERSC</li>
</ul>
</div>
<div class="slide" id="groups-io-1">
<h1><span class="i">GROUPS_IO_1</span></h1>
<pre>







</pre><div class="sidebar">
<p class="first sidebar-title"><span class="small">Email Group + Web Archive</span></p>
<p><tt class="docutils literal"><span class="pre">https://groups.io/g/opticks</span></tt></p>
<p><strong>25 Members, 33 Topics</strong></p>
<table border="1" class="small docutils">
<colgroup>
<col width="49%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr><td>Year</td>
<td>2018</td>
<td>2019</td>
<td>2020</td>
</tr>
<tr><td>New Members</td>
<td>5</td>
<td>9</td>
<td>11</td>
</tr>
</tbody>
</table>
<ul class="last simple">
<li><tt class="docutils literal">opticks+subscribe&#64;groups.io</tt></li>
</ul>
</div>
</div>
<div class="slide" id="groups-io-1-talk">
<h1><span class="i">GROUPS_IO_1</span> Talk</h1>
<p class="normal">The Opticks Forum and email list is the main way that I support users.</p>
<ul class="normal simple">
<li>there are now 25 members</li>
<li>unfortunately some users still tend to email me directly</li>
</ul>
</div>
<div class="slide" id="g4optickstest-demonstrates-geant4-opticks-hybrid-workflow">
<h1><span class="small">G4OpticksTest : Demonstrates Geant4 + Opticks hybrid workflow</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Plan for G4OpticksTest</span></p>
<ul class="small last simple">
<li>advanced example distributed with Geant4</li>
<li>explore use with G4Tasking with 10.7</li>
</ul>
</div>
<p class="small"><strong>(Nov 2020) HSF WLCG Virtual Workshop : https://indico.cern.ch/event/941278/timetable/#20201123.detailed</strong></p>
<ul class="small simple">
<li>Hans Wenzel, Fermilab Geant4 Team</li>
</ul>
<p class="small">Worked closely with Hans for several years</p>
<ul class="small simple">
<li>Developed Geant4-Opticks integration API <strong>G4Opticks</strong></li>
<li>Recently reported two Geant4 optical surface issues #2305 #2311</li>
</ul>
</div>
<div class="slide" id="g4optickstest-demonstrates-geant4-opticks-hybrid-workflow-talk">
<h1><span class="small">G4OpticksTest : Demonstrates Geant4 + Opticks hybrid workflow</span> Talk</h1>
<p class="normal">The Fermilab Geant4 Team has been active for several years now with Opticks.</p>
<ul class="normal simple">
<li>the inset slides are from Hans Wenzel</li>
<li>my work with them has shaped the development of the G4Opticks interface.</li>
<li>also attempts to work with recent Geant4 releases have revealed some Geant4 optical bugs</li>
</ul>
</div>
<div class="slide" id="geant4-bug-2305">
<h1><span class="i">Geant4_Bug_2305</span></h1>
<pre>







</pre><div class="sidebar">
<p class="first sidebar-title">Geant4 Bug 2305</p>
<p><span class="small">https://bugzilla-geant4.kek.jp/show_bug.cgi?id=2305</span></p>
<p>Five Geant4 releases are <strong>unusable</strong>:</p>
<ul class="last simple">
<li>1060, 1061, 1062, 1063</li>
<li>1070</li>
<li><strong>fix planned for 1071</strong></li>
</ul>
</div>
<pre>


</pre><p class="small"><span class="red">Unfortunately it took me five releases to notice this showstopper</span></p>
<p class="small"><strong>Any GDML using expt. with &gt; 1 optical surface, should not use these
five releases of Geant4.</strong></p>
<p class="small">Important to test ahead, checking lastest Geant4:</p>
<ul class="small simple">
<li><span class="red">natural way to contribute to Geant4</span> and <span class="blue">raises profile</span></li>
<li>avoids : surprises, excluded releases</li>
<li>ease future &quot;official&quot; updating</li>
</ul>
</div>
<div class="slide" id="geant4-bug-2305-talk">
<h1><span class="i">Geant4_Bug_2305</span> Talk</h1>
<p class="normal">If you use GDML and have more than 1 optical surface then I would suggest
you should not use these five releases.</p>
<p class="normal">It is unfortuate that I did not test Opticks with these Geant4 releases until recently.
This optical surface bug tripped a consistency assert in the Opticks geometry translation,
so it is immediately apparent when testing Opticks with the Geant4 release.</p>
<p class="normal">I would have been able to catch the problem much sooner.</p>
<p class="normal">It really demonstrates the importance of testing the latest version
of critical externals even when you have no intention to officially updating
to them in the near future.</p>
<p class="normal">Plus it is a natural way to contribute to your externals and ensures
that they will be ready for you when you do need to update.</p>
</div>
<div class="slide" id="geant4-bug-2311">
<h1><span class="i">Geant4_Bug_2311</span></h1>
<pre>






</pre><div class="sidebar">
<p class="first sidebar-title">Geant4 Bug 2311</p>
<p><span class="small">https://bugzilla-geant4.kek.jp/show_bug.cgi?id=2311</span></p>
<p>Effected Geant4 releases: 1070+</p>
<p class="small">bordersurface std::vector -&gt; std::map API Change</p>
<ul class="small last simple">
<li>made Opticks name sort workaround for 1070</li>
<li>have suggested <strong>creation order index</strong> to improve workaround &gt; 1070</li>
</ul>
</div>
<pre>


</pre><p class="small"><span class="red">Problem noticed in first release</span></p>
<p class="small">Geant4 team seem willing to follow my suggestion
that will avoid any lasting impact.</p>
</div>
<div class="slide" id="geant4-bug-2311-talk">
<h1><span class="i">Geant4_Bug_2311</span> Talk</h1>
<p class="normal">This bug is actually a change in API.</p>
<p class="normal">This Geant4 change in 10.7 was noticed at the first release, and fortunately
an Opticks workaround is possible and it looks likely that the next Geant4 release 1071
will be free of both this workaround and the optical surface bug too.</p>
</div>
<div class="slide" id="uk-swift-hep-grant-software-infrastructure-and-technology-for-hep">
<h1><span class="small">UK SWIFT-HEP grant : SoftWare InFrastructure and Technology for HEP</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">UOM : Plan 0.5 FTE over 12 months</span></p>
<ul class="small simple">
<li>integration of Opticks within Geant4</li>
<li>widening Opticks applicability</li>
<li>&quot;... also plan to hire software engineer to assist...&quot;</li>
</ul>
<p class="small last"><span class="blue">details yet to be determined</span></p>
</div>
<p class="small"><strong>SWIFT-HEP : Newly funded (1.5M GBP over 3 yrs)</strong></p>
<p class="small">University of Manchester (UOM), Adam Davis</p>
<ul class="small simple">
<li>&quot;... we identified Opticks as a major contribution area ...&quot;</li>
</ul>
<p class="small"><strong>(Jan 2021) SwiftHep/ExcaliburHep workshop presentation</strong></p>
<p class="small">Ben Morgan, University of Warwick + Geant4</p>
<ul class="small simple">
<li><a class="reference external" href="https://indico.cern.ch/event/976081/">https://indico.cern.ch/event/976081/</a></li>
</ul>
</div>
<div class="slide" id="uk-swift-hep-grant-software-infrastructure-and-technology-for-hep-talk">
<h1><span class="small">UK SWIFT-HEP grant : SoftWare InFrastructure and Technology for HEP</span> Talk</h1>
<p class="normal">There is some other news on Geant4+Opticks integration.</p>
<p class="normal">A group from Manchester and Warwick in the UK has got some
funding part of which they want to dedicate to improving and
extending the use of Opticks.</p>
<p class="normal">So it looks like a few more people will be working on
Geant4+Opticks integration this year.</p>
<!-- comment

Contribution is of course excellent : but it it going to
take time to train up the people supported by this grant
and payback is far from certain. -->
</div>
<div class="slide" id="lhcb-rich-ring-imaging-cherenkov-with-opticks-sajan-easo">
<h1><span class="small">LHCb RICH (Ring Imaging Cherenkov) with Opticks : Sajan Easo</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">LHCb Opticks Users</span></p>
<p class="small">Several LHCb members are using Opticks</p>
<ul class="small last simple">
<li>Sajan Easo has reported his investigations</li>
</ul>
</div>
<p class="small"><strong>(June 2020) HSF (HEP Software Foundation) Meeting</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico.cern.ch/event/930881/">https://indico.cern.ch/event/930881/</a></li>
<li>&quot;Prospects for RICH simulation using Opticks&quot;, Sajan Easo (STFC-GB)</li>
<li>Standard Geant4 costs ~30% CPU time for optical photons</li>
<li><span class="red">successful validations</span></li>
</ul>
</div>
<div class="slide" id="lhcb-rich-ring-imaging-cherenkov-with-opticks-sajan-easo-talk">
<h1><span class="small">LHCb RICH (Ring Imaging Cherenkov) with Opticks : Sajan Easo</span> Talk</h1>
<p class="normal">Opticks is not restricted to neutrino and dark matter experiments.</p>
<p class="normal">Several people from LHCb have been using it for simulation of
RICH detectors (that is Ring Imaging Cherenkov)</p>
<p class="normal">These slides are from Sajan Easo who has done some simple validations
with the RICH geometry.</p>
</div>
<div class="slide" id="opticks-corsika8-for-next-generation-neutrino-telescope-optimization">
<h1><span class="small">Opticks+CORSIKA8 for next-generation neutrino telescope optimization ?</span></h1>
<p class="small"><strong>(Aug 2020) Shanghai SJTU : Next-gen Neutrino Telescope Simulation Workshop</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://indico-tdli.sjtu.edu.cn/event/238/sessions/109/#20200813">https://indico-tdli.sjtu.edu.cn/event/238/sessions/109/#20200813</a></li>
<li>&quot;Opticks : GPU/Graphics backgroud + Application to underwater neutrino telescope simulations ?&quot;, Simon Blyth</li>
<li><span class="red">SJTU team evaluating Opticks for deep ocean expt simulations (Fan Hu, Donglian Xu)</span><ul>
<li>enormous instrumented volumes O(10) km^3 water/ice</li>
<li>strings of pods geometry</li>
<li>huge numbers of Cherenkov photons propagating across enormous volumes, how to simulate ?</li>
<li>CORSIKA 8 + Opticks : trying to setup genstep transport</li>
</ul>
</li>
</ul>
</div>
<div class="slide" id="opticks-corsika8-for-next-generation-neutrino-telescope-optimization-talk">
<h1><span class="small">Opticks+CORSIKA8 for next-generation neutrino telescope optimization ?</span> Talk</h1>
<p class="normal">Another idea for using Opticks is to try to integrate it with CORSIKA for
optimization of enormous deep sea neutrino telescopes.</p>
<p class="normal">The visualization shows a string of pods geometry set up by a student of Donglian, Fan Hu.</p>
</div>
<div class="slide" id="lz-opticks-history-2018-2021-contacts-with-5-lz-people">
<h1><span class="small">LZ+Opticks history : 2018-2021 : contacts with &gt;5 LZ people</span></h1>
<ul class="small simple">
<li><span class="red">Summer 2020 : LZ+Opticks simulation identified as candidate for new Perlmutter Cray/NVIDIA supercomputer at NERSC</span></li>
<li>Autumn 2020 : LZ+NERSC proposed an NVIDIA assisted Hackathon to optimize LZ+Opticks simulation<ul>
<li>BUT no point optimizing prior to migration : NVIDIA OptiX 6 -&gt; 7 (an entirely new &quot;Vulkan-ized&quot; API)</li>
<li>migration to NVIDIA OptiX 7+ is unavoidable, it beings challenges and opportunities<ul>
<li>multi-GPU scaling no longer provided, thread-safe OptiX 7 opens possibilities, especially for Opticks Server+Client</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="small"><strong>(Aug 2020) NERSC Users Group (NUG) meeting</strong> : <span class="red">LZ aiming to deploy Opticks on Perlmutter supercomputer</span></p>
<ul class="small simple">
<li><a class="reference external" href="https://www.nersc.gov/users/NUG/annual-meetings/nug-2020/">https://www.nersc.gov/users/NUG/annual-meetings/nug-2020/</a></li>
<li>&quot;Opticks on CoriGPU&quot;, O.Creaner, 5 authors from : NERSC/LBL/LZ/Stanford/Bristol</li>
</ul>
</div>
<div class="slide" id="lz-opticks-history-2018-2021-contacts-with-5-lz-people-talk">
<h1><span class="small">LZ+Opticks history : 2018-2021 : contacts with &gt;5 LZ people</span> Talk</h1>
<p class="normal">LZ has been evaluating Opticks over the past three years and it is now
keep to scale up its usage to profit from the new NERSC Perlmutter supercomputer,
with more than 6000 NVIDIA A100 GPUs</p>
<p class="normal">They proposed a Hackathon to optimize LZ+Opticks simulation.</p>
<ul class="normal simple">
<li>but there is little point optimizing prior to migrating to the OptiX 7 API</li>
<li>after I pointed this out they indicated they could help with the migration</li>
</ul>
</div>
<div class="slide" id="lz-opticks-simulation-on-perlmutter-6000-nvidia-a100">
<h1><span class="small">2021 : LZ+Opticks simulation on Perlmutter (&gt;6000 NVIDIA A100)</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Opportunity for Expert Assistance</span></p>
<ul class="small last simple">
<li>NVIDIA GPU developer team<ul>
<li>real experts advising/optimizing Opticks</li>
<li>influence on NVIDIA OptiX direction(?)</li>
</ul>
</li>
<li>NERSC supercomputer team<ul>
<li>Docker/Shifter containerization</li>
<li>large scale production optimization</li>
</ul>
</li>
</ul>
</div>
<p class="small"><strong>(8 Jan 2021) Zoom Introduction Meeting of &gt;12 people : LZ/NERSC(6), NVIDIA(5), Opticks(1)</strong></p>
<ul class="small simple">
<li>NERSC + NVIDIA teams: senior engineers + postdoc &quot;workers&quot;</li>
<li>NVIDIA team : experienced with OptiX 6-&gt;7, multi-GPU + multi-threaded CUDA/OptiX</li>
</ul>
<p class="small"><strong>Prepared Opticks codebase orientation for developers</strong></p>
<ul class="small simple">
<li><a class="reference external" href="https://simoncblyth.bitbucket.io/opticks/docs/orientation.html">https://simoncblyth.bitbucket.io/opticks/docs/orientation.html</a></li>
</ul>
<p class="small"><strong>From February 8:</strong></p>
<ul class="small simple">
<li><span class="red">plan bi-weekly working meetings</span></li>
<li>migration assistance</li>
</ul>
<p class="small"><strong>Adapt Opticks to all new NVIDIA OptiX 7 API</strong></p>
<ul class="small simple">
<li><strong>necessary</strong> : otherwise forever stuck at <em>OptiX 6.5</em> (2019)<ul>
<li>pre-requisite to <em>OpticksServer</em></li>
</ul>
</li>
<li>re-implement <em>optixrap</em> (<em>OptiX</em> wrapper) package</li>
<li>first: single-GPU only</li>
<li>expect no change to <em>G4Opticks</em> API</li>
</ul>
</div>
<div class="slide" id="lz-opticks-simulation-on-perlmutter-6000-nvidia-a100-talk">
<h1><span class="small">2021 : LZ+Opticks simulation on Perlmutter (&gt;6000 NVIDIA A100)</span> Talk</h1>
<p class="normal">I was a little surprised by the number of people from NERSC and NVIDIA
in the Zoom meeting. I guess NERSC wants its users to rapidly
see the benefits from the hundreds of millions of dollars spent on Perlmutter.</p>
<p class="normal">Having NVIDIA aware in detail of how OptiX is being used for optical photon simulation
could be extremely beneficial down the road.</p>
<p class="normal">Also it make a good story for NVIDIA to be helping with something more than making
games look pretty. Plus widens the market for its GPUs.</p>
<!-- comment

:small:`Opticks Tasks List`
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

.. image:: /env/presentation/tasks/tasks_jan_2021_half.png
   :width: 600px
   :align: right

.. class:: tiny

   https://bitbucket.org/simoncblyth/opticks/src/master/notes/tasks/tasks.rst

.. class:: small

   **Task List categories**

   1. Needed ASAP for JUNO
   2. Useful for JUNO but not urgently required
   3. Not needed for JUNO, but useful for wider applicability

   **Fishing for assistance, organizing priorities**


.. s5_talk::

    The tasks list was prepared:

    1. to fish for assistance from the community
    2. organize priorities

    TODO: shorten task titles, add progress notes to titles, include "Table of Contents" label -->
</div>
<div class="slide" id="opticks-juno-progress-efficiency-hit-culling-on-gpu">
<h1><span class="small">Opticks + JUNO Progress : Efficiency Hit Culling on GPU</span></h1>
<div class="sidebar">
<p class="first sidebar-title">,  [, ]  -&gt; GPU Tex</p>
<p class="small"><strong>Separate Textures for each sensor type</strong></p>
<dl class="small last docutils">
<dt><tt class="docutils literal">G4Opticks::</tt></dt>
<dd><tt class="docutils literal">setSensorData</tt>
<tt class="docutils literal">setSensorAngularEfficiency</tt></dd>
</dl>
</div>
<ul class="small simple">
<li><span class="red">Reduce CPU memory for hits by a factor of the efficiency</span></li>
<li>only <strong>collected hits</strong> consume CPU memory</li>
</ul>
<p class="small">Culling result photon flags set on GPU:</p>
<ul class="small simple">
<li><tt class="docutils literal">EFFICIENCY_COLLECT</tt></li>
<li><tt class="docutils literal">EFFICIENCY_CULL</tt></li>
</ul>
<pre>


</pre><p class="small"><strong>Testing angular efficiency GPU texture machinery</strong></p>
<ul class="small simple">
<li>Mock striped theta efficiency, two random categories</li>
<li>cosine phi efficiency variation for one category</li>
</ul>
<p class="tiny"><a class="reference external" href="https://simoncblyth.bitbucket.io/opticks/optixrap/tests/OSensorLibGeoTest.cc.html">https://simoncblyth.bitbucket.io/opticks/optixrap/tests/OSensorLibGeoTest.cc.html</a></p>
<p class="tiny"><a class="reference external" href="https://bitbucket.org/simoncblyth/opticks/src/master/notes/progress.rst">https://bitbucket.org/simoncblyth/opticks/src/master/notes/progress.rst</a></p>
</div>
<div class="slide" id="opticks-juno-progress-efficiency-hit-culling-on-gpu-talk">
<h1><span class="small">Opticks + JUNO Progress : Efficiency Hit Culling on GPU</span> Talk</h1>
<ul class="normal simple">
<li>Doing efficiency culling on GPU reduces CPU memory for hits by a factor of the efficiency</li>
<li>only the collected hits needed by the electronics simulation have to use CPU memory</li>
<li>BUT : it means you have to translate the efficiency information and upload it to the GPU<ul>
<li>i did this with angular textures for each sensor type and efficiency buffers</li>
</ul>
</li>
<li>the culling decision on GPU leads to one of these flags being set, then
you can copy back just the EFFICIENCY_COLLECT photons to go into the hit collection</li>
</ul>
<!-- comment

https://bitbucket.org/simoncblyth/opticks/src/master/optickscore/tests/MockSensorLibTest.cc

https://bitbucket.org/simoncblyth/opticks/src/master/optixrap/tests/OSensorLibGeoTest.cc -->
</div>
<div class="slide" id="completing-juno-hits-g4optickshit-4-4-g4optickshitextra-2-4">
<h1><span class="small">Completing JUNO Hits : G4OpticksHit (4,4) + G4OpticksHitExtra (2,4)</span></h1>
<p class="small"><em>void G4Opticks::getHit(unsigned i, G4OpticksHit* hit, G4OpticksHitExtra* hit_extra ) const</em></p>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">G4OpticksHit + G4OpticksHitExtra</span></p>
<div class="last"><pre class="mypretiny">
struct G4OpticksHit // from photon->hit buffers
{  <b><span class="red">// global+local,... all from (4,4) photon item</span></b>
    G4ThreeVector local_position ;
    G4ThreeVector global_position ;
    G4double      time ;
    G4ThreeVector local_direction ;
    G4ThreeVector global_direction ;
    G4double      weight ;
    G4ThreeVector local_polarization ;
    G4ThreeVector global_polarization ;
    G4double      wavelength ;
    G4int         boundary ;
    G4int         sensorIndex ;
    G4int         nodeIndex ;
    G4int         photonIndex ;
    G4int         flag_mask ;
    G4int         sensor_identifier ;
    G4bool        is_cerenkov ;
    G4bool        is_reemission ;
};
struct G4OpticksHitExtra // from way->hiy buffers
{  <b><span class="red">// extras from (2,4) "way" item</span></b>
    G4ThreeVector boundary_pos ;
    G4double      boundary_time ;
    G4double      origin_time ;
    G4int         origin_trackID ;
};
</pre></div></div>
<p class="small"><strong>Geant4 approach</strong></p>
<pre class="mypretiny">// Simulation/DetSimV2/PMTSim/src/junoSD_PMT_v2.cc
junoHit_PMT* hit = new junoHit_PMT(); <b><span class="blue">// junoSD_PMT_v2::ProcessHits </span></b>
hit->SetPMTID(pmtid);
hit->SetWeight(1.0);
hit->SetTime(hittime);
hit->SetWavelength(wavelength);
hit->SetKineticEnergy(edep);
hit->SetPosition(local_pos);
hit->SetTheta(local_pos.theta());
hit->SetPhi(local_pos.phi());
hit->SetMomentum(local_dir);
hit->SetPolarization(local_pol);
hit->SetGlobalPosition(global_pos);
hit->SetGlobalMomentum(track->GetMomentum());
hit->SetGlobalPolarization(track->GetPolarization());
<b><span class="red">// optional extras normally from  NormalTrackInfo/NormalAnaMgr
hit->SetProducerID(producerID);
hit->SetFromCerenkov(is_from_cerenkov);
hit->SetReemission(is_reemission);
hit->SetOriginalOP(is_original_op);
hit->SetOriginalOPStartT(t_start);
hit->SetBoundaryPosition(boundary_pos); // pAcrylic/pInnerWater[1] </span></b>
</pre><ul class="small simple">
<li><strong>split</strong>: <span class="blue">Hit (4,4) + HitExtra (2,4)</span>  OR <strong>combine</strong>: <span class="blue">HitFull (6,4)</span>  ?</li>
<li>Using <strong>split</strong> assuming <span class="red">extras switched off in large productions ?</span></li>
</ul>
<p class="tiny">[1] set in NormalTrackInfo by <tt class="docutils literal"><span class="pre">NormalAnaMgr::UserSteppingAction</span></tt></p>
</div>
<div class="slide" id="completing-juno-hits-g4optickshit-4-4-g4optickshitextra-2-4-talk">
<h1><span class="small">Completing JUNO Hits : G4OpticksHit (4,4) + G4OpticksHitExtra (2,4)</span> Talk</h1>
<p class="normal">The (4,4) and (2,4) are dimensions of the buffer items.
On the GPU it is more efficient to handle quad elements
like float4 so Opticks does everything in quads.</p>
<p class="normal">One obvious way to provide the global+local information would
be to double the size of the photon element. That would have
halved the number of photons that can be simulated at once.
So transforms are used to convert global into local on the CPU
using identity information to get the right transform.</p>
<p class="normal">All of the <em>G4OpticksHit</em> comes from a (4,4) photon item.</p>
<p class="normal">Hit information is split into standard+extra to avoid paying the price for the
extra info when it is not needed.</p>
<p class="normal">The price is a 50% increase in VRAM and a doubling of GPU to CPU copies.</p>
<p class="normal">If the extra info were regarded as essential then increasing the
size of the photon item from (4,4) to (6,4) would be appropriate.</p>
<!-- comment

.. class:: small

    * Uses geometry aware photon wrapper ``ggeo/GPho``

.. class:: tiny

    http://bitbucket.org/simoncblyth/opticks/src/master/ggeo/GPho.cc

.. class:: small

    **Way point (eg: Acrylic/LS boundary intersect)**

    * Unavoidably increases photon size : (6,4)
    * TODO: make **way point** optional -->
</div>
<div class="slide" id="opticks-three-levels-of-performance">
<h1><span class="small">Opticks : Three Levels of Performance</span></h1>
<ul class="small simple">
<li><a class="reference external" href="https://bitbucket.org/simoncblyth/opticks/src/master/notes/performance.rst">https://bitbucket.org/simoncblyth/opticks/src/master/notes/performance.rst</a></li>
</ul>
<div class="sidebar">
<p class="first sidebar-title"><strong>cluster</strong> level optimizations</p>
<p class="small"><strong>Opticks Server + many Clients</strong></p>
<ul class="small simple">
<li>genstep requests, hits in response</li>
<li>bring Opticks to CPU only batch nodes</li>
<li>avoid GPU starvation</li>
<li>header only implementation : <tt class="docutils literal">OpticksClient.hh</tt></li>
</ul>
<p class="small"><strong>Prototype : Network Transport of NP Arrays</strong></p>
<ul class="small last simple">
<li><a class="reference external" href="https://github.com/simoncblyth/np">https://github.com/simoncblyth/np</a></li>
<li>depends only on Boost-Asio (Async IO)</li>
<li><span class="red">np_server/np_client operational</span></li>
</ul>
</div>
<ol class="small arabic simple">
<li><strong>optical</strong>: time+memory to simulate photons (1 CPU, <em>N</em> GPUs)</li>
<li><strong>node</strong>: overall simulation performance (1 CPU, <em>N</em> GPUs)</li>
<li><strong>cluster</strong>: overall batch performance creating large samples</li>
</ol>
<p class="small">For example with <em>N = 4</em></p>
<ul class="small simple">
<li>best <strong>optical</strong> performance</li>
<li><strong>node</strong> : ~same as 1 GPU per CPU (dominated by non-optical)</li>
<li><strong>cluster</strong> : significantly worse : as limiting concurrent jobs</li>
</ul>
<p class="small"><span class="red">Experimentation required to find optimum</span></p>
<ul class="small simple">
<li>CPU only <em>OpticksClients</em> -&gt; GPU cluster <em>OpticksServer</em></li>
</ul>
<p class="small">Flexibility -&gt; maximizes resource usage -&gt; solves problems:</p>
<ul class="small simple">
<li>limited numbers of NVIDIA GPUs</li>
<li>GPU starvation : difficult to keep them busy</li>
</ul>
</div>
<div class="slide" id="opticks-three-levels-of-performance-talk">
<h1><span class="small">Opticks : Three Levels of Performance</span> Talk</h1>
<p class="small">SMALL</p>
<p class="small">Performance must be considered at three levels because choices
optimum for one level will not be the optimum at other levels.</p>
<p class="small">For example dedicating 4 GPUs to 1 CPU would give the
best <strong>optical</strong> performance but at <strong>node</strong> level
the performance might not be different to that with
1 GPU per node and at  <strong>cluster</strong> level you would be limiting
the number of concurrent batch jobs hence killing your overall throughput.</p>
<p class="small">Finding the optimum approach requires experimentation.</p>
<p class="small">Opticks has only optimized at <strong>optical</strong> level.</p>
<p class="small">Optimizing at cluster level is expected to give large gains,
by maximimizing the use of resources</p>
<p class="small">A big problem at <strong>cluster</strong> level is that there is a limited number
of GPU nodes</p>
<p class="small">Developing a distributed Opticks is</p>
<!-- comment

**Async Opticks Server ?**

* :red:`No point until after migration to NVIDIA OptiX 7`

  * new features of OptiX 7 important for Server implementation
  * major developments based on 2 yr old OptiX 6 unwise -->
</div>
<div class="slide" id="opticksserver-lightweight-opticksclients">
<h1><span class="small">OpticksServer + Lightweight OpticksClients</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Distributed compute advantage</span></p>
<p class="small">Currently (only on GPU nodes):</p>
<ul class="small simple">
<li>JUNO Offline -&gt; <em>G4Opticks</em> -&gt; Opticks/OptiX</li>
</ul>
<hr/><p class="small"><strong>Instead : split CPU and GPU compute</strong></p>
<p class="small"><span class="red">On any CPU node:</span></p>
<ul class="small simple">
<li>JUNO Offline -&gt; <em>G4Opticks</em> -&gt; OpticksClient</li>
</ul>
<p class="small">On GPU cluster:</p>
<ul class="small simple">
<li>OpticksServer-&gt;Opticks(<strong>OKOP</strong>)-&gt;OptiX</li>
</ul>
<hr/><p class="small last"><span class="red">splitting -&gt; drastic leap in flexibility</span></p>
</div>
<p class="small"><strong>General compute server structure:</strong></p>
<ul class="small simple">
<li>receive/queue/reply <em>NumPy</em> arrays (eg gensteps, hits) over TCP</li>
<li>decouple computation from queue/network infrastructure code</li>
</ul>
<p class="small">Exploration phase: find/evaluate open source basis projects</p>
<ul class="small simple">
<li>load balancer, proxy : HAProxy, Squid</li>
<li>task queue : <a class="reference external" href="https://taskqueues.com">https://taskqueues.com</a></li>
</ul>
<p class="small">Plan ? <span class="red">too early to set timeline</span></p>
<ul class="small simple">
<li><span class="red">priority depends on experience with GPU constrained Opticks</span></li>
</ul>
<p class="small"><span class="blue">computing student/postdoc/.. welcome to assist</span></p>
<ul class="small simple">
<li>needs network/MQ/server/multi-threading experience~interest</li>
</ul>
<pre>



</pre><p class="tiny"><strong>[1] OKOP package</strong> : no Geant4, OpenGL : (Opticks structured as tree of ~20 packages according to external dependencies, only the four highest level packages depend on Geant4)</p>
</div>
<div class="slide" id="opticksserver-lightweight-opticksclients-talk">
<h1><span class="small">OpticksServer + Lightweight OpticksClients</span> Talk</h1>
<p class="normal">Called <em>OpticksServer</em> for the name-recognition</p>
<ul class="normal simple">
<li>develop as general GPU compute</li>
</ul>
</div>
<div class="slide" id="releases-for-opticks-juno-validation-comparing-g4-opticks-vs-g4">
<h1><span class="small">Releases for Opticks+JUNO validation comparing G4+Opticks vs G4</span></h1>
<!-- comment

* use REPLACE mode (shift-R) in vim to edit the table
* RST blank lines in some places have no impact on html output, use this to decouple column editing
* unfortunately replace directive may contain a single paragraph only -->
<table border="1" class="small docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="2"><strong>0.1.0 : &quot;Basic Validation&quot; Release</strong>  : <span class="blue">Enabling Statistical hit comparison</span> : <span class="red">Estimate : During February</span></th>
</tr>
<tr><th class="head">Completed:</th>
<th class="head">Remaining:</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><ul class="first last simple">
<li>full JUNO hits      :<ul>
<li><em>G4OpticksHit</em> : global+local</li>
<li><em>G4OpticksHitExtra</em> : boundary_pos, origin_time, ..</li>
</ul>
</li>
<li>GPU collection angular efficiency culling<ul>
<li> [, ] -&gt; <em>G4Opticks</em> -&gt; GPU &quot;angular&quot; texture</li>
<li><em>G4Opticks::setSensorData</em></li>
<li>reduces CPU hit memory by :   .  [, ]</li>
</ul>
</li>
</ul>
</td>
<td><ul class="first last simple">
<li>angular efficiency culling : make <strong>run-time</strong> controllable</li>
<li><em>G4OpticksHitExtra</em> : make <strong>run-time optional</strong><ul>
<li>photon size: (4,4)+(2,4) -&gt; (4,4)</li>
<li>half GPU-&gt;CPU hit copies</li>
</ul>
</li>
<li>JUNO Offline+Opticks Bridge updates<ul>
<li>adapt to new <em>G4Opticks</em> API</li>
<li>improve python commandline control of <em>G4Opticks</em></li>
</ul>
</li>
</ul>
</td>
</tr>
<tr><td colspan="2"><p class="center first last"><span class="blue">students/postdocs with Geant4 geometry experience can assist with &quot;Basic Validation&quot; distribution comparison</span></p>
</td>
</tr>
</tbody>
</table>
<pre>

</pre><table border="1" class="small docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="2"><strong>0.2.0 : &quot;Full Validation&quot;</strong> Release : <span class="blue">Enabling Random Aligned step-by-step comparison</span> : <span class="red">Estimate March-April</span></th>
</tr>
<tr><th class="head">Completed:</th>
<th class="head">Remaining:</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><ul class="first last simple">
<li><em>cfg4</em> : <em>CRandomEngine</em> control random stream<ul>
<li>-&gt; random aligned bi-simulation</li>
</ul>
</li>
<li><em>cfg4</em> : <em>Geant4</em> SteppingAction emulates <em>Opticks</em><ul>
<li>-&gt; <em>OpticksEvent</em> arrays -&gt; direct <em>NumPy</em> compare</li>
</ul>
</li>
</ul>
</td>
<td><ul class="first last simple">
<li>Integrate <em>cfg4</em> random control with <em>G4Opticks</em><ul>
<li>adapt to general <em>G4</em> environment (prev: optical only)</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr><td colspan="2"><p class="center first last"><span class="blue">students/postdocs with NumPy + Geant4 geometry experience can assist with &quot;Full Validation&quot; step-by-step comparison</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="slide" id="releases-for-opticks-juno-validation-comparing-g4-opticks-vs-g4-talk">
<h1><span class="small">Releases for Opticks+JUNO validation comparing G4+Opticks vs G4</span> Talk</h1>
<p class="normal">The plan is to make a &quot;Basic Validation&quot; release during February
with the features I have described already. There is little remaining to do,
so I am confident have the release during Febrary.
This will allow basic statistical comparison of hit distributions.</p>
<p class="normal">The &quot;Full Validation&quot; release aims to provide random aligned step-by-step
comparisons. Validating like this is very good at finding problems as
the comparison is not clouded by statistics.</p>
<p class="normal">Problems with Opticks are mostly geometry problems, so experience
with Geant4 geometry is important.</p>
</div>
<div class="slide" id="summary-and-links">
<h1><span class="small">Summary and Links</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Next Steps</span></p>
<ul class="small last simple">
<li>basic validation release</li>
<li>migrate to NVIDIA OptiX 7</li>
<li>full validation release</li>
</ul>
</div>
<img alt="/env/presentation/1px.png" src="/env/presentation/1px.png" style="width: 500px; height: 20px;" />
<!--  -->
<blockquote>
<p><em>Opticks</em> : state-of-the-art GPU ray traced optical simulation
integrated with <em>Geant4</em>. <span class="red">Now integrated with JUNO Offline</span>
<strong>Pioneer users welcome</strong></p>
<img alt="/env/presentation/1px.png" src="/env/presentation/1px.png" style="width: 1000px; height: 1px;" />
<ul class="simple">
<li><strong>Opticks gained many new users in 2020, some getting serious</strong></li>
<li><span class="blue">JUNO Opticks users are needed to assist with validation</span></li>
</ul>
</blockquote>
<table border="1" class="docutils align-center">
<colgroup>
<col width="55%" />
<col width="45%" />
</colgroup>
<tbody valign="top">
<tr><td><a class="reference external" href="https://bitbucket.org/simoncblyth/opticks">https://bitbucket.org/simoncblyth/opticks</a></td>
<td>code repository</td>
</tr>
<tr><td><a class="reference external" href="https://github.com/simoncblyth/opticks/releases">https://github.com/simoncblyth/opticks/releases</a></td>
<td>.zip .tar.gz  archives</td>
</tr>
<tr><td><a class="reference external" href="https://simoncblyth.bitbucket.io">https://simoncblyth.bitbucket.io</a></td>
<td>presentations and videos</td>
</tr>
<tr><td><a class="reference external" href="https://groups.io/g/opticks">https://groups.io/g/opticks</a></td>
<td>forum/mailing list archive</td>
</tr>
<tr><td>email:opticks+subscribe&#64;groups.io</td>
<td>subscribe to mailing list</td>
</tr>
</tbody>
</table>
</div>
<div class="slide" id="summary-and-links-talk">
<h1><span class="small">Summary and Links</span> Talk</h1>
<p class="normal">While it is great that Opticks is gaining many new users with lots
of interest and activity from Geant4 and also now NVIDIA
the downside of is that it takes times to support them all.</p>
<!-- comment

* Drastic speedup -> better detector understanding -> greater precision

  * **any simulation limited by optical photons can benefit**
  * more photon limited -> more overall speedup (99% -> 100x)

*Opticks* uses hardware accelerated GPU ray tracing
via NVIDIA OptiX to give **effectively zero time and zero CPU memory**
optical photon simulation to *Geant4* applications.

.. image:: /env/presentation/1px.png
   :width: 1000px
   :height: 10px


 So in summary : Opticks applies the best available GPU ray tracing to optical
 photon simulation resulting in speedups exceeding three orders of magnitude. -->
</div>
<div class="slide" id="geocache-360">
<h1><span class="i">geocache_360</span></h1>
</div>
<div class="slide" id="geocache-360-talk">
<h1><span class="i">geocache_360</span> Talk</h1>
<p class="normal">Background slides start from here</p>
</div>
<div class="slide" id="integration-of-juno-opticks-opticks-is-a-junoenv-external">
<h1><span class="small">Integration of JUNO + Opticks : Opticks is a JunoENV External</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Opticks Build Generalized</span></p>
<p class="small"><strong>Builds against CMAKE_PREFIX_PATH</strong></p>
<ul class="small simple">
<li>Boost, CLHEP, XercesC, Geant4</li>
<li>-&gt; Opticks uses JUNO externals</li>
</ul>
<p class="small"><strong>opticks-config</strong> (<strong>pkg-config</strong> .pc file based)</p>
<ul class="small simple">
<li>integrates with non-CMake projects, eg CMT</li>
</ul>
<p class="small"><strong>releases on github</strong> : latest <tt class="docutils literal"><span class="pre">v0.1.0-rc2</span></tt></p>
<p class="small last"><span class="small">https://github.com/simoncblyth/opticks/releases/tag/v0.1.0-rc2</span></p>
</div>
<p class="small">Add Opticks to an existing installation (<span class="red">SVN trunk r3990+</span>):</p>
<p class="small"><tt class="docutils literal">bash junoenv libs all opticks</tt></p>
<ul class="small simple">
<li>pre-requisites : NVIDIA Driver, CUDA, OptiX</li>
</ul>
<p class="small"><strong>Four mandatory envvars :</strong></p>
<pre class="mypre">
<b><span class="alarm">export CMTEXTRATAGS=opticks </span></b>
<b><span class="alarm"># -> Opticks ON in JunoENV + CMT</span></b>
export OPTICKS_COMPUTE_CAPABILITY=70 <b><span class="blue"> # -> nvcc flags</span></b>
export OPTICKS_CUDA_PREFIX=/usr/local/cuda-10.1
export OPTICKS_OPTIX_PREFIX=/usr/local/OptiX_650
<b><span class="blue"># location of CUDA and OptiX installs </span></b>
</pre><p class="small"><strong>Build all JUNO externals, including Opticks (takes ~1hr, 13G) :</strong></p>
<pre class="mypretiny">
jlibs(){
    mkdir -p $JUNOTOP && cd $JUNOTOP
    svn co https://juno.ihep.ac.cn/svn/offline/trunk/installation/junoenv && cd $JUNOTOP/junoenv
    local libs=$(bash junoenv libs list | perl -ne 'm, (\S*)@, && print "$1\n"' -)
    for lib in $libs ; do
        bash junoenv libs all $lib || return 1
    done
}
</pre><ul class="small simple">
<li><a class="reference external" href="https://juno.ihep.ac.cn/mediawiki/index.php/Offline:Installation#Install_Opticks_using_JunoENV">https://juno.ihep.ac.cn/mediawiki/index.php/Offline:Installation#Install_Opticks_using_JunoENV</a></li>
</ul>
</div>
<div class="slide" id="integration-of-juno-opticks-opticks-is-a-junoenv-external-talk">
<h1><span class="small">Integration of JUNO + Opticks : Opticks is a JunoENV External</span> Talk</h1>
<p class="normal">Now I transition to progress with integrating Opticks with the Offline.</p>
<ul class="normal simple">
<li><strong>Opticks is now a JunoENV external</strong></li>
<li>that means you can install Opticks with that one line</li>
<li>actually to install all Offline externals you
can use the bash function below</li>
</ul>
<p class="normal">Opticks has pre-requisites : CUDA, OptiX and the NVIDIA GPU Driver
that need to be separately installed.
It is not appropriate to automate this, as low level system drivers are involved
users need to follow NVIDIA instructions for your system.</p>
<p class="normal">Where these are installed are communicated via envvars.</p>
<p class="normal">As Opticks is an optional external, it is necessary to
switch it on somehow. The CMTEXTRATAGS envvar is used to do this,
when that contains the string &quot;opticks&quot; it signals JUNOEnv and
CMT to enable Opticks in the builds.</p>
<p class="normal">More details are in the wiki at this link.</p>
</div>
<div class="slide" id="integration-of-offline-opticks-where-with-g4opticks-used">
<h1><span class="small">Integration of Offline + Opticks : Where WITH_G4OPTICKS used ?</span></h1>
<p class="small">Offline Opticks : <tt class="docutils literal">#ifdef WITH_G4OPTICKS ... #endif</tt> + <tt class="docutils literal">if(m_opticksMode &gt; 0){ ... }</tt></p>
<pre class="mypre">
cd $JUNOTOP/offline/Simulation/DetSimV2 ; find . -type f -exec grep -l WITH_G4OPTICKS {} \+

./DetSimOptions/src/DetSim0Svc.cc                  ## initialize/finalize
./DetSimOptions/src/LSExpDetectorConstruction.cc   ## translate geometry to GPU

./PhysiSim/src/DsG4Scintillation.cc    ## collect Scintillation gensteps, excluding reemission
./PhysiSim/src/LocalG4Cerenkov1042.cc  ## collect Cerenkov gensteps
./PhysiSim/src/DsPhysConsOptical.cc    ## use LocalG4Cerenkov1042 rather than G4Cerenkov

./PMTSim/src/PMTSDMgr.cc         ## setup separate PMTHitMerger m_pmthitmerger_opticks
./PMTSim/src/junoSD_PMT_v2.cc    ## bulk hit creation+collection at EndOfEvent
</pre><dl class="small docutils">
<dt><tt class="docutils literal"><span class="pre">junoSD_PMT_v2::Initialize</span></tt></dt>
<dd><ul class="first last simple">
<li>setup extra <strong>hitCollection_opticks</strong>  <span class="red">(temporarily doing both GPU+CPU sim, with separate hits + merger)</span></li>
</ul>
</dd>
<dt><tt class="docutils literal"><span class="pre">junoSD_PMT_v2::EndOfEvent_Opticks</span></tt></dt>
<dd><ul class="first last simple">
<li>invoke <tt class="docutils literal"><span class="pre">G4Opticks::propagateOpticalPhotons</span></tt> with the gensteps collected</li>
<li>bulk populate <strong>hitCollection_opticks</strong></li>
</ul>
</dd>
</dl>
<ul class="small simple">
<li><a class="reference external" href="https://juno.ihep.ac.cn/mediawiki/index.php/Offline:Installation#building_the_offline_-DWITH_G4OPTICKS">https://juno.ihep.ac.cn/mediawiki/index.php/Offline:Installation#building_the_offline_-DWITH_G4OPTICKS</a></li>
</ul>
</div>
<div class="slide" id="integration-of-offline-opticks-where-with-g4opticks-used-talk">
<h1><span class="small">Integration of Offline + Opticks : Where WITH_G4OPTICKS used ?</span> Talk</h1>
<p class="normal">Not everyone has an NVIDIA GPU, so Opticks is optional.</p>
<p class="normal">Because of this all usage is &quot;hidden&quot; behind:</p>
<ol class="normal arabic simple">
<li>WITH_G4OPTICKS compilation macro</li>
<li>opticksMode runtime switch</li>
</ol>
<p class="normal">The Opticks integration changes code in 3 packages</p>
<ul class="normal simple">
<li>DetSimOptions</li>
<li>PhysiSim</li>
<li>PMTSim</li>
</ul>
<dl class="normal docutils">
<dt>DetSimOptions</dt>
<dd>handles lifecycle + passing the geometry world pointer to Opticks for translation</dd>
<dt>PhysiSim</dt>
<dd>collects Gensteps from Scintillation and Cerenkov processes</dd>
<dt>PMTSim</dt>
<dd><blockquote class="first">
invokes the GPU opticalPhotonSimulation and populates the hit collection in bulk,
at the end of the event</blockquote>
<p class="last">Again, more details are in the wiki at that link.</p>
</dd>
</dl>
</div>
<div class="slide" id="integration-of-offline-opticks-tut-detsim-py-options">
<h1><span class="small">Integration of Offline + Opticks : tut_detsim.py options</span></h1>
<p class="small"><em>tut_detsim.py</em> options relevant to Opticks usage : <span class="red">TODO: user friendly Opticks control interface</span></p>
<dl class="small docutils">
<dt><tt class="docutils literal"><span class="pre">--opticks-mode</span> 0</tt></dt>
<dd>do not use Opticks GPU propagation, the default</dd>
<dt><tt class="docutils literal"><span class="pre">--opticks-mode</span> 1</tt> (currently <span class="green">SVN trunk r3990</span>)</dt>
<dd>performs both CPU and GPU optical simulations
put GPU hits into separate <strong>hitCollectionOpticks</strong></dd>
<dt><tt class="docutils literal"><span class="pre">--no-guide_tube</span></tt></dt>
<dd>change geometry skipping the guide tube torus</dd>
<dt><tt class="docutils literal"><span class="pre">--pmt20inch-polycone-neck</span></tt></dt>
<dd>change geometry of LPMT necks avoiding use of torus</dd>
</dl>
<p class="small"><tt class="docutils literal">tds</tt> : <strong>Example Bash Function :</strong></p>
<pre class="mypre">
tds-(){ python $JUNOTOP/offline/Examples/Tutorial/share/tut_detsim.py $* ; }
tds(){ tds- --opticks-mode 1 --no-guide_tube --pmt20inch-polycone-neck --evtmax 2 gun ; }
</pre><ul class="small simple">
<li><a class="reference external" href="https://juno.ihep.ac.cn/mediawiki/index.php/Offline:Detsimuserguide/UsingOpticks">https://juno.ihep.ac.cn/mediawiki/index.php/Offline:Detsimuserguide/UsingOpticks</a></li>
</ul>
</div>
<div class="slide" id="integration-of-offline-opticks-tut-detsim-py-options-talk">
<h1><span class="small">Integration of Offline + Opticks : tut_detsim.py options</span> Talk</h1>
<p class="normal">tut_detsim.py options relevant to using Opticks are collected here</p>
<p class="normal"><strong>--opticks-mode</strong> is the main control</p>
<p class="normal">Currently both CPU and GPU simulations are done, with GPU hits going into
a separate hit collection.</p>
<ul class="normal simple">
<li>Trying to use standard geometry with torus exits at Opticks geometry translation.</li>
<li>Trying to use non-zero opticks-mode with code not compiled WITH_G4OPTICKS
exits at initialization.</li>
</ul>
<p class="normal">More details in the wiki</p>
</div>
<div class="slide" id="juno-geometry-remove-torus-to-enable-translation-to-gpu">
<h1><span class="small">JUNO Geometry : Remove Torus to enable translation to GPU</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><span class="small">Why Avoid Torus ?</span></p>
<p class="small"><strong>Double heavy quartic root finding</strong></p>
<ul class="small simple">
<li>fragile (crashes in some OptiX versions)</li>
<li>precision problems in CSG combinations</li>
<li>mere presence in OptiX kernel <span class="red">kills RTX mode performance by factor 10</span></li>
</ul>
<p class="small"><strong>Alternative Approaches To Cope With Torus</strong></p>
<ul class="small last simple">
<li>triangulated torus</li>
<li>TODO : ray marching (aka sphere tracing) signed distance function (SDF) model</li>
</ul>
</div>
<p class="small"><strong>tut_detsim.py options (in SVN trunk r3990)</strong></p>
<dl class="small docutils">
<dt><tt class="docutils literal"><span class="pre">--no-guide_tube</span></tt></dt>
<dd>skip the guide tube torus</dd>
<dt><tt class="docutils literal"><span class="pre">--pmt20inch-polycone-neck</span></tt></dt>
<dd><p class="first">&quot;cylinder - torus&quot; -&gt; polycone</p>
<ul class="last simple">
<li>NNVT_MCPPMT_PMTSolid</li>
<li>Hamamatsu_R12860_PMTSolid</li>
</ul>
</dd>
<dt><tt class="docutils literal"><span class="pre">--pmt20inch-simplify-csg</span></tt></dt>
<dd><p class="first">simpler+faster CSG, same geometry</p>
<ul class="last simple">
<li>avoids Inner_Separator anti-pattern</li>
</ul>
</dd>
</dl>
</div>
<div class="slide" id="juno-geometry-remove-torus-to-enable-translation-to-gpu-talk">
<h1><span class="small">JUNO Geometry : Remove Torus to enable translation to GPU</span> Talk</h1>
<p class="normal">Torus intersection is such a problem, that the best solution is
to avoid torus : I think it is perfectly acceptable to do so, because
the guide tube is not important for optical photons and the torus
based PMT neck is cosmetic only in my opinion.</p>
<!-- comment


:i:`scan-pf-1_Opticks_vs_Geant4 2`
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

.. raw:: html

    <pre>




    </pre>


.. class:: small

    .. table::
        :align: center

        +- - - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - -+
        | JUNO analytic, 400M photons from center         |  Speedup         |
        +====================+============================+==================+
        | Geant4 Extrap.     | 95,600 s (26 hrs)          |                  |
        +- - - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - -+
        | Opticks RTX ON (i) | 58 s                       |   1650x          |
        +- - - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - -+


.. s5_talk::


   The GPU used for these tests is the Quadro RTX 8000 with 48GB VRAM.

   This compares the extrapolated Geant4 propagation time with the Opticks launch
   interval with RTX on.   The speedup is more than a factor of 1000.   Need to
   use a log scale to make them both visible.

   For 400M photons, Geant4 takes more than a day, Opticks takes less than a minute.

   This is with analytic geometry. Speedup is a lot more with triangles. -->
</div>
</div>
</body>
</html>
