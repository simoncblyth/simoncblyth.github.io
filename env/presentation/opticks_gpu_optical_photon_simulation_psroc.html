<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<meta name="version" content="S5 1.1" />
<title>Opticks : GPU Optical Photon Simulation</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="visible" />
<!-- style sheet links -->
<script src="ui/my-small-white/slides.js" type="text/javascript"></script>
<link rel="stylesheet" href="ui/my-small-white/slides.css"
      type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/my-small-white/outline.css"
      type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/my-small-white/print.css"
      type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/my-small-white/opera.css"
      type="text/css" media="projection" id="operaFix" />
</head>
<body>
<div class="layout">
<div id="controls"></div>
<div id="currentSlide"></div>
<div id="header">

</div>
<div id="footer">
<h1>Opticks : GPU Optical Photon Simulation</h1>

</div>
</div>
<div class="presentation">
<div class="slide" id="slide0">
<h1 class="title">Opticks : GPU Optical Photon Simulation</h1>

<!-- comment -->
<style type="text/css">
    span.alarm { color: red; }
    span.warn { color: orange; }
    span.ok { color: green; }
    span.i { display: none; }
    pre.sliteral { class:"literal-block small"; }
    pre.mypre {
         display: block;
         font-family: monospace;
         font-size: 20px;
         white-space: pre;
         margin: 1em 0;
    }

</style><!-- Definitions of interpreted text roles (classes) for S5/HTML data. -->
<!-- This data file has been placed in the public domain. -->
<!-- Colours
======= -->
<!-- Text Sizes
========== -->
<!-- Display in Slides (Presentation Mode) Only
========================================== -->
<!-- Display in Outline Mode Only
============================ -->
<!-- Display in Print Only
===================== -->
<!-- Display in Handout Mode Only
============================ -->
<!-- Incremental Display
=================== -->

       <style type="text/css">

          div.slide { 
             background-clip: border-box;
             background-repeat: no-repeat;
             height: 100%;
          }
          div.slide#slide0{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20140419-170713-1024x768.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#g4daeview-py-fast-opengl-3d-viewer-for-g4dae-files{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20140419-170713.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#cerenkov-photons-simulation-top-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-115923.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#cerenkov-photons-simulation-side-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-115935.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#scintillation-photons-simulation-top-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-121444.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#scintillation-photons-simulation-side-view{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20141224-121435.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#standard-geant4-workflow{
             background-image: url(/env/keynotefigs/G4DAEChroma/G4DAEChroma.001.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#external-photon-simulation-workflow{
             background-image: url(/env/keynotefigs/G4DAEChroma/G4DAEChroma.002.png);
             background-size: auto auto;
             background-position: 0px 0px;
          }
          div.slide#ggeoview{
             background-image: url(/env/graphics/ggeoview/ggeoview-cerenkov-001.png);
             background-size: 1047px 795px;
             background-position: 0px 0px;
          }
          div.slide#ggeoview-m1-points{
             background-image: url(/env/graphics/ggeoview/ggeoview-scintillation-points-mat1.png);
             background-size: 1435px 848px;
             background-position: 0px 0px;
          }
          div.slide#ggeoview-flag-selection{
             background-image: url(/env/graphics/ggeoview/ggeoview-scintillation-flag-seq-select.png);
             background-size: 1436px 842px;
             background-position: 0px 0px;
          }
          div.slide#ggeoview-cerenkov-geom-m1{
             background-image: url(/env/graphics/ggeoview/ggeoview-cerenkov-m1-geom.png);
             background-size: 1416px 845px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-inside-wide{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-wide_half.png);
             background-size: 1432px 844px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-wide{
             background-image: url(/env/graphics/ggeoview/jpmt-wide_half.png);
             background-size: 1409px 836px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-headview{
             background-image: url(/env/graphics/ggeoview/jpmt-headview_half.png);
             background-size: 1308px 783px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-backview{
             background-image: url(/env/graphics/ggeoview/jpmt-backview_half.png);
             background-size: 1149px 794px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-approach{
             background-image: url(/env/graphics/ggeoview/jpmt-approach_half.png);
             background-size: 1431px 839px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-arrival{
             background-image: url(/env/graphics/ggeoview/jpmt-arrival_half.png);
             background-size: 1427px 841px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-before-contact-1{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-before-contact-2{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-before-contact-3{
             background-image: url(/env/graphics/ggeoview/jpmt-before-contact_half.png);
             background-size: 1430px 844px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-after-contact{
             background-image: url(/env/graphics/ggeoview/jpmt-after-contact_half.png);
             background-size: 1425px 840px;
             background-position: 0px 0px;
          }
          div.slide#jpmt-inside-outside{
             background-image: url(/env/graphics/ggeoview/jpmt-inside-outside_half.png);
             background-size: 1401px 842px;
             background-position: 0px 0px;
          }
          div.slide#nvidia-optix-in-action{
             background-image: url(/env/presentation/optix-in-action_half.png);
             background-size: 966px 646px;
             background-position: 100px 50px;
          }
          div.slide#detecting-neutrinos-via-optical-photons-1{
             background-image: url(/env/presentation/dayabay-principal_half.png);
             background-size: 1417px 830px;
             background-position: 0px 0px;
          }
          div.slide#detecting-neutrinos-via-optical-photons-2{
             background-image: url(/env/presentation/dayabay-principal_half.png);
             background-size: 1417px 830px;
             background-position: 0px 0px;
          }
          div.slide#x768{
             background-image: url(/env/geant4/geometry/collada/g4daeview/20140419-170713-1024x768.png);
             background-size: auto auto;
             background-position: 0px 0px;
          } 

       </style>
    <!-- comment

GGeoView image is 2094x1590 1047x795

GGeoView M1 Points is 2870x1696  1435x848

GGeoView Flag Selection 2872x1684 1436x842

GGeoView Cerenkov Geom M1 2832x1690 1416x845


Generated Scintillation Photons GPU cf Geant4
/env/g4dae/generated_scintillation_time_wavelength.png

G4/DetSim Generated Cerenkov Wavelength
/env/g4dae/g4_cerenkov_wavelength.png -->
<!-- comment

Placeholder

jpmt-after-contact.png 2850px_1680px
jpmt-approach.png 2862px_1678px
jpmt-arrival.png 2854px_1682px
jpmt-backview.png 2298px_1588px
jpmt-before-contact.png 2860px_1688px
jpmt-headview.png 2616px_1566px
jpmt-inside-outside.png 2802px_1684px
jpmt-wide.png 2818px_1672px -->
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/presentation/opticks_gpu_optical_photon_simulation_psroc.html">http://simoncblyth.bitbucket.org/env/presentation/opticks_gpu_optical_photon_simulation_psroc.html</a> (Jan 2016)
<a class="reference external" href="http://simoncblyth.bitbucket.org/env/presentation/opticks_gpu_optical_photon_simulation.html">http://simoncblyth.bitbucket.org/env/presentation/opticks_gpu_optical_photon_simulation.html</a> (Jan 2016)
<a class="reference external" href="http://simoncblyth.bitbucket.org/env/presentation/optical_photon_simulation_with_nvidia_optix.html">http://simoncblyth.bitbucket.org/env/presentation/optical_photon_simulation_with_nvidia_optix.html</a> (July 2015)</p>
<p class="small"><strong>Executive Summary</strong></p>
<p class="small"><em>Opticks</em> integrates <em>Geant4</em> simulations with state-of-the-art <strong>NVIDIA OptiX</strong> GPU ray tracing.</p>
<ul class="small simple">
<li>DayaBay, JUNO can expect: <strong>Opticks &gt; 1000x G4</strong> (workstation GPUs)</li>
</ul>
<p class="small"><strong>Contents</strong></p>
<ul class="small simple">
<li>Neutrino Detection via Optical Photons</li>
<li>Optical Photon Simulation Problem</li>
<li>NVIDIA OptiX GPU Ray Tracing Framework</li>
<li>Brief History of GPU Optical Photon Simulation Development</li>
<li>Introducing <em>Opticks</em> : Recreating G4 Context on GPU</li>
<li>Validating <em>Opticks</em> against <em>Geant4</em></li>
<li><em>Opticks</em> Overview</li>
</ul>
<div class="small line-block">
<div class="line">Simon C Blyth, National Taiwan University</div>
<div class="line"><strong>January 2016</strong></div>
</div>

</div>
<div class="slide" id="detecting-neutrinos-via-optical-photons-1">
<h1><span class="i">Detecting Neutrinos via Optical Photons 1</span></h1>
</div>
<div class="slide" id="detecting-neutrinos-via-optical-photons-2">
<h1><span class="i">Detecting Neutrinos via Optical Photons 2</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Neutrino Detection via Optical Photons</p>
<p class="small">Inverse beta decay: electron anti-neutrino captured on
proton producing prompt positron and delayed neutron signals.
Despite overburden cosmic muons remain important backgrounds.</p>
<p class="small"><span class="red">-&gt; large transparent target volumes coupled to Photomultiplier Tubes</span></p>
<p class="small"><strong>Scintillator:</strong> DayaBay/JUNO, Double Chooz, RENO, KamLAND</p>
<p class="small"><strong>Water Cerenkov:</strong> SNO, SuperK/HyperK, IceCube/PINGU, KM3NeT, Baikal-GVD</p>
<p class="small last">Detailed model of <strong>Optical Photon Propagation</strong>
critical to detector design/use.</p>
</div>
</div>
<div class="slide" id="jpmt-before-contact-1">
<h1><span class="i">JPMT Before Contact 1</span></h1>
</div>
<div class="slide" id="jpmt-before-contact-2">
<h1><span class="i">JPMT Before Contact 2</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Optical Photon Simulation Problem</p>
<p class="small">Cosmic muons can yield many millions
of optical photons in Daya Bay (even more in JUNO).
Optical photon propagation dominates
<em>Geant4</em> simulation time ~95% for Daya Bay.</p>
<p class="small">Cosmic Muon Sample sizes severely limited by
CPU time practicalities.</p>
<p class="small"><strong>Hybrid Solution</strong></p>
<p class="small">External propagation possible as optical photons
are isolated in simulation chain.</p>
<ul class="small last simple">
<li>produced by Cerenkov/Scintillation</li>
<li>yield only PMT hits</li>
</ul>
</div>
</div>
<div class="slide" id="jpmt-before-contact-3">
<h1><span class="i">JPMT Before Contact 3</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Geant4/Opticks Interface</p>
<ul class="small last simple">
<li>collect &quot;steps&quot; in customized G4 Cerenkov/Scintillation processes</li>
<li>massively parallel generation, propagation of optical photons costing no CPU memory</li>
<li>return PMT hits to G4 collections</li>
<li>subsequent electronics simulation unchanged</li>
</ul>
</div>
</div>
<div class="slide" id="nvidia-optix-gpu-ray-tracing-framework">
<h1><span class="small">NVIDIA OptiX GPU Ray Tracing Framework</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Ray Tracing ?</p>
<p class="small">Pixels calculated by tracing rays from image plane into geometry,
recursively doing reflection, refraction, shadow calculations.</p>
<img alt="/env/optix/samples/optix-tutorial-10.png" class="align-right" src="/env/optix/samples/optix-tutorial-10.png" style="width: 400px;" />
<p class="small last">Ray Tracing more realistic (closer to physics) than rasterized projection</p>
</div>
<p class="small"><strong>Apply Image Synthesis Tool to Photon Simulation</strong></p>
<p class="small">Same rate determining step : <strong>geometry intersection</strong></p>
<p class="small"><strong>OptiX Provides:</strong></p>
<p class="small"><span class="blue">CUDA compiler optimized for Ray Tracing</span></p>
<ul class="small simple">
<li>state-of-the-art accelerated intersection</li>
<li>regular improvements, new GPU tuning</li>
</ul>
<p class="small"><span class="red">NVIDIA expertise on efficient GPU(s) usage</span></p>
<ul class="small simple">
<li>persistent warps sized to fill machine</li>
<li>load balancing between warps, GPUs</li>
</ul>
<p class="small"><strong>IHEP Performance Check</strong></p>
<p class="small">Used IHEP 4 GPU workstation to verify
near linear performance scaling across multiple GPUs</p>
<p class="tiny"><a class="reference external" href="https://developer.nvidia.com/optix">https://developer.nvidia.com/optix</a></p>
<p class="tiny"><a class="reference external" href="https://research.nvidia.com/publication/optix-general-purpose-ray-tracing-engine">https://research.nvidia.com/publication/optix-general-purpose-ray-tracing-engine</a></p>
</div>
<div class="slide" id="brief-history-of-gpu-optical-photon-simulation-development">
<h1><span class="small">Brief History of GPU Optical Photon Simulation Development</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Hybrid Simulation</p>
<p class="small">Combining G4 with external simulation
requires &quot;context&quot; duplication</p>
<ul class="small simple">
<li>geometry, materials, surfaces</li>
<li>runtime bridging of event data</li>
</ul>
<p class="small">Ray Tracing demands translation:</p>
<ul class="small last simple">
<li>volumes -&gt; surfaces</li>
</ul>
</div>
<p class="small"><strong>1704</strong></p>
<ul class="small simple">
<li>Newton published <em>Opticks</em></li>
</ul>
<p class="small"><strong>2013(Aug-)</strong> [liberate geometry]</p>
<ul class="small simple">
<li>Develop <em>G4DAE</em> geometry exporter that writes tesselated COLLADA 3D files,
including all material and surface properties.</li>
</ul>
<p class="small"><strong>2014</strong> [integrate geometry/event data with <em>Chroma</em>]</p>
<ul class="small simple">
<li>Integrate <em>G4DAE</em> geometries with <em>Chroma</em></li>
<li>Connect event data via <em>G4DAEChroma</em> runtime bridge</li>
<li>Port Cerenkov/Scintillation photon generation to GPU avoiding transport overhead</li>
</ul>
<p class="small"><strong>2015</strong> [replace <em>Chroma</em> with <em>Opticks</em>]</p>
<ul class="small simple">
<li>Develop <em>Opticks</em> based on the <em>NVIDIA OptiX</em> ray tracing framework</li>
<li>Achieve match between <em>Opticks</em> and <em>Geant4</em> for simple geometries</li>
<li>Speedup factor of 200x with a mobile GPU, expected to exceed 1000x with multi-GPU workstations.</li>
</ul>
</div>
<div class="slide" id="introducing-opticks-recreating-g4-context-on-gpu">
<h1><span class="small">Introducing Opticks : Recreating G4 Context on GPU</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Opticks ~15 C++ Pkgs</p>
<p class="small">Organized by dependencies</p>
<ul class="small simple">
<li><span class="red">Recreates Geant4 context on GPU</span></li>
<li><span class="blue">Optical simulation by OptiX programs</span></li>
<li><span class="blue">Photon Indexing by Thrust</span></li>
</ul>
<p class="small">Interop between OpenGL/OptiX/Thrust/CUDA</p>
<ul class="small simple">
<li><span class="blue">shared GPU buffers, efficient visualization</span></li>
</ul>
<p class="small">C++ code but NumPy analysis/debugging by using
<span class="red">.npy serialization</span> for all buffers</p>
<p class="small">Externals:</p>
<ul class="small last simple">
<li>Boost + Asio-ZMQ, ZMQ</li>
<li>CUDA 7.0, Thrust 1.8</li>
<li>OptiX 3.8, OpenGL 4.1</li>
<li>OpenMesh 4.1, ImGUI</li>
</ul>
</div>
<p class="small"><strong>Basis packages</strong></p>
<ul class="small simple">
<li><em>Opticks</em> : definitions, configuration</li>
<li><em>NPY</em> : host array handling, persistency, analysis</li>
<li><em>NumpyServer</em> : network IO of <em>NPY</em> arrays</li>
</ul>
<p class="small"><strong>Geometry packages</strong></p>
<ul class="small simple">
<li><em>AssimpWrap</em> : G4DAE geometry loading with Assimp fork</li>
<li><em>GGeo</em> : preparing geometry for GPU</li>
<li><em>OpenMeshRap</em> : mesh fixing</li>
</ul>
<p class="small"><strong>GPU library interface packages</strong></p>
<ul class="small simple">
<li><em>OpticksOp</em> : high level GPU control</li>
<li><em>OptiXRap</em> : OptiX control</li>
<li><em>ThrustRap</em> : photon indexing</li>
<li><em>CUDAWrap</em> : persist cuRAND state</li>
<li><em>OGLWrap</em> : OpenGL visualization</li>
</ul>
<p class="small"><strong>Main packages</strong></p>
<ul class="small simple">
<li><em>GGeoView</em> : visualization, Opticks main</li>
<li><em>CFG4</em> : Geant4 10.2 comparison, separate main</li>
</ul>
</div>
<div class="slide" id="opticks-absolute-reflection-compared-to-fresnel-expectation">
<h1><span class="small">Opticks Absolute Reflection compared to Fresnel expectation</span></h1>
<p class="tiny">Comparison of simulated absolute reflection of S and P polarized single events against
expectation from Fresnel formula. Using uniform planar incident cyclindrically directed light.</p>
<img alt="/env/numerics/npy/reflection.png" class="align-center" src="/env/numerics/npy/reflection.png" style="width: 700px;" />
</div>
<div class="slide" id="opticks-prism-deviation-vs-incident-angles-for-10-wavelengths">
<h1><span class="small">Opticks Prism Deviation vs Incident angles for 10 wavelengths</span></h1>
<p class="tiny">Prism geometry and Snell's law at two refractions allows deviation
angle vs incident angle to be predicted.  Comparison of simulation
results with expectations for 10 wavelengths
using refractive index of Schott F2 Flint Glass.</p>
<img alt="/env/numerics/npy/prism-deviation.png" class="align-center" src="/env/numerics/npy/prism-deviation.png" style="width: 900px;" />
</div>
<div class="slide" id="validating-opticks-against-geant4">
<h1><span class="small">Validating Opticks against Geant4</span></h1>
<div class="sidebar">
<p class="first sidebar-title"><em>CfG4</em> package</p>
<ul class="small last simple">
<li>G4 step recorder in <em>Opticks</em> event format</li>
<li>load events into <em>Opticks</em> for visualization</li>
</ul>
</div>
<p class="small">Compare <em>Opticks</em>/<em>Geant4</em> propagations with simple test geometries
and light sources. For each test shape:</p>
<ul class="small simple">
<li><em>OptiX</em>: analytic intersection code</li>
<li><em>OpenGL</em>: tesselation for visualization</li>
<li><em>Geant4</em>: geometry construction code in <em>CfG4</em> package</li>
</ul>
<table border="1" class="small docutils">
<colgroup>
<col width="45%" />
<col width="18%" />
<col width="18%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Shape</th>
<th class="head">OptiX</th>
<th class="head">OpenGL</th>
<th class="head">Geant4</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>sphere</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr><td>box</td>
<td>needs debug</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr><td>prism</td>
<td>Y</td>
<td>Y</td>
<td>&nbsp;</td>
</tr>
<tr><td>convex lens</td>
<td>Y</td>
<td>Y</td>
<td>&nbsp;</td>
</tr>
<tr><td>DayaBay PMT</td>
<td>Y</td>
<td>Y</td>
<td>needs port</td>
</tr>
</tbody>
</table>
</div>
<div class="slide" id="multiple-rainbows-from-a-single-drop-of-water">
<h1><span class="small">Multiple Rainbows from a Single Drop of Water</span></h1>
<img alt="/env/presentation/rainbow-mechanism.png" class="align-center" src="/env/presentation/rainbow-mechanism.png" style="width: 900px;" />
<p class="small">Caustic bunching at least deviation causes rainbow</p>
<ol class="small loweralpha simple">
<li>Primary bow, single reflection : ray f at bow angle</li>
<li>Secondary bow, double reflection : ray g at bow angle</li>
<li>Deviation angles 0:180 degrees hemisphere opposite to incident rays</li>
</ol>
<p class="tiny">Jearl D. Walker, 1975, Multiple rainbows from single drops of water and other liquids
<a class="reference external" href="http://patarnott.com/atms749/pdf/MultipleRainbowsSingleDrops.pdf">http://patarnott.com/atms749/pdf/MultipleRainbowsSingleDrops.pdf</a></p>
</div>
<div class="slide" id="disc-beam-1m-photons-incident-on-water-sphere-s-pol">
<h1><span class="small">Disc beam 1M Photons incident on Water Sphere (S-Pol)</span></h1>
<p class="tiny">Photons shown by lines with color representing polarization direction. S-Polarized (perpendicular to plane of incidence)
intersection by disc radially directed polarization. Geodesic icosahedron tesselation just for OpenGL visualization,
actual OptiX geometry is perfect sphere.</p>
<img alt="/env/graphics/ggeoview/rainbow-spol-disc-incident-sphere.png" class="align-center" src="/env/graphics/ggeoview/rainbow-spol-disc-incident-sphere.png" style="width: 900px;" />
</div>
<div class="slide" id="ns-later-several-bows-apparent">
<h1><span class="small">2ns later, Several Bows Apparent</span></h1>
<img alt="/env/graphics/ggeoview/rainbow-spol-disc-several-bows.png" class="align-center" src="/env/graphics/ggeoview/rainbow-spol-disc-several-bows.png" style="width: 900px;" />
</div>
<div class="slide" id="rainbow-deviation-angles">
<h1><span class="small">Rainbow deviation angles</span></h1>
<p class="tiny">Deviation angle distribution of all 3M photons. Photon wavelengths
from Plankian 6500K blackbody spectrum (implemented with inverse CDF GPU texture lookup).
Simulated &quot;images&quot; obtained from wavelength spectrum of each bin using CIEXYZ weighting functions
converted into sRGB/D65 colorspace.
The two images exposed for luminance (CIE-Y) of max bin of 1st and 2nd bows.</p>
<img alt="/env/numerics/npy/rainbow16_deviation_angle.png" class="align-center" src="/env/numerics/npy/rainbow16_deviation_angle.png" style="width: 900px;" />
</div>
<div class="slide" id="rainbow-spectrum-for-1st-six-bows">
<h1><span class="small">Rainbow Spectrum for 1st six bows</span></h1>
<p class="tiny">Spectra obtained by selecting photons by internal reflection counts.
Colors obtained from spectra of each bin using CIEXYZ weighting functions
converted into sRGB/D65 colorspace.
Exposures by normalizing to bin with maximum luminance (CIE-Y) of each bow.
White lines indicate geometric optics prediction of deviation angle ranges
of the visible range 380-780nm. 180-360 degrees signifies exit on same
side of droplet as incidence.</p>
<img alt="/env/numerics/npy/rainbow6-spectrum.png" class="align-center" src="/env/numerics/npy/rainbow6-spectrum.png" style="width: 900px;" />
</div>
<div class="slide" id="m-rainbow-s-polarized-comparison-opticks-geant4">
<h1><span class="small">1M Rainbow S-Polarized, Comparison Opticks/Geant4</span></h1>
<p class="tiny">Deviation angle(degrees) of 1M parallel monochromatic photons in disc shaped beam incident on water sphere.
Numbered bands are visible range expectations of first 11 rainbows.
S-Polarized intersection (E field perpendicular to plane of incidence) arranged by directing polarization radially.</p>
<img alt="/env/optix/cfg4/rainbow-cfg4-spol.png" class="align-center" src="/env/optix/cfg4/rainbow-cfg4-spol.png" style="width: 800px;" />
</div>
<div class="slide" id="performance-comparison-opticks-geant4">
<h1><span class="small">Performance Comparison Opticks/Geant4</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Rainbow 1M S-Pol</p>
<img alt="/env/optix/cfg4/rainbow-cfg4-2.png" class="small last align-center" src="/env/optix/cfg4/rainbow-cfg4-2.png" style="width: 400px;" />
</div>
<p class="small"><strong>Average Propagate Time for 1M photons</strong></p>
<p class="small">MacBook Pro 2013, NVIDIA GeForce GT 750M 2GB (384 cores)</p>
<table border="1" class="small docutils">
<colgroup>
<col width="28%" />
<col width="24%" />
<col width="24%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Rainbow Test</th>
<th class="head">Geant4 10.2</th>
<th class="head">Opticks Interop</th>
<th class="head">Opticks Compute</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>1M (S-Pol)</td>
<td>56 s</td>
<td>1.62 s</td>
<td>0.28 s</td>
</tr>
<tr><td>1M (P-Pol)</td>
<td>58 s</td>
<td>1.71 s</td>
<td>0.25 s</td>
</tr>
</tbody>
</table>
<ul class="small simple">
<li><strong>Opticks ~200X Geant4</strong> with 384 core GPU</li>
<li>expect <strong>&gt; 1000X</strong> with multi-GPU workstation</li>
<li><span class="red">photon propagation time --&gt; zero (effectively)</span></li>
</ul>
<p class="small"><strong>Opticks Interop/Compute Modes</strong></p>
<ul class="small simple">
<li><strong>Interop</strong>: uses visualizable OpenGL buffers</li>
<li><strong>Compute</strong>: uses OptiX buffers</li>
<li>perfectly identical results, monitored by digest</li>
<li>Compute (and G4) propagated events visualizable
by loading into interop mode viewer</li>
</ul>
</div>
<div class="slide" id="jpmt-inside-wide">
<h1><span class="i">JPMT Inside Wide</span></h1>
<div class="sidebar">
<p class="first sidebar-title">Opticks Overview</p>
<ul class="small last simple">
<li><em>G4</em> integrated with GPU ray tracing</li>
<li>validation against <em>G4</em> started</li>
<li><span class="red">optical propagation time --&gt; ~zero</span></li>
<li>high performance visualization</li>
</ul>
</div>
</div>
<div class="slide" id="jpmt-wide">
<h1><span class="i">JPMT Wide</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-wide_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-wide_half.png</a></p>
</div>
<div class="slide" id="jpmt-after-contact">
<h1><span class="i">JPMT After Contact</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-after-contact_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-after-contact_half.png</a></p>
</div>
<div class="slide" id="jpmt-approach">
<h1><span class="i">JPMT Approach</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-approach_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-approach_half.png</a></p>
</div>
<div class="slide" id="jpmt-arrival">
<h1><span class="i">JPMT Arrival</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-arrival_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-arrival_half.png</a></p>
</div>
<div class="slide" id="jpmt-inside-outside">
<h1><span class="i">JPMT Inside Outside</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-inside-outside_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-inside-outside_half.png</a></p>
<div class="sidebar">
<p class="first sidebar-title">Photon History Selection</p>
<p class="last">Only <em>CK BT BT BT SA</em>, three boundary transmits before surface absorption</p>
</div>
</div>
<div class="slide" id="jpmt-headview">
<h1><span class="i">JPMT Headview</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-headview_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-headview_half.png</a></p>
</div>
<div class="slide" id="jpmt-backview">
<h1><span class="i">JPMT Backview</span></h1>
<p class="tiny"><a class="reference external" href="http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-backview_half.png">http://simoncblyth.bitbucket.org/env/graphics/ggeoview/jpmt-backview_half.png</a></p>
</div>
</div>
</body>
</html>
