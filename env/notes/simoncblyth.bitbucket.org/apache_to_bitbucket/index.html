<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Apache to bitbucket &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../" />
    <link rel="up" title="simoncblyth.bitbucket.org" href="../" />
    <link rel="prev" title="Bitbucket Static Pages" href="../bitbucketstatic/" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../bitbucketstatic/" title="Bitbucket Static Pages"
             accesskey="P">previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../">Env  documentation</a> &raquo;</li>

          <li><a href="../" accesskey="U">simoncblyth.bitbucket.org</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pycuda/">pycuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geant4/">geant4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chroma/">chroma</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../javascript/">javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nuwa/">nuwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hg/">hg</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">simoncblyth.bitbucket.org</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bitbucketstatic/">Bitbucket Static Pages</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Apache to bitbucket</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/simoncblyth.bitbucket.org/apache_to_bitbucket.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../bitbucketstatic/"
                        title="previous chapter">Bitbucket Static Pages</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="apache-to-bitbucket">
<h1>Apache to bitbucket<a class="headerlink" href="#apache-to-bitbucket" title="Permalink to this headline">Â¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id1">Overview</a></li>
<li><a class="reference internal" href="#related" id="id2">Related</a></li>
<li><a class="reference internal" href="#creation" id="id3">Creation</a></li>
<li><a class="reference internal" href="#rst-doc-links" id="id4">RST doc links</a></li>
<li><a class="reference internal" href="#env-notes" id="id5">env notes</a></li>
<li><a class="reference internal" href="#bitbucket-static-pages-rejig" id="id6">Bitbucket Static pages rejig</a></li>
<li><a class="reference internal" href="#layout-migration-rejig" id="id7">Layout migration rejig</a></li>
<li><a class="reference internal" href="#whats-missing" id="id8">Whats missing</a></li>
<li><a class="reference internal" href="#sphinx-downloads" id="id9">Sphinx downloads</a></li>
<li><a class="reference internal" href="#existing-resource-approach-and-how-to-map-into-bitbucket" id="id10">existing resource approach and how to map into bitbucket</a></li>
<li><a class="reference internal" href="#managing-the-binaries" id="id11">managing the binaries</a></li>
<li><a class="reference internal" href="#dropbox-alternatives" id="id12">dropbox alternatives</a></li>
<li><a class="reference internal" href="#video-on-dropbox" id="id13">video on dropbox</a></li>
<li><a class="reference internal" href="#resource-collection" id="id14">resource collection</a></li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id1">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">Â¶</a></h2>
<p>Notes on migrating storing static resources (html pages, images, PDF, video)
from locally hosted apache to cloud servers from bitbucket and dropbox.</p>
</div>
<div class="section" id="related">
<h2><a class="toc-backref" href="#id2">Related</a><a class="headerlink" href="#related" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../"><em>simoncblyth.bitbucket.org</em></a></li>
</ul>
</div>
<div class="section" id="creation">
<h2><a class="toc-backref" href="#id3">Creation</a><a class="headerlink" href="#creation" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+Bitbucket">https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+Bitbucket</a></p>
<ol class="arabic">
<li><p class="first">With bitbucket web interface create repository named: <em>simoncblyth.bitbucket.org</em></p>
</li>
<li><p class="first">Clone that repo locally:</p>
<div class="highlight-python"><pre>delta:~ blyth$ hg clone ssh://hg@bitbucket.org/simoncblyth/simoncblyth.bitbucket.org
destination directory: simoncblyth.bitbucket.org
no changes found
updating to branch default
0 files updated, 0 files merged, 0 files removed, 0 files unresolved
delta:~ blyth$</pre>
</div>
</li>
<li><p class="first">add, commit, push static index.html to the root</p>
</li>
</ol>
</div>
<div class="section" id="rst-doc-links">
<h2><a class="toc-backref" href="#id4">RST doc links</a><a class="headerlink" href="#rst-doc-links" title="Permalink to this headline">Â¶</a></h2>
<p>Absolute Sphinx RST doc links need to omit the <strong>/env/notes</strong>
prefix that arises due to the positioning of the root index.html.</p>
<p>For example:</p>
<div class="highlight-python"><pre>:doc:`/simoncblyth.bitbucket.org/index`</pre>
</div>
<ul class="simple">
<li><a class="reference internal" href="../"><em>simoncblyth.bitbucket.org</em></a></li>
</ul>
</div>
<div class="section" id="env-notes">
<h2><a class="toc-backref" href="#id5">env notes</a><a class="headerlink" href="#env-notes" title="Permalink to this headline">Â¶</a></h2>
<p>Add <strong>bb</strong> target to ~/env/Makefile that populates ~/simoncblyth.bitbucket.org/env with
the Sphinx generated html.</p>
<ol class="arabic simple">
<li>slightly funny doing that out of svn working copy, but have not migrated yet, still testing</li>
</ol>
<div class="highlight-python"><pre>delta:simoncblyth.bitbucket.org blyth$ hg commit -m "test Sphinx html with bitbucket static pages "
delta:simoncblyth.bitbucket.org blyth$
delta:simoncblyth.bitbucket.org blyth$ hg push
pushing to ssh://hg@bitbucket.org/simoncblyth/simoncblyth.bitbucket.org
searching for changes
remote: adding changesets
remote: adding manifests
remote: adding file changes</pre>
</div>
</div>
<div class="section" id="bitbucket-static-pages-rejig">
<h2><a class="toc-backref" href="#id6">Bitbucket Static pages rejig</a><a class="headerlink" href="#bitbucket-static-pages-rejig" title="Permalink to this headline">Â¶</a></h2>
<p>C2 is again offline, last straw</p>
<ol class="arabic">
<li><p class="first">through bitbucket web interface</p>
<ul class="simple">
<li>delete repository named <em>simoncblyth.bitbucket.org</em></li>
<li>create repository named <em>simoncblyth.bitbucket.org</em>   # make it public this time</li>
</ul>
</li>
<li><p class="first">in file system:</p>
<div class="highlight-python"><pre>delta:~ blyth$ rm -rf simoncblyth.bitbucket.org    # delete old clone
delta:~ blyth$ hg clone ssh://hg@bitbucket.org/simoncblyth/simoncblyth.bitbucket.org   # clone the empty</pre>
</div>
</li>
<li><p class="first">amend <strong>bb</strong> target of env/Makefile Sphinx build to create/populate BITBUCKET_HTDOCS/env/notes and build:</p>
<div class="highlight-python"><pre>delta:e blyth$ make bb</pre>
</div>
</li>
<li><p class="first">amend target of env/muon_simulation/presentation/Makefile to create populate BITBUCKET_HTDOCS/env/muon_simulation/presentation and build:</p>
<div class="highlight-python"><pre>slides-;slides-scd;make  # OR slides-;slides-make</pre>
</div>
</li>
<li><p class="first">move original APACHE_HTDOCS/env to env.keep and create symbolic link to allow local apache
testing of html and resources without committing+pushing to bitbucket:</p>
<div class="highlight-python"><pre>delta:Documents blyth$ sudo ln -s /Users/blyth/simoncblyth.bitbucket.org/env</pre>
</div>
</li>
<li><p class="first">move across the contents of APACHE_HTDOCS/env.keep to the new BITBUCKET_HTDOCS/env
excluding the videos</p>
</li>
<li><p class="first">add to the bitbucket repo, mercurial complains about big PDF, so revert and place in Dropbox/Public</p>
<blockquote>
<div><p>env/muon_simulation/presentation/gpu_optical_photon_simulation.pdf: up to 115 MB of RAM may be required to manage this file
(use &#8216;hg revert env/muon_simulation/presentation/gpu_optical_photon_simulation.pdf&#8217; to cancel the pending addition)</p>
<dl class="docutils">
<dt>delta:simoncblyth.bitbucket.org blyth$ du -h env/muon_simulation/presentation/gpu_optical_photon_simulation.pdf</dt>
<dd><p class="first last">37M    env/muon_simulation/presentation/gpu_optical_photon_simulation.pdf</p>
</dd>
</dl>
<p>(adm_env)delta:simoncblyth.bitbucket.org blyth$ mv env/muon_simulation/presentation/gpu_optical_photon_simulation.pdf ~/Dropbox/Public/</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="layout-migration-rejig">
<h2><a class="toc-backref" href="#id7">Layout migration rejig</a><a class="headerlink" href="#layout-migration-rejig" title="Permalink to this headline">Â¶</a></h2>
<p>Sphinx derived html, for env at least, are very much <strong>notes</strong>.
Make that explicit and avoid double top &#8220;e&#8221; and &#8220;env&#8221; with
layout at expense of the path.  As all repos share the one</p>
<ol class="arabic simple">
<li>/env/notes   Sphinx derived notes</li>
<li>/env/...     other resources</li>
<li>/env/muon_simulation/presentation/</li>
</ol>
<p>Formerly Sphinx and slides building machinery generates html
into APACHE_HTDOCS/e and APACHE_HTDOCS/env respectively.
Instead of this generate into BITBUCKET_HTDOCS/env/notes and BITBUCKET_HTDOCS/env
Then can publish by a Mercurial commit and push.</p>
<p>All bitbucket repos under a username share the same single static pages repo,
so having a one to one correspondence to a top level dir named after
the repo is the cleanest way.</p>
</div>
<div class="section" id="whats-missing">
<h2><a class="toc-backref" href="#id8">Whats missing</a><a class="headerlink" href="#whats-missing" title="Permalink to this headline">Â¶</a></h2>
<p>On cms02, also used bare apache for docs like presentations and images:</p>
<div class="highlight-python"><pre>find $(apache-htdocs)/env</pre>
</div>
<p>Need way to reference those from Sphinx pages, and need to avoid the big ones:</p>
<div class="highlight-python"><pre>delta:env blyth$ du -hs $(apache-htdocs)/env
2.4G    /Library/WebServer/Documents/env</pre>
</div>
<p>Bitbucket limits</p>
<ul class="simple">
<li><a class="reference external" href="https://confluence.atlassian.com/pages/viewpage.action?pageId=273877699">https://confluence.atlassian.com/pages/viewpage.action?pageId=273877699</a></li>
<li><a class="reference external" href="http://stackoverflow.com/questions/1284669/how-do-i-manage-large-art-assets-appropriately-in-dvcs">http://stackoverflow.com/questions/1284669/how-do-i-manage-large-art-assets-appropriately-in-dvcs</a></li>
</ul>
<p>TODO: Investigate Dropbox for longterm holding of binaries</p>
</div>
<div class="section" id="sphinx-downloads">
<h2><a class="toc-backref" href="#id9">Sphinx downloads</a><a class="headerlink" href="#sphinx-downloads" title="Permalink to this headline">Â¶</a></h2>
<p>For small numbers of binaries can use Sphinx download with RST source like:</p>
<div class="highlight-python"><pre>described in the :download:`Chroma whitepaper &lt;chroma.pdf&gt;`.</pre>
</div>
<p>Not so keen on this,</p>
<ol class="arabic simple">
<li>it results in having multiple copies of the binary that
get copied around by the Sphinx build.</li>
<li>Prefer a single resource with a single URL, that never gets copied</li>
</ol>
</div>
<div class="section" id="existing-resource-approach-and-how-to-map-into-bitbucket">
<h2><a class="toc-backref" href="#id10">existing resource approach and how to map into bitbucket</a><a class="headerlink" href="#existing-resource-approach-and-how-to-map-into-bitbucket" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic simple">
<li>binaries (images, pdf, videos) served by apache from $APACHE_HTDOCS/env/</li>
<li>Sphinx derived html served from $APACHE_HTDOCS/e/</li>
</ol>
<p>Keeping big and unchanging binaries separate from
small and frequently changing html is a good pattern to continue.
Could map this into bitbucket via directory structure in the static
pages repo:</p>
<div class="highlight-python"><pre>/var/scm/mercurial/simoncblyth.bitbucket.org/e/
/var/scm/mercurial/simoncblyth.bitbucket.org/env/</pre>
</div>
<p>But its all one repo anyhow, that is populated by</p>
<ol class="arabic simple">
<li>sphinx build</li>
<li>manual placement of resources</li>
</ol>
<p>Could in principal create a script to merge
the resource and derived html trees ? But that introduces
complication and makes it difficult to do clean Sphinx builds.</p>
</div>
<div class="section" id="managing-the-binaries">
<h2><a class="toc-backref" href="#id11">managing the binaries</a><a class="headerlink" href="#managing-the-binaries" title="Permalink to this headline">Â¶</a></h2>
<p>Most of the binaries are not huge, only the video is potentially a problem,
maybe dropbox for that.  But need a way to select only binaries that are
actually referred to.</p>
</div>
<div class="section" id="dropbox-alternatives">
<h2><a class="toc-backref" href="#id12">dropbox alternatives</a><a class="headerlink" href="#dropbox-alternatives" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.yunio.com">https://www.yunio.com</a></li>
</ul>
</div>
<div class="section" id="video-on-dropbox">
<h2><a class="toc-backref" href="#id13">video on dropbox</a><a class="headerlink" href="#video-on-dropbox" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://tech.dropbox.com/2014/02/video-processing-at-dropbox/">https://tech.dropbox.com/2014/02/video-processing-at-dropbox/</a></li>
<li><a class="reference external" href="http://eastasiastudent.net/china/dropbox-no-vpn">http://eastasiastudent.net/china/dropbox-no-vpn</a></li>
<li><a class="reference external" href="http://techcrunch.com/2014/02/17/dropbox-now-accessible-for-the-first-time-in-china-since-2010/">http://techcrunch.com/2014/02/17/dropbox-now-accessible-for-the-first-time-in-china-since-2010/</a></li>
</ul>
<p>Right click on video stored in your Public Dropbox folder to get the Public link, include
that URL in</p>
<p>Some suggestions to add to /etc/hosts:</p>
<div class="highlight-python"><pre>174.36.30.73 www.dropbox.com
174.36.30.71 www.dropbox.com</pre>
</div>
</div>
<div class="section" id="resource-collection">
<h2><a class="toc-backref" href="#id14">resource collection</a><a class="headerlink" href="#resource-collection" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic simple">
<li>Extended ~/e/muon_simulation/presentation/rst2s5-2.6.py to doctree traverse collecting
and resolving the urls of resources used in the document (images, videos, background images).</li>
<li>~/e/bin/resources.py adding up sizes</li>
</ol>
<p><a class="reference external" href="https://www.dropbox.com/s/6jmcqxphnc8qhkg/g4daeview_001.m4v?dl=0">https://www.dropbox.com/s/6jmcqxphnc8qhkg/g4daeview_001.m4v?dl=0</a></p>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../bitbucketstatic/" title="Bitbucket Static Pages"
             >previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../">Env  documentation</a> &raquo;</li>

          <li><a href="../" >simoncblyth.bitbucket.org</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>