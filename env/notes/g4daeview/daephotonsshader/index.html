<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DAEPhotonsShader &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../">Env  documentation</a> &raquo;</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pycuda/">pycuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geant4/">geant4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chroma/">chroma</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../javascript/">javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nuwa/">nuwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hg/">hg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../simoncblyth.bitbucket.org/">simoncblyth.bitbucket.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numpy/">numpy</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/g4daeview/daephotonsshader.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="daephotonsshader">
<h1>DAEPhotonsShader<a class="headerlink" href="#daephotonsshader" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="opengl-shader-language">
<h1>OpenGL Shader Language<a class="headerlink" href="#opengl-shader-language" title="Permalink to this headline">¶</a></h1>
<div class="section" id="glsl-120">
<h2>GLSL 120<a class="headerlink" href="#glsl-120" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.google.com/search?q=glsl 120 spec">google:glsl 120 spec</a><ul>
<li><a class="reference external" href="http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf">http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="glsl-120-extensions">
<h2>GLSL 120 Extensions<a class="headerlink" href="#glsl-120-extensions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/questions/15107521/opengl-extensions-how-to-use-them-correctly-in-c-and-glsl">http://stackoverflow.com/questions/15107521/opengl-extensions-how-to-use-them-correctly-in-c-and-glsl</a></li>
</ul>
<div class="section" id="gl-ext-gpu-shader4">
<h3>GL_EXT_gpu_shader4<a class="headerlink" href="#gl-ext-gpu-shader4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://www.opengl.org/registry/specs/EXT/gpu_shader4.txt">https://www.opengl.org/registry/specs/EXT/gpu_shader4.txt</a><ul>
<li><cite>uvec4</cite></li>
<li>bitwise operators</li>
<li>int/uint attributes</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="gl-ext-geometry-shader4">
<h3>GL_EXT_geometry_shader4<a class="headerlink" href="#gl-ext-geometry-shader4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://www.opengl.org/registry/specs/EXT/geometry_shader4.txt">https://www.opengl.org/registry/specs/EXT/geometry_shader4.txt</a></li>
<li><a class="reference external" href="http://www.opengl.org/wiki/Geometry_Shader_Examples">http://www.opengl.org/wiki/Geometry_Shader_Examples</a><ul>
<li>vertex and primitive generation in geometry stage between vertex and fragment</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="glvertexattribipointer-api-hunt">
<h3>glVertexAttribIPointer API hunt<a class="headerlink" href="#glvertexattribipointer-api-hunt" title="Permalink to this headline">¶</a></h3>
<p>Trying to get integers attributes into shader proving difficult:</p>
<div class="highlight-python"><pre>delta:OpenGL blyth$ find . -name '*.py' -exec grep -H glVertexAttribIPointer {} \;
./platform/entrypoint31.py:glVertexAttribIPointer
./raw/GL/NV/vertex_program4.py:def glVertexAttribIPointerEXT( index,size,type,stride,pointer ):pass
./raw/GL/VERSION/GL_3_0.py:def glVertexAttribIPointer( index,size,type,stride,pointer ):pass
delta:OpenGL blyth$</pre>
</div>
<ul class="simple">
<li><a class="reference external" href="http://developer.download.nvidia.com/opengl/specs/GL_NV_vertex_program4.txt">http://developer.download.nvidia.com/opengl/specs/GL_NV_vertex_program4.txt</a></li>
</ul>
<div class="highlight-python"><pre>In [15]: import OpenGL.raw.GL.VERSION.GL_3_0  as g30

In [16]: g30.glVertexAttribIPointer?
Type:       glVertexAttribIPointer
String Form:&lt;OpenGL.platform.baseplatform.glVertexAttribIPointer object at 0x10babc290&gt;
File:       /usr/local/env/chroma_env/lib/python2.7/site-packages/OpenGL/platform/baseplatform.py
Definition: g30.glVertexAttribIPointer(self, *args, **named)
Docstring:  &lt;no docstring&gt;
Call def:   g30.glVertexAttribIPointer(self, *args, **named)</pre>
</div>
</div>
<div class="section" id="gl-nv-vertex-program4">
<h3>GL_NV_vertex_program4<a class="headerlink" href="#gl-nv-vertex-program4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>trying to use this extension from glsl gives not supported</li>
<li><a class="reference external" href="http://developer.download.nvidia.com/opengl/specs/GL_NV_vertex_program4.txt">http://developer.download.nvidia.com/opengl/specs/GL_NV_vertex_program4.txt</a></li>
</ul>
<div class="highlight-python"><pre>In [11]: import OpenGL.raw.GL.NV.vertex_program4 as nv4

In [12]: nv4.glVertexAttribIPointerEXT
Out[12]: &lt;OpenGL.platform.baseplatform.glVertexAttribIPointerEXT at 0x10bb9fed0&gt;

In [13]: nv4.EXTENSION_NAME
Out[13]: 'GL_NV_vertex_program4'</pre>
</div>
</div>
</div>
<div class="section" id="fixed-pipeline-and-shaders">
<h2>Fixed Pipeline and Shaders<a class="headerlink" href="#fixed-pipeline-and-shaders" title="Permalink to this headline">¶</a></h2>
<p>When using position_name=&#8221;position&#8221; DAEVertexBuffer does
the traditional glVertexPointer setup that furnishes gl_Vertex
to the shader.</p>
<p>Legacy way prior to move to generic attributes:</p>
<div class="highlight-python"><pre>gl_Position = vec4( gl_Vertex.xyz , 1.) ;
//vMomdir = vec4( 100.,100.,100., 1.) ;</pre>
</div>
</div>
<div class="section" id="bitwise-operations-glsl">
<h2>Bitwise operations glsl<a class="headerlink" href="#bitwise-operations-glsl" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.geeks3d.com/20100831/shader-library-noise-and-pseudo-random-number-generator-in-glsl/">http://www.geeks3d.com/20100831/shader-library-noise-and-pseudo-random-number-generator-in-glsl/</a></li>
<li><a class="reference external" href="http://stackoverflow.com/questions/2182002/convert-big-endian-to-little-endian-in-c-without-using-provided-func">http://stackoverflow.com/questions/2182002/convert-big-endian-to-little-endian-in-c-without-using-provided-func</a></li>
</ul>
</div>
<div class="section" id="line-strip-finnicky">
<h2>line strip finnicky<a class="headerlink" href="#line-strip-finnicky" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre> File "/usr/local/env/chroma_env/lib/python2.7/site-packages/env/geant4/geometry/collada/g4daeview/daephotons.py", line 179, in multidraw
    self.renderer.multidraw(slot=slot, counts=self.counts, firsts=self.firsts, drawcount=self.drawcount )
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/env/geant4/geometry/collada/g4daeview/daephotonsrenderer.py", line 162, in multidraw
    self.pbuffer.multidraw(mode=gl.GL_LINE_STRIP,  what='', drawcount=qcount, slot=slot, counts=counts, firsts=firsts)
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/env/geant4/geometry/collada/g4daeview/daevertexbuffer.py", line 500, in multidraw
    gl.glMultiDrawArrays( gl.GL_LINE_STRIP, firsts, counts, drawcount )
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/OpenGL/platform/baseplatform.py", line 379, in __call__
    return self( *args, **named )
  File "errorchecker.pyx", line 50, in OpenGL_accelerate.errorchecker._ErrorChecker.glCheckError (src/errorchecker.c:854)
  OpenGL.error.GLError: GLError(
    err = 1282,
    description = 'invalid operation',
    baseOperation = glMultiDrawArrays,
    cArguments = (
        GL_LINE_STRIP,
        array([    0,    10,    20, ..., 4162...,
        array([3, 2, 2, ..., 9, 9, 9], dtype=...,
        4165,
    )
)</pre>
</div>
</div>
<div class="section" id="shaders-and-integers-dont-mix-in-version-120">
<h2>shaders and integers dont mix in version 120<a class="headerlink" href="#shaders-and-integers-dont-mix-in-version-120" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">SHADER</span><span class="p">[</span><span class="s">&#39;bit_sniffing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">r&quot;&quot;&quot;</span>

<span class="s">// making integers useful inside glsl 120 + GL_EXT_gpu_shader4 is too much effort yo be worthwhile</span>
<span class="s">//  problems</span>
<span class="s">//    #. cannot find symbol glVertexAttribIPointer</span>
<span class="s">//    #. uint type not working so cannot do proper</span>

<span class="s">    uvec4 cf ;</span>
<span class="s">    int nb = 0 ;</span>
<span class="s">    int mb = -1 ;</span>
<span class="s">    for( int n=0 ; n &lt; 32 ; ++n ){</span>
<span class="s">          cf.x = ( 1 &lt;&lt; n ) ;</span>
<span class="s">          if (( TEST &amp; cf.x ) != 0){</span>
<span class="s">                nb += 1 ;</span>
<span class="s">                mb = n ;</span>
<span class="s">          }</span>
<span class="s">    }</span>

<span class="s">    if      (mb==29) vColor = vec4( 1.0, 0.0, 0.0, 1.0);</span>
<span class="s">    else if (mb==30) vColor = vec4( 0.0, 1.0, 0.0, 1.0);</span>
<span class="s">    else if (mb==31) vColor = vec4( 0.0, 0.0, 1.0, 1.0);</span>
<span class="s">    else             vColor = vec4( 1.0, 1.0, 1.0, 1.0);</span>

<span class="s">    uvec4 b = uvec4( 0xff, 0xff00, 0xff0000,0xff000000) ;</span>
<span class="s">    uvec4 r = uvec4( TEST &gt;&gt; 24 , TEST &gt;&gt; 8, TEST &lt;&lt; 8 , TEST &lt;&lt; 24 );</span>
<span class="s">    uvec4 t ;</span>
<span class="s">    t.x = ( r.x &amp; b.x ) | ( r.z &amp; b.z ) | ( r.y &amp; b.y ) | ( r.w &amp; b.w );</span>
<span class="s">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../">Env  documentation</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>