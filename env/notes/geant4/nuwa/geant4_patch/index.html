<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Geant4 Patch &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../../" />
    <link rel="up" title="nuwa" href="../" />
    <link rel="next" title="Integration of Export Functionality into NuWa" href="../nuwa_integration/" />
    <link rel="prev" title="nuwa" href="../" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../nuwa_integration/" title="Integration of Export Functionality into NuWa"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="nuwa"
             accesskey="P">previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >geant4</a> &raquo;</li>
          <li><a href="../" accesskey="U">nuwa</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pycuda/">pycuda</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">geant4</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/">Geant4 Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geant4_gpu/">Geant4 GPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geant4_profiling/">Geant4 Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/">Geant4 Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../verbosity/">Verbosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docs/">Geant4 Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giga/">GiGa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/">Geant4 API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opticalphoton/">Geant4 Optical Photon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../processes/">Geant4 Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../medical/">Medical Communities Using Geant4 (esp. optical photon)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/">Geant4 Geometry Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../g4py/">g4py</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">nuwa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../event/">Geant4 Event</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geant4_future_doe/">Geant4</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../chroma/">chroma</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../javascript/">javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nuwa/">nuwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hg/">hg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../simoncblyth.bitbucket.org/">simoncblyth.bitbucket.org</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/geant4/nuwa/geant4_patch.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../"
                        title="previous chapter">nuwa</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../nuwa_integration/"
                        title="next chapter">Integration of Export Functionality into NuWa</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="geant4-patch">
<h1>Geant4 Patch<a class="headerlink" href="#geant4-patch" title="Permalink to this headline">¶</a></h1>
<div class="section" id="need-for-patching">
<h2>Need for patching<a class="headerlink" href="#need-for-patching" title="Permalink to this headline">¶</a></h2>
<p>To get newer GDML with material and surface properties to work
with old geant4 requires</p>
<ul class="simple">
<li>expose G4MaterialPropertiesTable maps</li>
<li>API adjustments to bring new geant4 API for G4MaterialPropertyVector (which typedefs G4PhysicsOrderedFreeVector)
to older geant4 G4MaterialPropertyVector</li>
</ul>
<div class="section" id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h3>
<p>Compared new geant4 GDML with the version used with NuWa</p>
<ul class="simple">
<li>/usr/local/env/geant4/geant4.10.00.b01/source/persistency/gdml/include</li>
</ul>
<div class="highlight-python"><pre>src/G4DAEWriteMaterials.cc:144: error: cannot convert
'const std::map&lt;G4String, G4MaterialPropertyVector*, std::less&lt;G4String&gt;, std::allocator&lt;std::pair&lt;const G4String, G4MaterialPropertyVector*&gt; &gt; &gt;*' to
'const std::map&lt;G4String, G4PhysicsOrderedFreeVector*, std::less&lt;G4String&gt;, std::allocator&lt;std::pair&lt;const G4String, G4PhysicsOrderedFreeVector*&gt; &gt; &gt;*' in initialization</pre>
</div>
<p>Future geant4 gets rid of the deficient G4MaterialPropertyVector typedefing from G4PhysicsOrderedFreeVector.
/usr/local/env/geant4/geant4.10.00.b01/source/materials/include/G4MaterialPropertyVector.hh:</p>
<div class="highlight-python"><pre>56 #include "G4PhysicsOrderedFreeVector.hh"
..
62 typedef G4PhysicsOrderedFreeVector G4MaterialPropertyVector;</pre>
</div>
</div>
</div>
<div class="section" id="lcg-geant4-patch-machinery-within-nuwa">
<h2>LCG Geant4 patch machinery within NuWa<a class="headerlink" href="#lcg-geant4-patch-machinery-within-nuwa" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>NuWa-trunk/lcgcmt/LCG_Builders/geant4/scripts/geant4_config.sh</li>
</ul>
<div class="highlight-python"><pre>[blyth@belle7 scripts]$ cat geant4_config.sh
#!/bin/sh

. ${LCG_BUILDPOLICYROOT_DIR}/scripts/common.sh
untar

goto ${LCG_srcdir}
apply_patch geant4.9.2.p01.patch 1
apply_patch geant4.9.2.p01.patch2 1</pre>
</div>
<p><cite>LCG_srcdir</cite>:</p>
<div class="highlight-python"><pre>[blyth@belle7 geant4.9.2.p01]$ ll
total 324
-rw-r--r--  1 blyth blyth   4029 Mar 16  2009 LICENSE
-rwxr-xr-x  1 blyth blyth 142639 Mar 16  2009 Configure
drwxr-xr-x  2 blyth blyth   4096 Mar 16  2009 ReleaseNotes
drwxr-xr-x  5 blyth blyth   4096 Mar 16  2009 examples
drwxr-xr-x  4 blyth blyth   4096 Mar 16  2009 environments
drwxr-xr-x  4 blyth blyth   4096 Mar 16  2009 config
-rw-rw-r--  1 blyth blyth      0 Mar  3 16:43 .geant4.9.2.p01.patch2
-rw-rw-r--  1 blyth blyth      0 Mar  3 16:43 .geant4.9.2.p01.patch
drwxrwxr-x  3 blyth blyth   4096 Mar  3 16:43 lib
drwxrwxr-x  2 blyth blyth   4096 Mar  3 16:43 bin
drwxr-xr-x 11 blyth blyth   4096 Mar  3 16:43 .
drwxrwxr-x  3 blyth blyth   4096 Mar  3 16:43 tmp
drwxrwxr-x  2 blyth blyth 135168 Mar  3 17:15 include
drwxr-xr-x 22 blyth blyth   4096 Mar  4 17:39 source
drwxrwxr-x 30 blyth blyth   4096 Mar  4 18:03 ..
[blyth@belle7 geant4.9.2.p01]$ pwd
/data1/env/local/dyb/external/build/LCG/geant4.9.2.p01

[blyth@belle7 geant4.9.2.p01]$ find . -name '*.orig' -exec ls -l {} \;
-rw-r--r-- 1 blyth blyth 10395 Mar 16  2009 ./include/G4OpBoundaryProcess.hh.orig
-rw-r--r-- 1 blyth blyth 10395 Mar 16  2009 ./source/processes/optical/include/G4OpBoundaryProcess.hh.orig
[blyth@belle7 geant4.9.2.p01]$</pre>
</div>
<p>Suspect that <cite>G4OpBoundaryProcess.hh.orig</cite> suggests suspect patch application.</p>
</div>
<div class="section" id="lcg-apply-patch">
<h2>LCG apply_patch<a class="headerlink" href="#lcg-apply-patch" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>/data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/LCG_BuildPolicy/scripts/common.sh</li>
</ul>
<div class="highlight-python"><pre>108 # Apply given patch with optional strip level (default is 0).  If the
109 # patchfile is not found it is looked for as a path relative to
110 # Package/patches/ assuming the running script is in Package/scripts/.
111 apply_patch () {
112     file=$1 ;
113     if [ -n "$1" ] ; then shift; fi
114     level=${1-"0"}
115     if [ -n "$1" ] ; then shift; fi
116
117     if [ ! -f "$file" ] ; then
118     file=$(dirname $(dirname $0))/patches/$file
119     fi
120     if [ ! -f "$file" ] ; then
121     fatal "failed to find patch file $file"
122     fi
123
124     been_here=".$(basename $file)"
125     if [ -f "$been_here" ] ; then
126     info "Already applied patch \"$file\""
127     return
128     fi
129
130     # need quotes since using redirection
131     cmd "patch -N -p$level -i $file"
132     touch $been_here
133 }</pre>
</div>
<div class="section" id="man-patch">
<h3>man patch<a class="headerlink" href="#man-patch" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>-R</cite> looks dangerous</li>
</ul>
<dl class="docutils">
<dt><cite>-N</cite> or <cite>&#8211;forward</cite></dt>
<dd>Ignore patches that seem to be reversed or already applied.  See also -R.</dd>
<dt><cite>-R</cite> or <cite>&#8211;reverse</cite></dt>
<dd><p class="first">Assume that this patch was created with the old and new files
swapped.  (Yes, I&#8217;m afraid that does happen occasionally, human nature being
what it is.)  patch attempts to swap each hunk around before applying  it.
Rejects  come out in the swapped format.  The -R option does not work with ed
diff scripts because there is too little information to reconstruct the reverse
operation.</p>
<p class="last">If  the first hunk of a patch fails, patch reverses the hunk to see
if it can be applied that way.  If it can, you are asked if you want to have
the -R option set.  If it can&#8217;t, the patch continues to be applied normally.
(Note: this method cannot detect a reversed patch if it is a normal diff and if
the first command is an append (i.e. it should have been a delete) since
appends always succeed, due to the fact  that  a  null  context  matches
anywhere.  Luckily, most patches add or change lines rather than delete them,
so most reversed normal diffs begin with a delete, which fails, triggering the
heuristic.)</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="material-property-introspection-patch">
<h2>Material Property Introspection patch<a class="headerlink" href="#material-property-introspection-patch" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>[blyth@belle7 include]$ pwd
/data1/env/local/dyb/external/build/LCG/geant4.9.2.p01/source/materials/include

[blyth@belle7 include]$ diff G4MaterialPropertiesTable.hh.orig G4MaterialPropertiesTable.hh
136a137,149
&gt;
&gt;   // copied from Geant4 future
&gt;   public:  // without description
&gt;
&gt;     const std::map&lt; G4String, G4MaterialPropertyVector*, std::less&lt;G4String&gt; &gt;*
&gt;     GetPropertiesMap() const { return &amp;MPT; }
&gt;     const std::map&lt; G4String, G4double, std::less&lt;G4String&gt; &gt;*
&gt;     GetPropertiesCMap() const { return &amp;MPTC; }
&gt;     // Accessors required for persistency purposes
&gt;</pre>
</div>
</div>
<div class="section" id="usage-in-future-geant4-10-gdml-persisting">
<h2>Usage in future geant4.10 GDML persisting<a class="headerlink" href="#usage-in-future-geant4-10-gdml-persisting" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>g4pb:src blyth$ grep GetPropertiesMap *.cc
G4GDMLWriteMaterials.cc:                 std::less&lt;G4String&gt; &gt;* pmap = ptable-&gt;GetPropertiesMap();
g4pb:src blyth$ pwd
/usr/local/env/geant4/geant4.10.00.b01/source/persistency/gdml/src</pre>
</div>
</div>
<div class="section" id="backport-gdml-property-writing">
<h2>Backport GDML Property writing<a class="headerlink" href="#backport-gdml-property-writing" title="Permalink to this headline">¶</a></h2>
<p>Not so simple due to geant4 change from use of G4MaterialPropertyVector to G4PhysicsOrderedFreeVector,
so as stuck with older geant4 need to workaround limitations of the old G4MaterialPropertyVector.</p>
<p>What planet are the authors of G4MaterialPropertyVector from, no API to access NumEntries ?
Its simpler to patch than to kludge iterate to count entries, plus patch to match
Geant4 future API.</p>
<div class="section" id="compare-g4materialpropertyvector-with-g4physicsvector">
<h3>2014/02/19 compare G4MaterialPropertyVector with G4PhysicsVector<a class="headerlink" href="#compare-g4materialpropertyvector-with-g4physicsvector" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>[blyth@cms01 geant4.9.2.p01]$ cd source/
[blyth@cms01 source]$ find . -name 'G4MaterialPropertyVector.cc'
./materials/src/G4MaterialPropertyVector.cc
[blyth@cms01 source]$ find . -name 'G4MaterialPropertyVector.hh'
./materials/include/G4MaterialPropertyVector.hh

[blyth@cms01 source]$ find . -name 'G4PhysicsFreeVector.cc'
./global/management/src/G4PhysicsFreeVector.cc
[blyth@cms01 source]$ find . -name 'G4PhysicsFreeVector.hh'
./global/management/include/G4PhysicsFreeVector.hh

[blyth@cms01 source]$ find . -name 'G4PhysicsOrderedFreeVector.hh'
./global/management/include/G4PhysicsOrderedFreeVector.hh
[blyth@cms01 source]$
[blyth@cms01 source]$ find . -name 'G4PhysicsOrderedFreeVector.cc'
./global/management/src/G4PhysicsOrderedFreeVector.cc
[blyth@cms01 source]$</pre>
</div>
</div>
<div class="section" id="backport-g4physicsvector-api-to-patch-g4materialpropertyvector">
<h3>2014/02/19 Backport G4PhysicsVector API to patch G4MaterialPropertyVector<a class="headerlink" href="#backport-g4physicsvector-api-to-patch-g4materialpropertyvector" title="Permalink to this headline">¶</a></h3>
<p>All this to get MPV to spill the beans:</p>
<div class="highlight-python"><pre>[blyth@cms01 source]$ vi materials/src/G4MaterialPropertyVector.cc  materials/include/G4MaterialPropertyVector.hh


public: // SCB getting MPV to spill the beans

   size_t GetVectorLength() const ;
   G4double Energy(const size_t binNumber) const ;
   G4double operator[](const size_t binNumber) const;



// SCB getting MPV to spill the beans

size_t G4MaterialPropertyVector::GetVectorLength() const
{
    return NumEntries ;
}

G4double G4MaterialPropertyVector::Energy(const size_t binNumber) const
{
    G4MPVEntry* mpv = MPV[binNumber] ;
    return mpv-&gt;GetPhotonEnergy();
}

G4double G4MaterialPropertyVector::operator[](const size_t binNumber) const
{
    G4MPVEntry* mpv = MPV[binNumber] ;
    return mpv-&gt;GetProperty();
}</pre>
</div>
<div class="highlight-python"><pre>[blyth@belle7 source]$ cp materials/src/G4MaterialPropertyVector.cc  materials/src/G4MaterialPropertyVector.cc.orig
[blyth@belle7 source]$ cp materials/include/G4MaterialPropertyVector.hh materials/include/G4MaterialPropertyVector.hh.orig
[blyth@belle7 source]$ vi materials/src/G4MaterialPropertyVector.cc  materials/include/G4MaterialPropertyVector.hh
[blyth@belle7 source]$ g4-
[blyth@belle7 source]$ g4-libs-rebuild      ## tedious full rebuild of all g4 libs, cmake is in geant4 future so no motivation to improve this back here
...
[blyth@belle7 source]$ g4-includes-rebuild  ## also needed, to use the added APIs
...</pre>
</div>
</div>
<div class="section" id="incomplete-rebuild">
<h3>2014/02/19 Incomplete Rebuild<a class="headerlink" href="#incomplete-rebuild" title="Permalink to this headline">¶</a></h3>
<p>Runtime fail:</p>
<div class="highlight-python"><pre>788 G4DAE: Writing library_materials...
789 G4DAE: Writing structure/library_nodes...
790 G4DAE: Writing library_visual_scenes...
791 python: symbol lookup error: /data1/env/local/dyb/NuWa-trunk/../external/geant4/4.9.2.p01/i686-slc5-gcc41-dbg/lib/libG4DAE.so: undefined symbol: _ZNK24G4MaterialPropertyVector15GetVectorLengthEv</pre>
</div>
<p>Hmm missing the install step, as libs in /data1/env/local/dyb/external/geant4/4.9.2.p01/i686-slc5-gcc41-dbg/lib are old</p>
<p>Add in <cite>g4-install-rebuild</cite> to do that after the below investigations of the dybinst geant4 build mechanism.</p>
<p>But subsequently another runtime fail from missing libG4gdml.so:</p>
<div class="highlight-python"><pre>48 DetectorDataSvc                    SUCCESS Detector description database: /data1/env/local/dyb/NuWa-trunk/dybgaudi/Detector/XmlDetDesc/DDDB/dayabay.xml
49 EventClockSvc.FakeEventTime           INFO Event times generated from 0 with steps of 0
50 Generator                             INFO Added gen tool GtTransformTool/onemuonTransformer
51 AlgorithmManager                     ERROR Algorithm of type GiGaInputStream is unknown (No factory available).
52 AlgorithmManager                     ERROR libG4gdml.so: cannot open shared object file: No such file or directory
53 AlgorithmManager                     ERROR More information may be available by setting the global jobOpt "ReflexPluginDebugLevel" to 1
54 GaudiSequencer                     WARNING Unable to find or create GiGaInputStream
55 AlgorithmManager                     ERROR Algorithm of type DsPushKine is unknown (No factory available).
56 AlgorithmManager                     ERROR libG4gdml.so: cannot open shared object file: No such file or directory
57 AlgorithmManager                     ERROR More information may be available by setting the global jobOpt "ReflexPluginDebugLevel" to 1
58 GaudiSequencer                     WARNING Unable to find or create DsPushKine
59 AlgorithmManager                     ERROR Algorithm of type DsPullEvent is unknown (No factory available).
60 AlgorithmManager                     ERROR libG4gdml.so: cannot open shared object file: No such file or directory
61 AlgorithmManager                     ERROR More information may be available by setting the global jobOpt "ReflexPluginDebugLevel" to 1
62 GaudiSequencer                     WARNING Unable to find or create DsPullEvent
63 GaudiSequencer                        INFO Member list:</pre>
</div>
<p>Compare libs:</p>
<div class="highlight-python"><pre>[blyth@belle7 4.9.2.p01]$ ( cd i686-slc5-gcc41-dbg/lib/ ; ls -1 *.so ) &gt; new.so
[blyth@belle7 4.9.2.p01]$ ( cd i686-slc5-gcc41-dbg.prior/lib/ ; ls -1 *.so ) &gt; old.so
[blyth@belle7 4.9.2.p01]$ diff old.so new.so
6a7
&gt; libG4DAEFILE.so
22d22
&lt; libG4gdml.so
[blyth@belle7 4.9.2.p01]$</pre>
</div>
<p>Get dirty:</p>
<div class="highlight-python"><pre>[blyth@belle7 4.9.2.p01]$ cp i686-slc5-gcc41-dbg.prior/lib/libG4gdml.so i686-slc5-gcc41-dbg/lib/
[blyth@belle7 4.9.2.p01]$</pre>
</div>
<p>This succeeds to write properties to the DAE, need some veracity checking:</p>
<div class="highlight-python"><pre>70373     &lt;material id="__dd__Materials__Acrylic0xa7b6b48"&gt;
70374       &lt;instance_effect url="#__dd__Materials__Acrylic_fx_0xa7b6b48"/&gt;
70375       &lt;extra&gt;
70376         &lt;matrix coldim="2" name="ABSLENGTH0xa7b4d78" values="1.55e-06 8000 1.61e-06 8000 2.07e-06 8000 2.48e-06 8000 3.76e-06 8000 4.13e-06 8000 6.2e-06 0.008 1.033e-05 0.008 1.55e-05 0.008"/&gt;
70377         &lt;property name="ABSLENGTH" ref="ABSLENGTH0xa7b4d78"/&gt;
70378         &lt;matrix coldim="2" name="RAYLEIGH0xa7b4da8" values="1.55e-06 500000 1.7714e-06 300000 2.102e-06 170000 2.255e-06 100000 2.531e-06 62000 2.884e-06 42000 3.024e-06 30000 4.133e-06 7600 6.2e-06 850        1.033e-05 850 1.55e-05 850"/&gt;
70379         &lt;property name="RAYLEIGH" ref="RAYLEIGH0xa7b4da8"/&gt;
70380         &lt;matrix coldim="2" name="RINDEX0xa504f20" values="1.55e-06 1.4878 1.79505e-06 1.4895 2.10499e-06 1.4925 2.27077e-06 1.4946 2.55111e-06 1.4986 2.84498e-06 1.5022 3.06361e-06 1.5065 4.13281e-06 1.       5358 6.2e-06 1.6279 6.526e-06 1.627 6.889e-06 1.5359 7.294e-06 1.5635 7.75e-06 1.793 8.267e-06 1.7199 8.857e-06"/&gt;
70381         &lt;property name="RINDEX" ref="RINDEX0xa504f20"/&gt;
70382       &lt;/extra&gt;
70383     &lt;/material&gt;</pre>
</div>
<p>Possible truncation:</p>
<div class="highlight-python"><pre>70497     &lt;material id="__dd__Materials__ESR0xa56f4b0"&gt;
70498       &lt;instance_effect url="#__dd__Materials__ESR_fx_0xa56f4b0"/&gt;
70499       &lt;extra&gt;
70500         &lt;matrix coldim="2" name="ABSLENGTH0xa8080f8" values="1.55e-06 0.001 1.63e-06 0.001 1.68e-06 0.001 1.72e-06 0.001 1.77e-06 0.001 1.82e-06 0.001 1.88e-06 0.001 1.94e-06 0.001 2e-06 0.001 2.07e-06        0.001 2.14e-06 0.001 2.21e-06 0.001 2.3e-06 0.001 2.38e-06 0.001 2.48e-06 0.001 2.58e-06 0.001 2.7e-06 0.001 2.82e"/&gt;
70501         &lt;property name="ABSLENGTH" ref="ABSLENGTH0xa8080f8"/&gt;
70502       &lt;/extra&gt;
70503     &lt;/material&gt;</pre>
</div>
<p>Story continues <a class="reference internal" href="../../geometry/materials/material_properties/"><em>Material Properties</em></a></p>
</div>
</div>
<div class="section" id="geant4-dybinst-rebuild">
<h2>2014/02/18 Geant4 Dybinst Rebuild<a class="headerlink" href="#geant4-dybinst-rebuild" title="Permalink to this headline">¶</a></h2>
<p>Simple rebuild is too quick, doing nothing:</p>
<div class="highlight-python"><pre>[blyth@belle7 dyb]$ ./dybinst trunk external geant4


Tue Feb 18 10:43:06 CST 2014
Start Logging to /data1/env/local/dyb/dybinst-20140218-104306.log (or dybinst-recent.log)


Starting dybinst commands: external

Stage: "external"...

Found CMTCONFIG="i686-slc5-gcc41-dbg" from lcgcmt
Checking your CMTCONFIG="i686-slc5-gcc41-dbg"...
...ok.

dybinst-external: installing packages: geant4

Installing external packages, this will take a while.  Go get coffee...
  Installing geant4 ... done with geant4
[blyth@belle7 dyb]$</pre>
</div>
<p>Examining <cite>dybinst-external</cite> <cite>dybinst-common.sh</cite> note that geant4 is built
with standard LCG Builders kicked off with <cite>pkg_build geant4</cite> which is defined
in <cite>common.sh</cite></p>
<div class="highlight-python"><pre>291 # to build using LCG_Builders
292 pkg_build () {
293
294     pkg=$1 ; shift
295     goto $SITEROOT/lcgcmt/LCG_Builders/$pkg/cmt
296     cmt config
297     source setup.sh
298
299     #cmt_macro LCG_BuildPolicy LCG_tardir LCG_Builders
300     #cmt_macro LCG_BuildPolicy LCG_builddir LCG_Builders
301
302     echo "LCG_tardir=\"$LCG_tardir\""
303     if [ ! -d ${LCG_tardir} ] ; then
304     mkdir -p ${LCG_tardir}
305     fi
306     echo "LCG_builddir=\"$LCG_builddir\""
307     if [ ! -d ${LCG_builddir} ] ; then
308     mkdir -p ${LCG_builddir}
309     fi
310
311     cmt config
312     if [ -r setup.sh ] ; then
313     source setup.sh
314     else
315     echo "Failed to setup $gluedir"
316     exit 1
317     fi
318
319     #echo "## begin env dump ##"
320     #env
321     #echo "## end env dump ##"
322     #echo "## begin cmt dump ##"
323     #cmt show tags
324     #cmt show macros
325     #echo "## end cmt dump ##"
326     #cmt show macro LCG_basesystem
327
328     for cmd in get config make install
329     do
330     echo "$pkg: running \"cmt pkg_$cmd\""
331     cmt pkg_$cmd
332     check_cmd
333     done
334
335     goback
336 }</pre>
</div>
<p>The cmt pkg_install invokes:</p>
<div class="highlight-python"><pre>[blyth@belle7 lib]$ cat /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/scripts/geant4_install.sh
#!/bin/sh

# . ${LCG_BUILDPOLICYROOT_DIR}/scripts/common.sh

echo "geant4: installing code"
cd ${G4INSTALL}
mkdir -p ${LCG_destdir}
for dir in lib include
do
    target="${LCG_destdir}/$dir"
    if [ -d "$target" ] ; then
        echo "geant4: $target already exists, remove to force reinstall"
    else
        tar -cf - $dir | (cd ${LCG_destdir} &amp;&amp; tar -xf -)
    fi
done
cd ${LCG_destdir}/lib

# curious move contents of Linux-g++ one up and remove Linux-g++
if [ -d "${G4SYSTEM}" ] ; then
    mv ${G4SYSTEM}/* .
    rmdir ${G4SYSTEM}
fi

... then data downloading</pre>
</div>
<p>Installation checks for <cite>G4INSTALL/lib</cite> and <cite>G4INSTALL/include</cite>:</p>
<div class="highlight-python"><pre>[blyth@belle7 lib]$ echo $G4INSTALL
/data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01
[blyth@belle7 lib]$
[blyth@belle7 lib]$ ll  $G4INSTALL/
total 324
-rw-r--r--  1 blyth blyth   4029 Mar 16  2009 LICENSE
-rwxr-xr-x  1 blyth blyth 142639 Mar 16  2009 Configure
drwxr-xr-x  2 blyth blyth   4096 Mar 16  2009 ReleaseNotes
drwxr-xr-x  4 blyth blyth   4096 Mar 16  2009 environments
-rw-rw-r--  1 blyth blyth      0 Feb 16  2011 .geant4.9.2.p01.patch2
-rw-rw-r--  1 blyth blyth      0 Feb 16  2011 .geant4.9.2.p01.patch
drwxrwxr-x  3 blyth blyth   4096 Feb 16  2011 lib
drwxrwxr-x 34 blyth blyth   4096 Sep 18 18:32 ..
-rw-rw-r--  1 blyth blyth      0 Sep 18 18:44 .geant4.9.2.p01.patch3
drwxr-xr-x 11 blyth blyth   4096 Sep 18 19:17 .
drwxr-xr-x 22 blyth blyth   4096 Sep 18 19:21 source
drwxr-xr-x  5 blyth blyth   4096 Oct  1 19:40 examples
drwxrwxr-x  3 blyth blyth   4096 Oct  1 20:06 bin
drwxrwxr-x  6 blyth blyth   4096 Oct  2 20:13 tmp
drwxr-xr-x  4 blyth blyth   4096 Dec  4 15:13 config
drwxrwxr-x  2 blyth blyth 135168 Feb 19 14:01 include
[blyth@belle7 lib]$</pre>
</div>
<p>And propagates from there to <cite>LCG_destdir</cite>:</p>
<div class="highlight-python"><pre>[blyth@belle7 lib]$ echo ${LCG_destdir}
/data1/env/local/dyb/NuWa-trunk/../external/geant4/4.9.2.p01/i686-slc5-gcc41-dbg
[blyth@belle7 lib]$ ll  ${LCG_destdir}/
total 196
drwxrwxr-x 3 blyth blyth   4096 Feb 16  2011 ..
drwxrwxr-x 2 blyth blyth   4096 Feb 16  2011 lib.prior
drwxrwxr-x 5 blyth blyth   4096 Sep 18 19:55 .
drwxrwxr-x 2 blyth blyth 180224 Nov 14 18:36 include
drwxrwxr-x 2 blyth blyth   4096 Feb 19 14:34 lib</pre>
</div>
<p>As this is kinda expensive do this manually:</p>
<div class="highlight-python"><pre>[blyth@belle7 4.9.2.p01]$ pwd
/data1/env/local/dyb/external/geant4/4.9.2.p01
[blyth@belle7 4.9.2.p01]$ mv i686-slc5-gcc41-dbg i686-slc5-gcc41-dbg.prior</pre>
</div>
<p>From the log:</p>
<div class="highlight-python"><pre>[blyth@belle7 dyb]$ grep ^geant4: /data1/env/local/dyb/dybinst-20140218-104306.log
geant4: running "cmt pkg_get"
geant4: running "cmt pkg_config"
geant4: "using file from LCG_tarfilename="geant4.9.2.p01.tar.gz""
geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG"
geant4: "source directory exists, to re-untar remove "/data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01""
geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/cmt"
geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01"
geant4: "Already applied patch "/data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/patches/geant4.9.2.p01.patch""
geant4: "Already applied patch "/data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/patches/geant4.9.2.p01.patch2""
geant4: "Already applied patch "/data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/patches/geant4.9.2.p01.patch3""
geant4: running "cmt pkg_make"
geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source"
geant4: running "cmt pkg_install"
geant4: installing code
geant4: /data1/env/local/dyb/NuWa-trunk/../external/geant4/4.9.2.p01/i686-slc5-gcc41-dbg/lib already exists, remove to force reinstall
geant4: /data1/env/local/dyb/NuWa-trunk/../external/geant4/4.9.2.p01/i686-slc5-gcc41-dbg/include already exists, remove to force reinstall
geant4: installing data
[blyth@belle7 dyb]$</pre>
</div>
<p>The make step:</p>
<div class="highlight-python"><pre>[blyth@belle7 dyb]$ cat /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/scripts/geant4_make.sh
#!/bin/sh

. ${LCG_BUILDPOLICYROOT_DIR}/scripts/common.sh

CPPVERBOSE=1
export CPPVERBOSE

# Geant4's make is a bit more than just "make" so spell it out

goto $LCG_srcdir/source
if [ ! -f ${G4INSTALL}/lib/$G4SYSTEM/libG4run.so ] ; then
    cmd make
fi
if [ ! -f ${G4INSTALL}/lib/$G4SYSTEM/libname.map ] ; then
    cmd make libmap
fi
if [ ! -f ${G4INSTALL}/include/G4Version.hh ] ; then
    cmd make includes
fi</pre>
</div>
<p>Jump in and build:</p>
<div class="highlight-python"><pre>fenv  # pick up basis env
cd /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/cmt
cmt config
. setup.sh</pre>
</div>
<p>Detects libG4run.so and does nothing:</p>
<div class="highlight-python"><pre>[blyth@belle7 cmt]$ cmt pkg_make
Execute action pkg_make =&gt; sh -x /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/scripts/geant4_make.sh
+ . /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/LCG_BuildPolicy/scripts/common.sh
+ CPPVERBOSE=1
+ export CPPVERBOSE
+ goto /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ dir=/data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ '[' -n /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source ']'
+ shift
+ cmd cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ info 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ '[' -n 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source' ']'
+ msg='running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ shift
+ echo 'geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source"'
geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source"
+ cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ check 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ err=0
+ msg='running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ '[' -n 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source' ']'
+ shift
+ '[' 0 '!=' 0 ']'
+ '[' '!' -f /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4run.so ']'
+ '[' '!' -f /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libname.map ']'
+ '[' '!' -f /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/include/G4Version.hh ']'
[blyth@belle7 cmt]$
[blyth@belle7 cmt]$
[blyth@belle7 cmt]$  l /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4run.so
-rwxrwxr-x 1 blyth blyth 3558478 Sep 18 19:27 /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4run.so
[blyth@belle7 cmt]$</pre>
</div>
<p>Removing the libG4run.so coaxes the build into action, a full build it seems:</p>
<div class="highlight-python"><pre>[blyth@belle7 cmt]$ mv /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4run.so /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4run.so.rebuild
[blyth@belle7 cmt]$ cmt pkg_make
Execute action pkg_make =&gt; sh -x /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/geant4/scripts/geant4_make.sh
+ . /data1/env/local/dyb/NuWa-trunk/lcgcmt/LCG_Builders/LCG_BuildPolicy/scripts/common.sh
+ CPPVERBOSE=1
+ export CPPVERBOSE
+ goto /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ dir=/data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ '[' -n /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source ']'
+ shift
+ cmd cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ info 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ '[' -n 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source' ']'
+ msg='running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ shift
+ echo 'geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source"'
geant4: "running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source"
+ cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source
+ check 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ err=0
+ msg='running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source'
+ '[' -n 'running command: cd /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/source' ']'
+ shift
+ '[' 0 '!=' 0 ']'
+ '[' '!' -f /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4run.so ']'
+ cmd make
+ info 'running command: make'
+ '[' -n 'running command: make' ']'
+ msg='running command: make'
+ shift
+ echo 'geant4: "running command: make"'
geant4: "running command: make"
+ make
*************************************************************
 Installation Geant4 version : geant4-09-02-patch-01
 Copyright (C) 1994-2009 Geant4 Collaboration
*************************************************************
Creating shared library /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4globman.so ...
Creating shared library /data1/env/local/dyb/NuWa-trunk/../external/build/LCG/geant4.9.2.p01/lib/Linux-g++/libG4hepnumerics.so ...
make[1]: Nothing to be done for `lib'.
make[1]: Nothing to be done for `lib'.
Making dependency for file src/G4SandiaTable.cc ...
Making dependency for file src/G4NistMessenger.cc ...
Making dependency for file src/G4NistMaterialBuilder.cc ...
Making dependency for file src/G4NistManager.cc ...
Making dependency for file src/G4MaterialPropertiesTable.cc ...
...</pre>
</div>
<p>Record the rebuild method in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">g4</span><span class="o">-</span><span class="n">libs</span><span class="o">-</span><span class="n">rebuild</span>
<span class="n">g4</span><span class="o">-</span><span class="n">includes</span><span class="o">-</span><span class="n">rebuild</span>
</pre></div>
</div>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../nuwa_integration/" title="Integration of Export Functionality into NuWa"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="nuwa"
             >previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >geant4</a> &raquo;</li>
          <li><a href="../" >nuwa</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>