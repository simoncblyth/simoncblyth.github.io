<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>simple detector example &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../../" />
    <link rel="up" title="tests" href="../" />
    <link rel="next" title="uncertainties" href="../chroma_uncertainties/" />
    <link rel="prev" title="cube example" href="../chroma_cube/" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../chroma_uncertainties/" title="uncertainties"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../chroma_cube/" title="cube example"
             accesskey="P">previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >chroma</a> &raquo;</li>
          <li><a href="../" accesskey="U">tests</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pycuda/">pycuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../geant4/">geant4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">chroma</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../G4DAEChroma/">G4DAEChroma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_issues/">Chroma Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_intersection/">Chroma Intersection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma/">CHROMA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how_chroma_works/">How Chroma Works ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/">Chroma Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../refs/">Chroma Refs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_prerequisites/">Chroma Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_geant4_integration/">Chroma Geant4 Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_nuwa_geant4_integration/">Chroma/NuWa/Geant4 Integration with ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_nuwa_integration/">Chroma NuWa Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_cuda_photon/">Chroma CUDA Photon handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_collada/">Chroma COLLADA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_pycuda/">Getting to know how Chroma uses PyCUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_pyublas/">Chroma Use of PyUblas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_geometry/">Chroma Geometry Source Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_materials/">Chroma Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_propagate/">Photon Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_physics/">Chroma Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_detector/">Chroma Modeling of Sensitive Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_server/">Chroma Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_zeromq/">Chroma ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_camera/">chroma_camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_sim/">chroma_sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_cuda_freeze/">Chroma CUDA Freeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_cuda/">Chroma CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_visualisation/">Chroma Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../photon_mapping/">Photon Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geant4_background/">Geant4 Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cuda_background/">Cuda Threads and Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bvh_background/">Bounding Volume Hierarchy (BVH)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_install/">install issues</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ChromaZMQRootTest/">ChromaZMQRootTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_curand/">Chroma Use Of CURand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_reemission/">Chroma Reemission</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../javascript/">javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nuwa/">nuwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hg/">hg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../simoncblyth.bitbucket.org/">simoncblyth.bitbucket.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../numpy/">numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../presentation/">Muon Simulation Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optix/">optix</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/chroma/chroma_tests/chroma_simple_detector.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../chroma_cube/"
                        title="previous chapter">cube example</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../chroma_uncertainties/"
                        title="next chapter">uncertainties</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="simple-detector-example">
<h1>simple detector example<a class="headerlink" href="#simple-detector-example" title="Permalink to this headline">¶</a></h1>
<div class="section" id="runtime-mavericks-root-python-issue-with-root-5-34-11-avoided">
<h2>Runtime Mavericks ROOT/python issue with root-5.34.11 AVOIDED<a class="headerlink" href="#runtime-mavericks-root-python-issue-with-root-5-34-11-avoided" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>(chroma_env)delta:test blyth$ python -i
Python 2.7.6 (default, Nov 18 2013, 15:12:51)
[GCC 4.2.1 Compatible Apple LLVM 5.0 (clang-500.2.79)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; from chroma.io.root import RootWriter
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/usr/local/env/chroma_env/src/chroma/chroma/io/root.py", line 6, in &lt;module&gt;
    from chroma.rootimport import ROOT
  File "/usr/local/env/chroma_env/src/chroma/chroma/rootimport.py", line 6, in &lt;module&gt;
    import ROOT
  File "/usr/local/env/chroma_env/src/root-v5.34.11/lib/ROOT.py", line 257, in &lt;module&gt;
    _root.gPad         = _ExpandMacroFunction( "TVirtualPad",  "Pad" )
  File "/usr/local/env/chroma_env/src/root-v5.34.11/lib/ROOT.py", line 237, in __init__
    c = _root.MakeRootClass( klass )
AttributeError: type object 'string' has no attribute 'c_str'
&gt;&gt;&gt;</pre>
</div>
<ul class="simple">
<li><a class="reference external" href="http://root.cern.ch/phpBB3/viewtopic.php?f=14&amp;t=17238">http://root.cern.ch/phpBB3/viewtopic.php?f=14&amp;t=17238</a><ul>
<li>suggests this issue fixed after root-5.34.11</li>
</ul>
</li>
<li>Moving to 5.34.14 avoids this issue, but get a freetype build issue, using
internal freetype in configure <cite>chroma-kludge-root</cite> avoids that. Fix
is expected in as yet unreleased 5.34.15</li>
</ul>
</div>
<div class="section" id="runtime-hang-probably-zmq-invalid">
<h2>Runtime hang, probably zmq ? INVALID<a class="headerlink" href="#runtime-hang-probably-zmq-invalid" title="Permalink to this headline">¶</a></h2>
<p>Nope, this was just waiting around to close a hidden mathplotlib window.
How zmq being used is still a bit mysterious.</p>
<p>Initially suspected issue with zmq, starts 5 processes which dont take CPU
and seems to hang.:</p>
<div class="highlight-python"><pre>blyth           39070   0.0  0.8  2778456 136152 s010  S+    2:06PM   0:02.19 python ./simple_detector.py
blyth           39069   0.0  1.0  2798476 159416 s010  S+    2:06PM   0:02.01 python ./simple_detector.py
blyth           39068   0.0  0.9  2796412 143680 s010  S+    2:06PM   0:01.73 python ./simple_detector.py
blyth           39067   0.0  1.0  2804252 159648 s010  S+    2:06PM   0:01.96 python ./simple_detector.py
blyth           39063   0.0  2.8 32545740 468452 s010  S+    2:06PM   0:05.30 python ./simple_detector.py</pre>
</div>
<p>After 10 mins of seemingly hanging interrupted and then killed by closing tab:</p>
<div class="highlight-python"><pre>(chroma_env)delta:test blyth$ ./simple_detector.py
Info in &lt;TUnixSystem::ACLiC&gt;: creating shared library /Users/blyth/.chroma/root_C.so

RooFit v3.59 -- Developed by Wouter Verkerke and David Kirkby
                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University
                All rights reserved, please read http://roofit.sourceforge.net/license.txt


^CProcess G4GeneratorProcess-2:
Process G4GeneratorProcess-3:
Process G4GeneratorProcess-4:
Process G4GeneratorProcess-1:
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
Traceback (most recent call last):
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
    self.run()
    self.run()
    self.run()
  File "/usr/local/env/chroma_env/src/chroma/chroma/generator/photon.py", line 32, in run
  File "/usr/local/env/chroma_env/src/chroma/chroma/generator/photon.py", line 32, in run
  File "/usr/local/env/chroma_env/src/chroma/chroma/generator/photon.py", line 32, in run
  File "/usr/local/env/chroma_env/src/chroma/chroma/generator/photon.py", line 32, in run
    ev = vertex_socket.recv_pyobj()
    ev = vertex_socket.recv_pyobj()
    ev = vertex_socket.recv_pyobj()
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/zmq/sugar/socket.py", line 344, in recv_pyobj
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/zmq/sugar/socket.py", line 344, in recv_pyobj
    ev = vertex_socket.recv_pyobj()
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/zmq/sugar/socket.py", line 344, in recv_pyobj
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/zmq/sugar/socket.py", line 344, in recv_pyobj
    s = self.recv(flags)
    s = self.recv(flags)
  File "socket.pyx", line 622, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5403)
    s = self.recv(flags)
  File "socket.pyx", line 622, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5403)
  File "socket.pyx", line 622, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5403)
    s = self.recv(flags)
  File "socket.pyx", line 622, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5403)
  File "socket.pyx", line 656, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5222)
  File "socket.pyx", line 656, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5222)
  File "socket.pyx", line 656, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5222)
  File "socket.pyx", line 656, in zmq.backend.cython.socket.Socket.recv (zmq/backend/cython/socket.c:5222)
  File "socket.pyx", line 139, in zmq.backend.cython.socket._recv_copy (zmq/backend/cython/socket.c:1711)
  File "socket.pyx", line 139, in zmq.backend.cython.socket._recv_copy (zmq/backend/cython/socket.c:1711)
  File "checkrc.pxd", line 11, in zmq.backend.cython.checkrc._check_rc (zmq/backend/cython/socket.c:5713)
  File "checkrc.pxd", line 11, in zmq.backend.cython.checkrc._check_rc (zmq/backend/cython/socket.c:5713)
  File "socket.pyx", line 139, in zmq.backend.cython.socket._recv_copy (zmq/backend/cython/socket.c:1711)
  File "socket.pyx", line 139, in zmq.backend.cython.socket._recv_copy (zmq/backend/cython/socket.c:1711)
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/Geant4/__init__.py", line 242, in _run_abort
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/Geant4/__init__.py", line 242, in _run_abort
  File "checkrc.pxd", line 11, in zmq.backend.cython.checkrc._check_rc (zmq/backend/cython/socket.c:5713)
  File "checkrc.pxd", line 11, in zmq.backend.cython.checkrc._check_rc (zmq/backend/cython/socket.c:5713)
    raise KeyboardInterrupt
    raise KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/Geant4/__init__.py", line 242, in _run_abort
  File "/usr/local/env/chroma_env/lib/python2.7/site-packages/Geant4/__init__.py", line 242, in _run_abort
    raise KeyboardInterrupt
KeyboardInterrupt
    raise KeyboardInterrupt
KeyboardInterrupt</pre>
</div>
</div>
<div class="section" id="xquartz-display-issue-resolved">
<h2>XQuartz DISPLAY issue : RESOLVED<a class="headerlink" href="#xquartz-display-issue-resolved" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://root.cern.ch/phpBB3/viewtopic.php?f=3&amp;t=17240">http://root.cern.ch/phpBB3/viewtopic.php?f=3&amp;t=17240</a></li>
</ul>
<p>Initially xclock and root fail to work saying:</p>
<div class="highlight-python"><pre>root: can't figure out DISPLAY, set it manually
In case you run a remote ssh session, restart your ssh session with:
=========&gt;  ssh -Y</pre>
</div>
<p>Resolved by logging out and back in again, following the XQuartz install.</p>
</div>
<div class="section" id="zombie-test-root-file-invalid">
<h2>zombie test.root file : INVALID<a class="headerlink" href="#zombie-test-root-file-invalid" title="Permalink to this headline">¶</a></h2>
<p>This was due to the above &#8220;hang&#8221; and killing the session.</p>
<div class="highlight-python"><pre>(chroma_env)delta:test blyth$ root test.root
  *******************************************
  *                                         *
  *        W E L C O M E  to  R O O T       *
  *                                         *
  *   Version   5.34/14  16 December 2013   *
  *                                         *
  *  You are welcome to visit our Web site  *
  *          http://root.cern.ch            *
  *                                         *
  *******************************************

ROOT 5.34/14 (v5-34-14@v5-34-14, Dec 16 2013, 12:23:58 on macosx64)

CINT/ROOT C/C++ Interpreter version 5.18.00, July 2, 2010
Type ? for help. Commands must be C++ statements.
Enclose multiple statements between { }.
root [0]
Attaching file test.root as _file0...
Warning in &lt;TFile::Init&gt;: file test.root probably not closed, trying to recover
Warning in &lt;TFile::Init&gt;: no keys recovered, file has been made a Zombie
root [1]
root [1]</pre>
</div>
</div>
<div class="section" id="working">
<h2>working<a class="headerlink" href="#working" title="Permalink to this headline">¶</a></h2>
<p>Curiously try again with some logging added and it seems to work.
Order 10 &#8220;Photon hit time&#8221; matplotlib windows are popped up.
Have to close them in turn for script to complete:</p>
<div class="highlight-python"><pre>(chroma_env)delta:test blyth$ ./simple_detector.py
INFO:__main__:start other import
INFO:__main__:after import
INFO:__main__:starting
INFO:__main__:build_detector
INFO:chroma:Flattening detector mesh...
INFO:chroma:  triangles: 107928
INFO:chroma:  vertices:  44970
INFO:__main__:load_bvh
INFO:chroma:Loading BVH "default" for geometry from cache.
INFO:chroma:Optimization: Sufficient memory to move triangles onto GPU
INFO:chroma:Optimization: Sufficient memory to move vertices onto GPU
INFO:chroma:device usage:
----------
nodes           142.2K   2.3M
total                    2.3M
----------
device total             2.1G
device used            157.5M
device free              2.0G

INFO:__main__:start photon_bomb simulation
INFO:__main__:ev &lt;chroma.event.Event object at 0x112a7a190&gt;
INFO:__main__:start gun simulation
(chroma_env)delta:test blyth$</pre>
</div>
<p>A root file is created:</p>
<div class="highlight-python"><pre>(chroma_env)delta:test blyth$ du -h test.root
253M    test.root</pre>
</div>
<p>Examining distributions in root with TBrowser shows a lot of distributions
suggesting the propagation is working:</p>
<div class="highlight-python"><pre>root [7] TBrowser b</pre>
</div>
</div>
<div class="section" id="how-to-see-what-is-happening-on-gpu">
<h2>how to see what is happening on GPU<a class="headerlink" href="#how-to-see-what-is-happening-on-gpu" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://on-demand.gputechconf.com/gtc/2012/presentations/S0419B-GTC2012-Profiling-Profiling-Tools.pdf">http://on-demand.gputechconf.com/gtc/2012/presentations/S0419B-GTC2012-Profiling-Profiling-Tools.pdf</a></li>
<li><a class="reference external" href="http://www.google.com/search?q=cuda nvvp">google:cuda nvvp</a></li>
<li><a class="reference external" href="http://outreach.sbel.wisc.edu/Workshops/GPUworkshop/2012-ncit/presentation-day3.pdf">http://outreach.sbel.wisc.edu/Workshops/GPUworkshop/2012-ncit/presentation-day3.pdf</a></li>
<li><a class="reference external" href="https://developer.nvidia.com/nvidia-visual-profiler">https://developer.nvidia.com/nvidia-visual-profiler</a></li>
<li><a class="reference external" href="https://developer.nvidia.com/nsight-eclipse-edition">https://developer.nvidia.com/nsight-eclipse-edition</a></li>
</ul>
</div>
<div class="section" id="with-more-logging">
<h2>with more logging<a class="headerlink" href="#with-more-logging" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>(chroma_env)delta:test blyth$ ./simple_detector.py
INFO:__main__:start simple_detector
INFO:__main__:after imports
INFO:__main__:after first defs
INFO:__main__:after second defs
INFO:__main__:starting main
INFO:__main__:after main imports
INFO:__main__:after build_detector
INFO:chroma:Flattening detector mesh...
INFO:chroma:  triangles: 107928
INFO:chroma:  vertices:  44970
INFO:__main__:after flatten
INFO:chroma:Loading BVH "default" for geometry from cache.
INFO:__main__:after load_bvh
INFO:chroma:Optimization: Sufficient memory to move triangles onto GPU
INFO:chroma:Optimization: Sufficient memory to move vertices onto GPU
INFO:chroma:device usage:
----------
nodes           142.2K   2.3M
total                    2.3M
----------
device total             2.1G
device used            174.1M
device free              2.0G

INFO:__main__:after sim instanciation
INFO:__main__:start photon_bomb simulation
INFO:__main__:ev &lt;chroma.event.Event object at 0x116ce1250&gt;
INFO:__main__:start gun simulation
INFO:__main__:write ev &lt;chroma.event.Event object at 0x116ce1310&gt;
INFO:__main__:detected [False False False ..., False False False] 328430
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c63e710&gt;
INFO:__main__:detected [False False False ..., False  True False] 242802
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c6a2090&gt;
INFO:__main__:detected [False False False ..., False False False] 306569
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c66ded0&gt;
INFO:__main__:detected [False False False ..., False False False] 327345
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c6a23d0&gt;
INFO:__main__:detected [False False False ..., False False False] 336813
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c690750&gt;
INFO:__main__:detected [False False False ..., False False False] 391338
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c6f3290&gt;
INFO:__main__:detected [False False False ..., False False False] 390456
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c738cd0&gt;
INFO:__main__:detected [False False False ..., False False False] 380238
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c72fe90&gt;
INFO:__main__:detected [False False False ..., False False False] 328344
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:write ev &lt;chroma.event.Event object at 0x12c66c810&gt;
INFO:__main__:detected [False False False ..., False False False] 279567
INFO:__main__:show plot
INFO:__main__:after show plot
INFO:__main__:after gun loop
INFO:__main__:after close
(chroma_env)delta:test blyth$</pre>
</div>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../chroma_uncertainties/" title="uncertainties"
             >next</a> |</li>
        <li class="right" >
          <a href="../chroma_cube/" title="cube example"
             >previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >chroma</a> &raquo;</li>
          <li><a href="../" >tests</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>