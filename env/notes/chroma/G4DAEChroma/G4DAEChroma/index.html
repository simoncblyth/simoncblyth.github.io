<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>G4DAEChroma &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../../" />
    <link rel="up" title="G4DAEChroma" href="../" />
    <link rel="next" title="G4DAEChroma Implementation Details" href="G4DAEChroma_implementation/" />
    <link rel="prev" title="G4DAEChroma" href="../" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="G4DAEChroma_implementation/" title="G4DAEChroma Implementation Details"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="G4DAEChroma"
             accesskey="P">previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >chroma</a> &raquo;</li>
          <li><a href="../" accesskey="U">G4DAEChroma</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pycuda/">pycuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../geant4/">geant4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">chroma</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../">G4DAEChroma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_issues/">Chroma Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_intersection/">Chroma Intersection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma/">CHROMA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how_chroma_works/">How Chroma Works ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/">Chroma Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../refs/">Chroma Refs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_prerequisites/">Chroma Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_geant4_integration/">Chroma Geant4 Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_nuwa_geant4_integration/">Chroma/NuWa/Geant4 Integration with ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_nuwa_integration/">Chroma NuWa Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_cuda_photon/">Chroma CUDA Photon handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_collada/">Chroma COLLADA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_pycuda/">Getting to know how Chroma uses PyCUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_pyublas/">Chroma Use of PyUblas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_geometry/">Chroma Geometry Source Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_materials/">Chroma Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_propagate/">Photon Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_physics/">Chroma Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_detector/">Chroma Modeling of Sensitive Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_server/">Chroma Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_zeromq/">Chroma ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_camera/">chroma_camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_sim/">chroma_sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_cuda_freeze/">Chroma CUDA Freeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_cuda/">Chroma CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_visualisation/">Chroma Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../photon_mapping/">Photon Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geant4_background/">Geant4 Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cuda_background/">Cuda Threads and Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bvh_background/">Bounding Volume Hierarchy (BVH)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_install/">install issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_tests/">tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ChromaZMQRootTest/">ChromaZMQRootTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_curand/">Chroma Use Of CURand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chroma_reemission/">Chroma Reemission</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../javascript/">javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nuwa/">nuwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hg/">hg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../simoncblyth.bitbucket.org/">simoncblyth.bitbucket.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../numpy/">numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../presentation/">Muon Simulation Presentation</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/chroma/G4DAEChroma/G4DAEChroma.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../"
                        title="previous chapter">G4DAEChroma</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="G4DAEChroma_implementation/"
                        title="next chapter">G4DAEChroma Implementation Details</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="g4daechroma">
<h1>G4DAEChroma<a class="headerlink" href="#g4daechroma" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>Pull out everything Chroma related and reusable
from StackAction and SensitiveDetector
for flexible reusability from different Geant4 contexts</p>
</div>
<div class="section" id="recent-changes">
<h2>Recent Changes<a class="headerlink" href="#recent-changes" title="Permalink to this headline">¶</a></h2>
<p>Major recent changes are:</p>
<ul>
<li><p class="first">forming PMT hits on the GPU, by associating every triangle
of the PMT cathode with the PMT identifier.
This allows returning only photons that hit PMTs to Geant4</p>
</li>
<li><p class="first">transforming global hit coordinates into local coordinates for the hits using
a per PMT transform cache</p>
</li>
<li><p class="first">integrating the GPU formed hits into the standard Geant4 hit collections,
allowing subsequent simulation to work unchanged</p>
</li>
<li><p class="first">moving Scintillation and Cerenkov generation to the GPU by
collecting generation steps and transferring those.
Avoids having to transfer ~200MB of photon data for a 3M photon event :
instead down to  ~2MB of generation steps.</p>
<p>Its also advantageous never to even create G4Track for the millions
of photons : they are skipped in the Scintillation and Cerenkov processes</p>
</li>
<li><p class="first">adopting NumPy serialization format, so can effectively directly fill
NumPy arrays from Geant4 C++
Allows to get rid of ROOT TObject, (and ROOT entirely) and annoying
dictionary generation hassles.</p>
</li>
<li><p class="first">for monitoring, control and communication  G4DAEChroma includes
integration with sqlite3 and a cJSON implementation allowing python
dicts to be passed to C++ as map&lt;string,string&gt; which can be
inserted into sqlite3 tables</p>
</li>
<li><p class="first">G4DAE geometry exporter was presented at the Geant4 Okinawa Collaboration
meeting in Sept. I proposed to contribute the exporter to Geant4 and they agreed.
The plan is to include it with the Geant4 released at the end of 2015.</p>
</li>
</ul>
</div>
<div class="section" id="todo-test-on-workstation-gpu">
<h2>TODO : Test on Workstation GPU<a class="headerlink" href="#todo-test-on-workstation-gpu" title="Permalink to this headline">¶</a></h2>
<p>So far I have been developing using my laptop GPU only.
I think I will soon be interested in testing the machinery to see
the kind of performance possible on workstation GPUs.</p>
<p>Comparing my laptop GPU (with that</p>
<ul class="simple">
<li><a class="reference external" href="http://www.techpowerup.com/gpudb/2527/geforce-gt-750m-mac-edition.html">http://www.techpowerup.com/gpudb/2527/geforce-gt-750m-mac-edition.html</a></li>
<li><a class="reference external" href="http://www.techpowerup.com/gpudb/2029/tesla-k20m.html">http://www.techpowerup.com/gpudb/2029/tesla-k20m.html</a></li>
</ul>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>ROOT, CLHEP, Geant4, ZMQ, ZMQRoot</li>
<li><strong>NOT</strong> detsim/giga/gaudi/gauss<ul>
<li>G4DAEChroma intended to be used from minimal
shim G4 Actions hooked up in DetSim/GiGa
in as few lines of code as possible</li>
<li>this facilities limited dependency development/testing
providing faster dev cycle : see <cite>mocknuwa-</cite> <cite>datamodel-</cite></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="current-approach-aiming-at">
<h2>Current Approach Aiming at<a class="headerlink" href="#current-approach-aiming-at" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Cerenkov/Scintillation processes generating large numbers of secondary Optical Photons</li>
<li>these are put into track stack</li>
<li>collected from track stack and track killed into PhotonList</li>
<li>PhotonList is serialized, sent over network and deseralized</li>
<li>PhotonList then copied to GPU and propagated</li>
<li>Photons then copied back from GPU</li>
<li>hit selection is applied (ie need to have reached SURFACE_DETECT) and a HitList
is compiled</li>
<li>HitList then serialized and replied to original request</li>
<li>HitList deserialized back in Geant4 process, and collected into
standard DsPmtSensDet hit collections using TrojanSensDet approach</li>
</ul>
</div>
<div class="section" id="ultimate-photon-list-compression-approach">
<h2>Ultimate photon list compression approach<a class="headerlink" href="#ultimate-photon-list-compression-approach" title="Permalink to this headline">¶</a></h2>
<p>Moving generation of PhotonList to the other end of the transport
would allow to only transfer generation parameters
of the PhotonList cohort as formed in the Cerenkov/Scintillation process.</p>
<ul class="simple">
<li><strong>Ultimate Photon List compression : just transfer parameters of the cohort</strong></li>
</ul>
</div>
<div class="section" id="transform-cache-problem">
<h2>Transform cache problem<a class="headerlink" href="#transform-cache-problem" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>currently keyed on volume_index but that is not being trasported, only pmtid is</li>
</ul>
</div>
<div class="section" id="geometry-consistency-between-gpu-and-memory-trees">
<h2>Geometry Consistency between GPU and MEMORY trees<a class="headerlink" href="#geometry-consistency-between-gpu-and-memory-trees" title="Permalink to this headline">¶</a></h2>
<p>Geometry matching between in MEMORY G4 tree
and the one reconstructed from DAE file should
be done in a handshake REQ/REP.</p>
<p>This will be particularly useful when
handling multiple partial geometries.</p>
<ul class="simple">
<li>maybe implement in some metadata properties of the transport object</li>
</ul>
</div>
<div class="section" id="appropriate-identifiers">
<h2>Appropriate identifiers<a class="headerlink" href="#appropriate-identifiers" title="Permalink to this headline">¶</a></h2>
<p>Currently make heavy use of volume traverse indices.
This is a frail approach as using partial geometries or otherwise updating
geometry will change the indices.
Better to affix things like transforms to PMT Identifiers
which can be regarded as permanent identifiers.</p>
</div>
<div class="section" id="generalization-of-pmt-identifier-handling">
<h2>Generalization of PMT Identifier handling<a class="headerlink" href="#generalization-of-pmt-identifier-handling" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Construct Volume Transform cache keyed on PmtId</strong></li>
</ul>
<p>Want to add IDMAP handling to G4DAEGeometry organized into</p>
<ul class="simple">
<li>generic base, depending on Geant4 only<ul>
<li>Geant4 volume traversal</li>
<li>making PVStack for all nodes of the tree</li>
<li>forming TouchableHistories for all Sensitive Detectors</li>
<li>a default implementation of providing identifiers could
just be the SD index in volume traverse order</li>
</ul>
</li>
<li>Dyb specialized level, depending on Gaudi/Gauss/DetectorElements/NuWa:TH2DE<ul>
<li>yields PmtId from TouchableHistory for all SD,</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="incorporate-idmap-handling-into-g4daechroma-g4daegeometry">
<h2>Incorporate IDMAP Handling into G4DAEChroma/G4DAEGeometry<a class="headerlink" href="#incorporate-idmap-handling-into-g4daechroma-g4daegeometry" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Chroma GPU photons reaching SURFACE_DETECT know the solid/volume index they are landing on</li>
<li>to be able to return only hits the association from volume index
a PmtId is needed in order to form a <strong>hit</strong></li>
</ol>
<p>Need to know the PmtId at GPU level, so have to propagate this forward.</p>
<p>The PmtId are associated to pieces of geometry &#8220;DetectorElements&#8221;
at Gaudi level, this info does not exist at Geant4 level, so have
to do contortions to make the association of volume traverse
index and pmtid.</p>
<p>Merge what is currently done separately in the below into G4DAEGeometry</p>
<ul class="simple">
<li>NuWa-trunk/lhcb/Sim/GaussTools/src/Components/GiGaRunActionExport.h</li>
<li>NuWa-trunk/lhcb/Sim/GaussTools/src/Components/GiGaRunActionExport.cpp</li>
</ul>
</div>
<div class="section" id="usage-stages">
<h2>Usage Stages<a class="headerlink" href="#usage-stages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="beginofrunaction">
<h3>BeginOfRunAction<a class="headerlink" href="#beginofrunaction" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>G4DAEChroma::G4DAEChroma</cite> ctor singleton and configure constituents<ul>
<li>Geometry : traverse volume tree creating tranform cache</li>
<li>Transport : prepare ZMQ sockets</li>
<li>SensDet : use Trojan to steal DsPmtSensDet hit collections and AddNewDetector</li>
</ul>
</li>
<li>geometry is exported to DAE in BeginOfRunAction also,
but only need to do that once</li>
</ul>
</div>
<div class="section" id="stackaction-classifynewtrack-or-customized-processes">
<h3>StackAction::ClassifyNewTrack OR customized Processes<a class="headerlink" href="#stackaction-classifynewtrack-or-customized-processes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><dl class="first docutils">
<dt><cite>G4DAEChroma::CollectPhoton</cite>  and avoid further</dt>
<dd><p class="first last">G4 processing via kill or not adding as secondary</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="stackaction-newstage">
<h3>StackAction::NewStage<a class="headerlink" href="#stackaction-newstage" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>perhaps could be Event</li>
<li><cite>G4DAEChroma::Propagate</cite>  which proceeds to add the hits</li>
</ul>
</div>
</div>
<div class="section" id="how-to-organize-code">
<h2>How to organize code<a class="headerlink" href="#how-to-organize-code" title="Permalink to this headline">¶</a></h2>
<p>Everything under single G4DAEChroma umbrella manager singleton
using methods and constituent worker classes for each aspect:</p>
<ul class="simple">
<li>geometry export</li>
<li>geometry gdml loading</li>
<li>trojan SD registration</li>
<li>extra hit adding</li>
<li>photon collection</li>
</ul>
<p>Primary concern of organization is:</p>
<ul class="simple">
<li><strong>ease of testing from MockNuWa</strong></li>
</ul>
<p>Leave usage of StackAction etc at level of examples</p>
</div>
<div class="section" id="mocknuwa-code-development">
<h2>MockNuWa code development<a class="headerlink" href="#mocknuwa-code-development" title="Permalink to this headline">¶</a></h2>
<p>See</p>
<ul class="simple">
<li>mocknuwa-</li>
<li>datamodel-</li>
<li>gdc-  G4DAEChroma</li>
<li>gdct- G4DAEChromaTest</li>
</ul>
</div>
<div class="section" id="real-nuwa-hookup-for-machinery-test">
<h2>Real NuWa hookup for machinery test<a class="headerlink" href="#real-nuwa-hookup-for-machinery-test" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>[blyth@belle7 dybgaudi]$ svn ci -m "minor: add G4DAEChroma package and hookup to DetSimChroma StackAction and RunAction "
Sending        Simulation/DetSimChroma/src/DetSimChroma_entries.cc
Adding         Simulation/DetSimChroma/src/DsChromaRunAction.cc
Adding         Simulation/DetSimChroma/src/DsChromaRunAction.h
Sending        Simulation/DetSimChroma/src/DsChromaStackAction.cc
Adding         Utilities/G4DAEChroma/G4DAEChroma/G4DAEChroma.hh
Adding         Utilities/G4DAEChroma/G4DAEChroma/G4DAEGeometry.hh
Adding         Utilities/G4DAEChroma/G4DAEChroma/G4DAESensDet.hh
Adding         Utilities/G4DAEChroma/G4DAEChroma/G4DAETransport.hh
Adding         Utilities/G4DAEChroma/G4DAEChroma/G4DAETrojanSensDet.hh
Sending        Utilities/G4DAEChroma/cmt/requirements
Sending        Utilities/G4DAEChroma/src/G4DAEChroma.cc
Adding         Utilities/G4DAEChroma/src/G4DAEGeometry.cc
Adding         Utilities/G4DAEChroma/src/G4DAESensDet.cc
Adding         Utilities/G4DAEChroma/src/G4DAETransport.cc
Adding         Utilities/G4DAEChroma/src/G4DAETrojanSensDet.cc
Transmitting file data ...............
Committed revision 23458.
[blyth@belle7 dybgaudi]$ date
Tue Oct 21 20:57:27 CST 2014</pre>
</div>
<p>Integrate with real NuWa via shims:</p>
<ul class="simple">
<li><cite>DsChromaRunAction</cite></li>
<li><cite>DsChromaStackAction</cite></li>
</ul>
<p>that all depend on G4DAEChroma from Utilities.</p>
<p>Keep all functionality in G4DAEChroma, only thing admissable
to do in the shim is configuration.</p>
<div class="section" id="csa-chromastackaction">
<h3>csa : ChromaStackAction<a class="headerlink" href="#csa-chromastackaction" title="Permalink to this headline">¶</a></h3>
<p>Hmm this is sourced from people area SVN, move to env.</p>
<p>/data1/env/local/env/muon_simulation/optical_photon_weighting/OPW/fmcpmuon.py:</p>
<div class="highlight-python"><pre>321     def configure_chromastackaction(self):
322         log.info("configure_chromastackaction")
323         import DetSimChroma
324         from DetSimChroma.DetSimChromaConf import DsChromaStackAction
325         saction = DsChromaStackAction("GiGa.DsChromaStackAction")
326         saction.PhotonCut = True      # kill OP after collection
327         saction.ModuloPhoton = 1000   # scale down collection
328         return saction</pre>
</div>
</div>
<div class="section" id="export">
<h3>export-<a class="headerlink" href="#export" title="Permalink to this headline">¶</a></h3>
<p>Handled by adding RunAction sourced from GaussTools, but cannot make GaussTools
depend on G4DAEChroma</p>
<p><cite>env/geant4/geometry/export/export_all.py</cite>:</p>
<div class="highlight-python"><pre>69     # --- WRL + GDML + DAE geometry export ---------------------------------
70     from GaussTools.GaussToolsConf import GiGaRunActionExport, GiGaRunActionCommand, GiGaRunActionSequence
71     export = GiGaRunActionExport("GiGa.GiGaRunActionExport")
..
91     giga.RunAction = export</pre>
</div>
</div>
<div class="section" id="gigarunactionbase">
<h3>GiGaRunActionBase<a class="headerlink" href="#gigarunactionbase" title="Permalink to this headline">¶</a></h3>
<p>GiGaRunActionBase.h inherits from G4UserRunAction</p>
<div class="highlight-python"><pre>[blyth@cms01 ~]$ find $DYB/NuWa-trunk/lhcb/Sim -name 'GiGa*ActionBase.h'
/data/env/local/dyb/trunk/NuWa-trunk/lhcb/Sim/GiGa/GiGa/GiGaStepActionBase.h
/data/env/local/dyb/trunk/NuWa-trunk/lhcb/Sim/GiGa/GiGa/GiGaEventActionBase.h
/data/env/local/dyb/trunk/NuWa-trunk/lhcb/Sim/GiGa/GiGa/GiGaTrackActionBase.h
/data/env/local/dyb/trunk/NuWa-trunk/lhcb/Sim/GiGa/GiGa/GiGaRunActionBase.h
/data/env/local/dyb/trunk/NuWa-trunk/lhcb/Sim/GiGa/GiGa/GiGaStackActionBase.h</pre>
</div>
<div class="highlight-python"><pre>26 class GiGaRunActionBase :
27   public virtual IGiGaRunAction ,
28   public          GiGaBase
29 {


30 class IGiGaRunAction:
31   virtual public G4UserRunAction ,
32   virtual public IGiGaInterface
33 {</pre>
</div>
<p><cite>source/run/include/G4UserRunAction.hh</cite>:</p>
<div class="highlight-python"><pre>37 //  This is the base class of a user's action class which defines the
38 // user's action at the begining and the end of each run. The user can
39 // override the following two methods but the user should not change
40 // any of the contents of G4Run object.
41 //    virtual void BeginOfRunAction(const G4Run* aRun);
42 //    virtual void EndOfRunAction(const G4Run* aRun);
43 // The user can override the following method to instanciate his/her own
44 // concrete Run class. G4Run has a virtual method RecordEvent, so that
45 // the user can store any information useful to him/her with event statistics.
46 //    virtual G4Run* GenerateRun();
47 //  The user's concrete class derived from this class must be set to
48 // G4RunManager via G4RunManager::SetUserAction() method.
49 //
50 #include "G4Types.hh"
51
52 class G4UserRunAction
53 {
54   public:
55     G4UserRunAction();
56     virtual ~G4UserRunAction();
57
58   public:
59     virtual G4Run* GenerateRun();
60     virtual void BeginOfRunAction(const G4Run* aRun);
61     virtual void EndOfRunAction(const G4Run* aRun);
62</pre>
</div>
</div>
</div>
<div class="section" id="gigarunactionexport">
<h2>GiGaRunActionExport<a class="headerlink" href="#gigarunactionexport" title="Permalink to this headline">¶</a></h2>
<p><cite>/data1/env/local/dyb/NuWa-trunk/lhcb/Sim/GaussTools/src/Components/GiGaRunActionExport.h</cite>:</p>
<div class="highlight-python"><pre>28 class GiGaRunActionExport: public virtual GiGaRunActionBase
29 {
30   /// friend factory for instantiation
31   //friend class GiGaFactory&lt;GiGaRunActionExport&gt;;
32
33 public:
34
35   typedef std::vector&lt;G4VPhysicalVolume*&gt; PVStack_t;
36
37
38   /** performe the action at the begin of each run
39    *  @param run pointer to Geant4 run object
40    */
41   void BeginOfRunAction ( const G4Run* run );
42
43   /** performe the action at the end  of each event
44    *  @param run pointer to Geant4 run object
45    */
46   void EndOfRunAction   ( const G4Run* run );
47</pre>
</div>
<div class="highlight-python"><pre>660 void GiGaRunActionExport::BeginOfRunAction( const G4Run* run )
661 {
662
663   if( 0 == run )
664     { Warning("BeginOfRunAction:: G4Run* points to NULL!") ; }
665
666    G4VPhysicalVolume* wpv = G4TransportationManager::GetTransportationManager()-&gt;
667       GetNavigatorForTracking()-&gt;GetWorldVolume();
668
669</pre>
</div>
</div>
<div class="section" id="initialize-in-runaction">
<h2>Initialize in RunAction?<a class="headerlink" href="#initialize-in-runaction" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>// 2nd parameter target must match the name of an existing SD</pre>
</div>
<p>Normally <cite>AddNewDetector</cite> is done at G4 ConstructDetector
initialization stage but seems no GiGa hooks back then.
Try in RunAction, but with a check to make sure not already there.
Makes sense to add this to the <cite>GiGaRunActionExport</cite> code that does the G4DAE export..</p>
<ul class="simple">
<li><a class="reference external" href="http://dayabay.ihep.ac.cn/tracs/dybsvn/browser/lhcb/trunk/Sim/GaussTools/src/Components">http://dayabay.ihep.ac.cn/tracs/dybsvn/browser/lhcb/trunk/Sim/GaussTools/src/Components</a></li>
<li><a class="reference external" href="http://dayabay.ihep.ac.cn/tracs/dybsvn/browser/lhcb/trunk/Sim/GaussTools/src/Components/GiGaRunActionExport.cpp">http://dayabay.ihep.ac.cn/tracs/dybsvn/browser/lhcb/trunk/Sim/GaussTools/src/Components/GiGaRunActionExport.cpp</a></li>
</ul>
<p>As operating from the real G4 geometry tree (not the GDML one),
can collect SD names by logical volume inspection during the traverse.
Might as well include SD names in the COLLADA export metadata.</p>
<div class="section" id="looking-for-hooks">
<h3>Looking for hooks<a class="headerlink" href="#looking-for-hooks" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>[blyth@cms01 lhcb]$ find . -name '*Action.h'
./InstallArea/include/GiGa/IGiGaEventAction.h
./InstallArea/include/GiGa/IGiGaStepAction.h
./InstallArea/include/GiGa/IGiGaStackAction.h
./InstallArea/include/GiGa/IGiGaTrackAction.h
./InstallArea/include/GiGa/IGiGaRunAction.h
./Sim/GiGa/src/Lib/IIDIGiGaRunAction.h
./Sim/GiGa/src/Lib/IIDIGiGaTrackAction.h
./Sim/GiGa/src/Lib/IIDIGiGaEventAction.h
./Sim/GiGa/src/Lib/IIDIGiGaStepAction.h
./Sim/GiGa/src/Lib/IIDIGiGaStackAction.h
./Sim/GiGa/GiGa/IGiGaEventAction.h
./Sim/GiGa/GiGa/IGiGaStepAction.h
./Sim/GiGa/GiGa/IGiGaStackAction.h
./Sim/GiGa/GiGa/IGiGaTrackAction.h
./Sim/GiGa/GiGa/IGiGaRunAction.h
./Sim/GaussTools/src/Components/CommandTrackAction.h
./Sim/GaussTools/src/Components/TrCutsRunAction.h
./Sim/GaussTools/src/Components/GaussStepAction.h
./Sim/GaussTools/src/Components/GaussPostTrackAction.h
./Sim/GaussTools/src/Components/GaussPreTrackAction.h
./Sim/GaussTools/src/Components/CutsStepAction.h
[blyth@cms01 lhcb]$</pre>
</div>
<p><cite>env/geant4/geometry/export/export_all.py</cite>:</p>
<div class="highlight-python"><pre>70     from GaussTools.GaussToolsConf import GiGaRunActionExport, GiGaRunActionCommand, GiGaRunActionSequence
71     export = GiGaRunActionExport("GiGa.GiGaRunActionExport")
72
73     #   NOT WORKING :  RunSeq fails to do the vis : only the GDML+DAE gets exported
74     #   so do at C++ level
75     #
76     #wrl  = GiGaRunActionCommand("GiGa.GiGaRunActionCommand")
77     #wrl.BeginOfRunCommands = [
78     #         "/vis/open VRML2FILE",
79     #         "/vis/viewer/set/culling global false",
80     #         "/vis/viewer/set/culling coveredDaughters false",
81     #         "/vis/drawVolume",
82     #         "/vis/viewer/flush"
83     #]
84     #runseq = GiGaRunActionSequence("GiGa.GiGaRunActionSequence")
85     #giga.addTool( runseq , name="RunSeq" )
86     #giga.RunSeq.Members += ["GiGaRunActionCommand"]
87     #giga.RunSeq.Members += ["GiGaRunActionGDML"]
88     #giga.RunAction = "GiGaRunActionSequence/RunSeq"
89     # why so many ways to address things ? Duplication is evil
90
91     giga.RunAction = export</pre>
</div>
</div>
</div>
<div class="section" id="issues">
<h2>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="development-cycle-too-slow">
<h3>Development Cycle too slow<a class="headerlink" href="#development-cycle-too-slow" title="Permalink to this headline">¶</a></h3>
<p>Create test application for machinery test
(enable to rapidly work on the marshalling)</p>
<ul class="simple">
<li>reads Dyb geometry into G4 from exported GDML</li>
<li>reads some initial photon positions from a .root file</li>
<li>invokes this photon collection and propagation</li>
<li>dumps the hits returned</li>
</ul>
<p><strong>Using MockNuWa with NuWa DataModel subset for fast cycle</strong></p>
</div>
<div class="section" id="gpu-hit-handling-sensdet">
<h3>GPU Hit handling : SensDet<a class="headerlink" href="#gpu-hit-handling-sensdet" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>how to register DsChromaPmtSensDet instead of (or in addition to) DsPmtSensDet
or some how get access to DsPmtSensDet<ul>
<li>class name &#8220;DsPmtSensDet&#8221; is mentioned in DetDesc
logvol sensdet attribute, somehow DetDesc/GiGa
hands that over to Geant4 : need to swizzle OR add ?</li>
<li>old approach duplicated bits of &#8220;DsPmtSensDet&#8221; for adding
hits into the StackAction : that was too messy then, but perhaps
clean enough now have pulled out Chroma parts into G4DAEChroma</li>
<li>but needs access to private methods from DsPmtSensDet, so
maybe a no-no anyhow : especially as need very little
functionality</li>
</ul>
</li>
</ul>
<p><strong>Using TrojanSD approach registered in the RunActionExport</strong></p>
</div>
<div class="section" id="accessing-sd">
<h3>Accessing SD<a class="headerlink" href="#accessing-sd" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>how to get access to DsPmtSensDet in order to add hits<ul>
<li>provide singleton accessor for cheat access to globally
shared instance ?
Approach has MT complications : but no need to worry about that yet</li>
<li>gaudi has a way of accessing the instance, do it externally (where?)
and pass it in</li>
</ul>
</li>
</ul>
<p><strong>Doing it via a Trojan parasitic G4VSensitiveDetector which
caches the hit collections of the real SD</strong>:</p>
<div class="highlight-python"><pre>// adding extra hits needs access to the tsd
TrojanSensDet* TSD = (TrojanSensDet*)G4SDManager::GetSDMpointer()-&gt;FindSensitiveDetector("Trojan_DsPmtSensDet", true);</pre>
</div>
</div>
<div class="section" id="detector-specific-code">
<h3>Detector Specific Code<a class="headerlink" href="#detector-specific-code" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>how to handle hits interfacing to detector specific code</li>
<li>arrange det specifics together and use preprocessor macros</li>
</ul>
</div>
</div>
<div class="section" id="trace-channel-id-pmtid-from-cuda-kernel-backwards">
<h2>Trace channel_id/PmtId from CUDA kernel backwards<a class="headerlink" href="#trace-channel-id-pmtid-from-cuda-kernel-backwards" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>a positive <cite>last_hit_triangle</cite> for the <cite>SURFACE_DETECT</cite> subset indicates a <strong>hit</strong></li>
</ul>
<p><cite>chroma/chroma/cuda/propagate_hit.cu</cite>:</p>
<div class="highlight-python"><pre>118 // iiPPPPPPPPPPPiiiP
119
120 __global__ void
121 propagate_hit(
122       int first_photon,
123       int nthreads,
124       unsigned int *input_queue,
125       unsigned int *output_queue,
126       curandState *rng_states,
127       float3 *positions,
128       float3 *directions,
129       float *wavelengths,
130       float3 *polarizations,
131       float *times,
132       unsigned int *histories,
133       int *last_hit_triangles,
134       float *weights,
135       int max_steps,
136       int use_weights,
137       int scatter_first,
138       Geometry *g,
139       int* solid_map,
140       int* solid_id_to_channel_id )
141 {
142     __shared__ Geometry sg;
143
...
233     if ((p.history &amp; SURFACE_DETECT) != 0) {
234
235         //
236         // kludgy mis-use of lht for outputting
237         // various things like
238         //       solid_id:    index like, zero based
239         //       channel_id:  the pmtid, encoding site/ad/ring/...
240         //
241         int triangle_id = last_hit_triangles[photon_id];
242         if (triangle_id &gt; -1) {
243             int solid_id = solid_map[triangle_id];
244             int channel_id = solid_id_to_channel_id[solid_id];
245             last_hit_triangles[photon_id] = channel_id ;
246         } else {
247             last_hit_triangles[photon_id] = -2 ;
248         }
249
250     }
251
252
253
254 } // propagate_hit</pre>
</div>
<p><cite>chroma/chroma/gpu/photon_hit.py</cite>:</p>
<div class="highlight-python"><pre>154     def propagate_hit(self,
155                   gpu_geometry,
156                   rng_states,
157                   nthreads_per_block=64,
158                   max_blocks=1024,
159                   max_steps=100,
160                   use_weights=False,
161                   scatter_first=0):
162         """Propagate photons on GPU to termination or max_steps, whichever
163         comes first.
164
165         May be called repeatedly without reloading photon information if
166         single-stepping through photon history.
167
168         ..warning::
169             `rng_states` must have at least `nthreads_per_block`*`max_blocks`
170             number of curandStates.
171         """
172         nphotons = self.pos.size
173         nwork = nphotons
174         self.upload_queues( nwork )
175
176         solid_id_map_gpu = gpu_geometry.solid_id_map
177         solid_id_to_channel_id_gpu = gpu_geometry.solid_id_to_channel_id_gpu
178</pre>
</div>
<p>Modified original GPUPhotons to GPUPhotonsHit to add this hit info.</p>
<p><cite>env/geant4/geometry/collada/g4daeview/daedirectpropagator.py</cite>:</p>
<div class="highlight-python"><pre>21 from chroma.gpu.tools import get_cu_module, cuda_options, chunk_iterator, to_float3
22 #from chroma.gpu.photon import GPUPhotons
23 from chroma.gpu.photon_hit import GPUPhotonsHit
24 from chroma.gpu.geometry import GPUGeometry
..
27 class DAEDirectPropagator(object):
28     def __init__(self, config, chroma):
29         """
30         :param config:
31         :param chroma: DAEChromaContext instance
32         """
33         self.config = config
34         self.chroma = chroma
35
36     def propagate(self, cpl, max_steps=100 ):
37         """
38         :param cpl: ChromaPhotonList instance
39         :return propagated_cpl: ChromaPhotonList instance
40
41         """
42         photons = Photons.from_cpl(cpl, extend=True)  # CPL into chroma.event.Photons OR photons.Photons
43         gpu_photons = GPUPhotonsHit(photons)
44         gpu_detector = self.chroma.gpu_detector
45
46         gpu_photons.propagate_hit(gpu_detector,
47                                   self.chroma.rng_states,
48                                   nthreads_per_block=self.chroma.nthreads_per_block,
49                                   max_blocks=self.chroma.max_blocks,
50                                   max_steps=max_steps)
51
52         photons_end = gpu_photons.get()
53         self.photons_end = photons_end
54         return create_cpl_from_photons_very_slowly(photons_end)</pre>
</div>
<p>Copying mapping array to GPU.</p>
<p><cite>chroma/chroma/gpu/detector.py</cite>:</p>
<div class="highlight-python"><pre>16 class GPUDetector(GPUGeometry):
17     def __init__(self, detector, wavelengths=None, print_usage=False):
18         GPUGeometry.__init__(self, detector, wavelengths=wavelengths, print_usage=False)
19
20         self.solid_id_to_channel_index_gpu = \
21             ga.to_gpu(detector.solid_id_to_channel_index.astype(np.int32))
22         self.solid_id_to_channel_id_gpu = \
23             ga.to_gpu(detector.solid_id_to_channel_id.astype(np.int32))
24
25         self.nchannels = detector.num_channels()</pre>
</div>
<p>Populate mapping array on <strong>add_pmt</strong></p>
<p><cite>chroma/chroma/detector.py</cite>:</p>
<div class="highlight-python"><pre>59     def add_pmt(self, pmt, rotation=None, displacement=None, channel_id=None):
60         """Add the PMT `pmt` to the geometry. When building the final triangle
61         mesh, `solid` will be placed by rotating it with the rotation matrix
62         `rotation` and displacing it by the vector `displacement`, just like
63         add_solid().
64
65             `pmt``: instance of chroma.Solid
66                 Solid representing a PMT.
67             `rotation`: numpy.matrix (3x3)
68                 Rotation to apply to PMT mesh before displacement.  Defaults to
69                 identity rotation.
70             `displacement`: numpy.ndarray (shape=3)
71                 3-vector displacement to apply to PMT mesh after rotation.
72                 Defaults to zero vector.
73             `channel_id`: int
74                 Integer identifier for this PMT.  May be any integer, with no
75                 requirement for consective numbering.  Defaults to None,
76                 where the ID number will be set to the generated channel index.
77                 The channel_id must be representable as a 32-bit integer.
78
79             Returns: dictionary { 'solid_id' : solid_id,
80                                   'channel_index' : channel_index,
81                                   'channel_id' : channel_id }
82         """
83
84         solid_id = self.add_solid(solid=pmt, rotation=rotation,
85                                   displacement=displacement)
86
87         channel_index = len(self.channel_index_to_solid_id)
88         if channel_id is None:
89             channel_id = channel_index
90
91         # add_solid resized this array already
92         self.solid_id_to_channel_index[solid_id] = channel_index
93         self.solid_id_to_channel_id[solid_id] = channel_id
94</pre>
</div>
<p><cite>channel_id</cite> Identifiers are affixed to the DAENode.</p>
<p><cite>env/geant4/geometry/collada/collada_to_chroma.py</cite>:</p>
<div class="highlight-python"><pre>701         solid = Solid( mesh, material1, material2, surface, color )
702         solid.node = node
703
704         #
705         # hmm a PMT is comprised of several volumes all of which
706         # have the same associated channel_id
707         #
708         channel_id = getattr(node, 'channel_id', None)
709         if not channel_id is None and channel_id &gt; 0:
710             self.channel_count += 1             # nodes with associated non zero channel_id
711             self.channel_ids.add(channel_id)
712             self.chroma_geometry.add_pmt( solid, channel_id=channel_id)
713         else:
714             self.chroma_geometry.add_solid( solid )
715         pass</pre>
</div>
<p>This is relying on the <strong>idmap</strong> (keyed by volume index) that is
written by <cite>GiGaRunActionExport</cite></p>
<ul class="simple">
<li>NuWa-trunk/lhcb/Sim/GaussTools/src/Components/GiGaRunActionExport.cpp</li>
</ul>
<p><cite>env/geant4/geometry/collada/g4daenode.py</cite>:</p>
<div class="highlight-python"><pre>375     @classmethod
376     def idmaplink(cls, idmap ):
377         if idmap is None:
378             log.warn("skip idmaplink ")
379             return
380         pass
381         log.info("linking DAENode with idmap %s identifiers " % len(idmap))
382         assert len(cls.registry) == len(idmap), ( len(cls.registry), len(idmap))
383         for index, node in enumerate(cls.registry):
384             node.channel_id = idmap[index]
385             node.g4tra = idmap.tra[index]
386             node.g4rot = idmap.rot[index]
387             #if index % 100 == 0:
388             #    print index, node.channel_id, node, node.__class__
389</pre>
</div>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="G4DAEChroma_implementation/" title="G4DAEChroma Implementation Details"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="G4DAEChroma"
             >previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >chroma</a> &raquo;</li>
          <li><a href="../" >G4DAEChroma</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>