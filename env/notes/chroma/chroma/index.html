<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CHROMA &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../" />
    <link rel="up" title="chroma" href="../" />
    <link rel="next" title="How Chroma Works ?" href="../how_chroma_works/" />
    <link rel="prev" title="Chroma Issues" href="../chroma_issues/" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../how_chroma_works/" title="How Chroma Works ?"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../chroma_issues/" title="Chroma Issues"
             accesskey="P">previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../">Env  documentation</a> &raquo;</li>

          <li><a href="../" accesskey="U">chroma</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pycuda/">pycuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geant4/">geant4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">chroma</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../chroma_issues/">Chroma Issues</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">CHROMA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_chroma_works/">How Chroma Works ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/">Chroma Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../refs/">Chroma Refs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_prerequisites/">Chroma Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_geant4_integration/">Chroma Geant4 Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_nuwa_geant4_integration/">Chroma/NuWa/Geant4 Integration with ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_nuwa_integration/">Chroma NuWa Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_cuda_photon/">Chroma CUDA Photon handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_collada/">Chroma COLLADA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_pycuda/">Getting to know how Chroma uses PyCUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_geometry/">Chroma Geometry Source Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_materials/">Chroma Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_propagate/">Photon Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_physics/">Chroma Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_detector/">Chroma Modeling of Sensitive Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_server/">Chroma Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_zeromq/">Chroma ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_camera/">chroma_camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_sim/">chroma_sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_cuda_freeze/">Chroma CUDA Freeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_cuda/">Chroma CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_visualisation/">Chroma Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geant4_background/">Geant4 Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cuda_background/">Cuda Threads and Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bvh_background/">Bounding Volume Hierarchy (BVH)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hardware/">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_install/">install issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chroma_tests/">tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChromaZMQRootTest/">ChromaZMQRootTest</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../javascript/">javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nuwa/">nuwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hg/">hg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../simoncblyth.bitbucket.org/">simoncblyth.bitbucket.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numpy/">numpy</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/chroma/chroma.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../chroma_issues/"
                        title="previous chapter">Chroma Issues</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../how_chroma_works/"
                        title="next chapter">How Chroma Works ?</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="chroma">
<h1>CHROMA<a class="headerlink" href="#chroma" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="http://chroma.bitbucket.org/install/overview.html">http://chroma.bitbucket.org/install/overview.html</a></li>
<li><a class="reference external" href="http://chroma.bitbucket.org/install/macosx.html">http://chroma.bitbucket.org/install/macosx.html</a></li>
<li><a class="reference external" href="http://chroma.bitbucket.org/install/overview.html#common-install">http://chroma.bitbucket.org/install/overview.html#common-install</a></li>
<li><a class="reference external" href="https://bitbucket.org/chroma/chroma.bitbucket.org/src">https://bitbucket.org/chroma/chroma.bitbucket.org/src</a></li>
</ul>
<div class="section" id="chroma-dependencies">
<h2>Chroma Dependencies<a class="headerlink" href="#chroma-dependencies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="osx-10-9-1-mavericks">
<h3>OSX 10.9.1 Mavericks<a class="headerlink" href="#osx-10-9-1-mavericks" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Xcode 5.0.2 with commandline tools</li>
<li>XQuartz 2.7.5</li>
<li>CUDA 5.5</li>
<li>Macports (logs in ~/macports/)<ul>
<li>py27-matplotlib</li>
<li>mercurial</li>
<li>py27-game</li>
<li>py27-virtualenv</li>
<li>Xft2</li>
<li>xpm</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="common">
<h3>Common<a class="headerlink" href="#common" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://shrinkwrap.readthedocs.org/en/latest/">http://shrinkwrap.readthedocs.org/en/latest/</a></li>
</ul>
</div>
<div class="section" id="careful-with-errant-eggs">
<h3>Careful with errant eggs<a class="headerlink" href="#careful-with-errant-eggs" title="Permalink to this headline">¶</a></h3>
<p>After testing build_ext:</p>
<div class="highlight-python"><pre>(chroma_env)delta:chroma blyth$ touch src/G4chroma.cc
(chroma_env)delta:chroma blyth$ python setup.py build_ext
running build_ext
building 'chroma.generator._g4chroma' extension
C compiler: /usr/bin/clang -fno-strict-aliasing -fno-common -dynamic -pipe -Os -fwrapv -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes

compile options: '-Isrc -I/usr/local/env/chroma_env/lib/python2.7/site-packages/pyublas/include -I/usr/local/env/chroma_env/include -I/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/include -I/opt/local/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c'
extra options: '-DG4INTY_USE_XT -I/usr/X11R6/include -I/opt/local/include -DG4UI_USE_TCSH -DG4VIS_USE_RAYTRACERX -I/usr/local/env/chroma_env/bin/../include/Geant4'
clang: src/G4chroma.cc
...
/usr/bin/clang++ -bundle -undefined dynamic_lookup -L/opt/local/lib -Wl,-headerpad_max_install_names -L/opt/local/lib/db46 build/temp.macosx-10.9-x86_64-2.7/src/G4chroma.o -lboost_python -o build/lib.macosx-10.9-x86_64-2.7/chroma/generator/_g4chroma.so -L/usr/local/env/chroma_env/bin/../lib -lG4Tree -lG4FR -lG4GMocren -lG4visHepRep -lG4RayTracer -lG4VRML -lG4vis_management -lG4modeling -lG4interfaces -lG4persistency -lG4analysis -lG4error_propagation -lG4readout -lG4physicslists -lG4run -lG4event -lG4tracking -lG4parmodels -lG4processes -lG4digits_hits -lG4track -lG4particles -lG4geometry -lG4materials -lG4graphics_reps -lG4intercoms -lG4global -lG4clhep
(chroma_env)delta:chroma blyth$</pre>
</div>
<p>Find launch fails of g4daeview.py, with indication of looking inside an errant egg:</p>
<div class="highlight-python"><pre> self._gpu_geometry = self.setup_gpu_geometry()
File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/env/geant4/geometry/collada/g4daeview/daechromacontext.py", line 73, in setup_gpu_geometry
  return GPUGeometry( self.chroma_geometry )
File "/usr/local/env/chroma_env/lib/python2.7/site-packages/Chroma-0.5-py2.7-macosx-10.9-x86_64.egg/chroma/gpu/geometry.py", line 25, in __init__
  geometry_source = get_cu_source('geometry_types.h')
File "&lt;string&gt;", line 2, in get_cu_source
File "/usr/local/env/chroma_env/lib/python2.7/site-packages/pytools/__init__.py", line 382, in memoize
  result = func(*args)
File "/usr/local/env/chroma_env/lib/python2.7/site-packages/Chroma-0.5-py2.7-macosx-10.9-x86_64.egg/chroma/gpu/tools.py", line 89, in get_cu_source
  with open('%s/%s' % (srcdir, name)) as f:
IOError: [Errno 2] No such file or directory: '/usr/local/env/chroma_env/lib/python2.7/site-packages/Chroma-0.5-py2.7-macosx-10.9-x86_64.egg/chroma/cuda/geometry_types.h'</pre>
</div>
<div class="highlight-python"><pre>delta:~ blyth$ ll /usr/local/env/chroma_env/lib/python2.7/site-packages/Chroma-0.5-py2.7-macosx-10.9-x86_64.egg/chroma/cuda/
total 16
-rw-r--r--   1 blyth  staff   329 Sep 19 20:27 __init__.pyc
-rw-r--r--   1 blyth  staff    67 Sep 19 20:27 __init__.py
drwxr-xr-x  53 blyth  staff  1802 Sep 19 20:27 ..
drwxr-xr-x   4 blyth  staff   136 Sep 19 20:27 .
delta:~ blyth$ date
Mon Sep 22 16:16:44 CST 2014</pre>
</div>
<p>The below all failed to place the headers in the egg:</p>
<div class="highlight-python"><pre>(chroma_env)delta:chroma blyth$ python setup.py install_headers
(chroma_env)delta:chroma blyth$ python setup.py develop
(chroma_env)delta:chroma blyth$ python setup.py install</pre>
</div>
<p>Recall that <strong>develop</strong> is the chroma setup.py command being used, so there should
be no egg. Removing the egg succeeds to resume operation:</p>
<div class="highlight-python"><pre>delta:site-packages blyth$ cat easy-install.pth
import sys; sys.__plen = len(sys.path)
./unittest2-0.5.1-py2.7.egg
./Sphinx-1.2-py2.7.egg
./spnav-0.9-py2.7.egg
./uncertainties-2.4.4-py2.7.egg
./Jinja2-2.7.2-py2.7.egg
./Pygments-1.6-py2.7.egg
./pycollada-0.4-py2.7.egg
./readline-6.2.4.1-py2.7-macosx-10.9-x86_64.egg
/usr/local/env/chroma_env/src/chroma
import sys; new=sys.path[sys.__plen:]; del sys.path[sys.__plen:]; p=getattr(sys,'__egginsert',0); sys.path[p:p]=new; sys.__egginsert = p+len(new)
delta:site-packages blyth$</pre>
</div>
<p>Probably the <strong>install</strong> command created the egg, but the recommended way is <strong>develop</strong> which plans the path
in the <cite>easy-install.pth</cite>:</p>
<div class="highlight-python"><pre>delta:site-packages blyth$ find /usr/local/env/chroma_env/src/chroma -name geometry_types.h
/usr/local/env/chroma_env/src/chroma/chroma/cuda/geometry_types.h</pre>
</div>
<p>Removing the header from the working copy reproduces the error, so the correct header now
being used. There was some flakiness in this, supect an egg cache may be coming into play.</p>
</div>
<div class="section" id="chroma-deps-pycuda-build-failure">
<h3>chroma-deps pycuda build failure<a class="headerlink" href="#chroma-deps-pycuda-build-failure" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://wiki.tiker.net/PyCuda/Installation/Mac">http://wiki.tiker.net/PyCuda/Installation/Mac</a></li>
</ul>
<p>While doing:</p>
<div class="highlight-python"><pre>pip install -b /usr/local/env/chroma_env/build/build_pycuda pycuda</pre>
</div>
<ol class="arabic">
<li><p class="first">linker errors from missing dir /Developer/NVIDIA/CUDA-5.5/lib64, avoid with ~/.aksetup-defaults.py change</p>
</li>
<li><p class="first">linker errors from missing lib &#8220;-lcuda&#8221;, avoid by changing libdir to /usr/local/cuda/lib</p>
</li>
<li><p class="first">pyublas complains: &#8220;Setuptools conflict detected&#8221;, but it proceeds anyhow</p>
<ul class="simple">
<li><a class="reference external" href="http://wiki.tiker.net/DistributeVsSetuptools">http://wiki.tiker.net/DistributeVsSetuptools</a></li>
</ul>
</li>
<li><p class="first">pip/shrinkwrap/cmake builds dump lots of whitespace, possibly colorful clang warnings, seems
worse with iTerm2.app term setup rather than with Terminal.app</p>
</li>
<li><p class="first">cmake-2.8.11 build issue with cmlibarchive</p>
<ul>
<li><p class="first"><a class="reference external" href="https://github.com/Kitware/CMake/tree/master/Utilities/cmlibarchive">https://github.com/Kitware/CMake/tree/master/Utilities/cmlibarchive</a></p>
</li>
<li><p class="first">try grabbing that externally via macports:</p>
<div class="highlight-python"><pre>sudo port -v install cmake  #</pre>
</div>
</li>
<li><p class="first">macports cmake is ignored, the <a class="reference external" href="http://www.cmake.org/files/v2.8/cmake-2.8.11.tar.gz">http://www.cmake.org/files/v2.8/cmake-2.8.11.tar.gz</a> being attempted to be built again</p>
</li>
<li><p class="first">duplicate shrinkwrap repo on delta using shrinkwrap-dupe
and add new geant4-4.9.5.post2.tar.gz which is same as post1 but
with shrinkwrap_requires=[&#8220;cmake&#8221;] commented and with the new version name</p>
<ul class="simple">
<li>with this succeed to complete geant4 build</li>
</ul>
</li>
<li><p class="first">subsequent root build fails with freetype header missing</p>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="root-5-34-11-freetype-issue">
<h3>root 5.34.11 freetype issue<a class="headerlink" href="#root-5-34-11-freetype-issue" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>In file included from /usr/local/env/chroma_env/src/root-v5.34.11/graf2d/x11ttf/src/TGX11TTF.cxx:28:
In file included from include/TGX11TTF.h:34:
In file included from include/TTF.h:30:
/usr/X11R6/include/ft2build.h:56:10: fatal error: 'freetype/config/ftheader.h' file not found
#include &lt;freetype/config/ftheader.h&gt;</pre>
</div>
<p>Looks like a missing 2:</p>
<div class="highlight-python"><pre>delta:lib blyth$ freetype-config --cflags
-I/opt/local/include/freetype2
delta:lib blyth$ ll /opt/local/include/freetype2/config/ftheader.h
-rw-r--r--  1 root  admin  25587 Dec 22 17:32 /opt/local/include/freetype2/config/ftheader.h</pre>
</div>
<p>The /usr/X11R6/include/ft2build.h header with the wrong path:</p>
<div class="highlight-python"><pre>55   /* `&lt;prefix&gt;/include/freetype2' must be in your current inclusion path */
56 #include &lt;freetype/config/ftheader.h&gt;</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">freetype</span><span class="o">-</span><span class="n">config</span> <span class="o">--</span><span class="n">cflags</span>
<span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">freetype2</span>
</pre></div>
</div>
<p>Perhaps an XQuartz ROOT incompatibility, try kludge:</p>
<div class="highlight-python"><pre>cd /opt/local/include/freetype2 &amp;&amp; sudo ln -s . freetype</pre>
</div>
<p>Makes the header appear at locations expected by both ROOT and Xquartz:</p>
<div class="highlight-python"><pre>(chroma_env)delta:freetype2 blyth$ ls -l /opt/local/include/freetype2/config/ftheader.h /opt/local/include/freetype2/freetype/config/ftheader.h
-rw-r--r--  1 root  admin  25587 Dec 22 17:32 /opt/local/include/freetype2/config/ftheader.h
-rw-r--r--  1 root  admin  25587 Dec 22 17:32 /opt/local/include/freetype2/freetype/config/ftheader.h</pre>
</div>
<ul class="simple">
<li><a class="reference external" href="http://trac.macports.org/ticket/41746">http://trac.macports.org/ticket/41746</a></li>
<li><a class="reference external" href="http://root.cern.ch/phpBB3/viewtopic.php?f=3&amp;t=17190">http://root.cern.ch/phpBB3/viewtopic.php?f=3&amp;t=17190</a></li>
<li><a class="reference external" href="https://xquartz.macosforge.org/trac/wiki/Releases">https://xquartz.macosforge.org/trac/wiki/Releases</a><ul>
<li>promulgates X11 2.7.5 - 2013.11.10 - First release supported on Mavericks</li>
<li>also mentions use of macports xorg-server or xorg-server-devel</li>
<li><a class="reference external" href="https://trac.macports.org/browser/trunk/dports/x11/xorg-server-devel">https://trac.macports.org/browser/trunk/dports/x11/xorg-server-devel</a></li>
<li><a class="reference external" href="https://trac.macports.org/browser/trunk/dports/x11/xorg-server">https://trac.macports.org/browser/trunk/dports/x11/xorg-server</a></li>
</ul>
</li>
<li><a class="reference external" href="http://root.cern.ch/drupal/content/root-version-v5-34-00-patch-release-notes">http://root.cern.ch/drupal/content/root-version-v5-34-00-patch-release-notes</a><ul>
<li>claims v5-34-12 (Nov 19, 2013) completes Mavericks support</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="rerun-root">
<h3>rerun root<a class="headerlink" href="#rerun-root" title="Permalink to this headline">¶</a></h3>
<p>A rerun skips root unless:</p>
<div class="highlight-python"><pre>rm -rf build/build_root</pre>
</div>
<p>Do this with <em>chroma-deps-rebuild root</em></p>
</div>
<div class="section" id="g4py-chroma">
<h3>g4py_chroma<a class="headerlink" href="#g4py-chroma" title="Permalink to this headline">¶</a></h3>
<p>Claims to complete OK but looks like python version mixing between
system and macports python:</p>
<div class="highlight-python"><pre>Checking for system type ... macosx
Checking for prefix ... /usr/local/env/chroma_env
Checking for lib dir ... /usr/local/env/chroma_env/lib/python2.7/site-packages
Checking for G4 include dir ... /usr/local/env/chroma_env/include/Geant4
Checking for G4 lib dir ... /usr/local/env/chroma_env/lib/
Checking for G4 libs are shared libraray ... ok
Checking for Python include dir (pyconfig.h) ... /usr/include/python2.7
Checking for Python lib dir ... /usr/local/env/chroma_env/lib/python2.7/config
Checking for Boost include dir (boost/python.hpp) ... /usr/local/env/chroma_env/include
Checking for Boost version ... ok
Checking for Boost lib dir ... /usr/local/env/chroma_env/lib
Checking for Boost Python lib name ... libboost_python.dylib
Checking for OpenGL support ...no
Checking for GL2PS support ...no
Checking for physics list support ...yes
Checking for GDML support ...no</pre>
</div>
<p>Also some funny warnings:</p>
<div class="highlight-python"><pre>Building a module G4global.so ...
ld: warning: directory not found for option '-L-l'
... intall G4global.so into /usr/local/env/chroma_env/lib/python2.7/site-packages/Geant4</pre>
</div>
</div>
<div class="section" id="pyzmq">
<h3>pyzmq<a class="headerlink" href="#pyzmq" title="Permalink to this headline">¶</a></h3>
<p>Claims to complete OK despite issue with underlying ZMQ which gave fatality:</p>
<div class="highlight-python"><pre>build/temp.macosx-10.9-x86_64-2.7/scratch/vers.c:4:10: fatal error: 'zmq.h' file not found
#include "zmq.h"
         ^
1 error generated.

error: command '/usr/bin/clang' failed with exit status 1

Warning: Failed to build or run libzmq detection test.

If you expected pyzmq to link against an installed libzmq, please check to make sure:

    * You have a C compiler installed
    * A development version of Python is installed (including headers)
    * A development version of ZMQ &gt;= 2.1.4 is installed (including headers)
    * If ZMQ is not in a default location, supply the argument --zmq=&lt;path&gt;
    * If you did recently install ZMQ to a default location,
      try rebuilding the ld cache with `sudo ldconfig`
      or specify zmq's location with `--zmq=/usr/local`

If you expected to get a binary install (egg), we have those for
current Pythons on OS X and Windows. These can be installed with
easy_install, but PIP DOES NOT SUPPORT EGGS.

You can skip all this detection/waiting nonsense if you know
you want pyzmq to bundle libzmq as an extension by passing:

    `--zmq=bundled`

I will now try to build libzmq as a Python extension
unless you interrupt me (^C) in the next 10 seconds...

************************************************
Using bundled libzmq
already have bundled/zeromq
attempting ./configure to generate platform.hpp
Warning: failed to configure libzmq:
/bin/sh: ./configure: No such file or directory</pre>
</div>
<ul class="simple">
<li><a class="reference external" href="https://github.com/zeromq/pyzmq/wiki/Building-and-Installing-PyZMQ">https://github.com/zeromq/pyzmq/wiki/Building-and-Installing-PyZMQ</a></li>
</ul>
</div>
<div class="section" id="zmq">
<h3>ZMQ<a class="headerlink" href="#zmq" title="Permalink to this headline">¶</a></h3>
<p>As now interested in ZMQ from C++ need the zmq.h header, so install
that with <em>zeromq-;zeromq-make</em></p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/zeromq/pyzmq/issues/500">https://github.com/zeromq/pyzmq/issues/500</a></li>
</ul>
</div>
<div class="section" id="markupsafe">
<h3>markupsafe<a class="headerlink" href="#markupsafe" title="Permalink to this headline">¶</a></h3>
<p>pip installing it separately gets around the SandboxViolation when installed
as a dependency of chroma:</p>
<div class="highlight-python"><pre>Installed /usr/local/env/chroma_env/lib/python2.7/site-packages/Pygments-1.6-py2.7.egg
Searching for markupsafe
Reading https://pypi.python.org/simple/markupsafe/
Best match: MarkupSafe 0.18
Downloading https://pypi.python.org/packages/source/M/MarkupSafe/MarkupSafe-0.18.tar.gz#md5=f8d252fd05371e51dec2fe9a36890687
Processing MarkupSafe-0.18.tar.gz
Writing /var/folders/qm/1p5gh0x94l3b0xqc8dpr9yn40000gn/T/easy_install-IYqptm/MarkupSafe-0.18/setup.cfg
Running MarkupSafe-0.18/setup.py -q bdist_egg --dist-dir /var/folders/qm/1p5gh0x94l3b0xqc8dpr9yn40000gn/T/easy_install-IYqptm/MarkupSafe-0.18/egg-dist-tmp-DMeghv
error: Setup script exited with error: SandboxViolation: os.open('/var/folders/qm/1p5gh0x94l3b0xqc8dpr9yn40000gn/T/tmpKdJUob/SDCV5z', 2818, 384) {}

The package setup script has attempted to modify files on your system
that are not within the EasyInstall build area, and has been aborted.

This package cannot be safely installed by EasyInstall, and may not
support alternate installation locations even if you run its setup
script by hand.  Please inform the package's author and the EasyInstall
maintainers to find out if a fix or workaround is available.</pre>
</div>
</div>
<div class="section" id="pip-logs">
<h3>pip logs<a class="headerlink" href="#pip-logs" title="Permalink to this headline">¶</a></h3>
<p>Are overritten at each invokation:</p>
<div class="highlight-python"><pre>mv /Users/blyth/.pip/pip.log ~/chroma_deps.log</pre>
</div>
</div>
<div class="section" id="root-5-34-14">
<h3>root-5.34.14<a class="headerlink" href="#root-5-34-14" title="Permalink to this headline">¶</a></h3>
<p>Bump root to get Mavericks fixes, by adding root-5.34.14.tar.gz
to chroma_pkgs with the only change being the version at the
below three points.:</p>
<div class="highlight-python"><pre>chroma_env)delta:root blyth$ diff -r  root-5.34.11 root-5.34.14
diff -r root-5.34.11/PKG-INFO root-5.34.14/PKG-INFO
3c3
&lt; Version: 5.34.11
---
&gt; Version: 5.34.14
diff -r root-5.34.11/root.egg-info/PKG-INFO root-5.34.14/root.egg-info/PKG-INFO
3c3
&lt; Version: 5.34.11
---
&gt; Version: 5.34.14
diff -r root-5.34.11/setup.py root-5.34.14/setup.py
10c10
&lt; version = '5.34.11'
---
&gt; version = '5.34.14'</pre>
</div>
<div class="highlight-python"><pre>(chroma_env)delta:chroma_env blyth$ chroma-deps-rebuild root -U
=== chroma-deps-env : writing /Users/blyth/.aksetup-defaults.py
Downloading/unpacking root from http://localhost/chroma_pkgs/root/root-5.34.14.tar.gz
  Downloading root-5.34.14.tar.gz
  Running setup.py egg_info for package root

Installing collected packages: root
  Found existing installation: root 5.34.11
    Uninstalling root:
      Successfully uninstalled root
  Running setup.py install for root
    Downloading ftp://root.cern.ch/root/root_v5.34.14.source.tar.gz</pre>
</div>
<div class="section" id="ttf-header-name-clash-between-freetype-and-ftgl">
<h4>TTF : header name clash between freetype and ftgl<a class="headerlink" href="#ttf-header-name-clash-between-freetype-and-ftgl" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><pre>6860
6861     In file included from /usr/local/env/chroma_env/src/root-v5.34.14/graf2d/graf/src/TMathText.cxx:15:
6862
6863     include/TTF.h:51:4: error: unknown type name 'FT_Glyph'; did you mean 'FTGlyph'?
6864
6865        FT_Glyph   fImage; // glyph image
6866
6867        ^~~~~~~~
6868
6869        FTGlyph
6870
6871     include/ftglyph.h:25:19: note: 'FTGlyph' declared here
6872
6873     class FTGL_EXPORT FTGlyph
6874</pre>
</div>
<ul class="simple">
<li><a class="reference external" href="http://trac.macports.org/ticket/41572">http://trac.macports.org/ticket/41572</a></li>
<li><a class="reference external" href="https://github.com/root-mirror/root/commit/446a11828dcf577efd15d9057703c5bd099dd148">https://github.com/root-mirror/root/commit/446a11828dcf577efd15d9057703c5bd099dd148</a></li>
<li><a class="reference external" href="https://sft.its.cern.ch/jira/browse/ROOT-5773">https://sft.its.cern.ch/jira/browse/ROOT-5773</a></li>
<li><a class="reference external" href="http://root.cern.ch/phpBB3/viewtopic.php?f=3&amp;t=17485">http://root.cern.ch/phpBB3/viewtopic.php?f=3&amp;t=17485</a></li>
</ul>
</div>
<div class="section" id="rebuild-pycuda-with-opengl-capability">
<h4>rebuild pycuda with opengl capability<a class="headerlink" href="#rebuild-pycuda-with-opengl-capability" title="Permalink to this headline">¶</a></h4>
<p>Trying to run PyCUDA OpenGL interop example</p>
<ul class="simple">
<li><a class="reference external" href="http://andreask.cs.illinois.edu/PyCuda/Examples/GlInterop">http://andreask.cs.illinois.edu/PyCuda/Examples/GlInterop</a></li>
</ul>
<p>Gives:</p>
<div class="highlight-python"><pre>(chroma_env)delta:pycuda_pyopengl_interop blyth$ python interop.py
...
import pycuda.gl as cuda_gl
File "/usr/local/env/chroma_env/lib/python2.7/site-packages/pycuda/gl/__init__.py", line 4, in &lt;module&gt;
raise ImportError("PyCUDA was compiled without GL extension support")</pre>
</div>
<ol class="arabic">
<li><p class="first">add flag to chroma-pycuda-aksetup- and regenerate:</p>
<div class="highlight-python"><pre>(chroma_env)delta:pycuda_pyopengl_interop blyth$ chroma-pycuda-aksetup
writing /Users/blyth/.aksetup-defaults.py</pre>
</div>
</li>
</ol>
<div class="highlight-python"><pre>pip uninstall pycuda
chroma-deps-rebuild pycuda</pre>
</div>
</div>
</div>
</div>
<div class="section" id="chroma-install">
<h2>Chroma Install<a class="headerlink" href="#chroma-install" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://chroma.bitbucket.org/install/overview.html#common-install">http://chroma.bitbucket.org/install/overview.html#common-install</a></li>
</ul>
<p>Suggestion is:</p>
<div class="highlight-python"><pre>cd $VIRTUAL_ENV/src
hg clone https://bitbucket.org/chroma/chroma
cd chroma
python setup.py develop</pre>
</div>
</div>
<div class="section" id="chroma-install-rerun-from-my-bitbucket-fork">
<h2>Chroma Install Rerun from my bitbucket fork<a class="headerlink" href="#chroma-install-rerun-from-my-bitbucket-fork" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>cd $VIRTUAL_ENV/src
hg clone ssh://hg@bitbucket.org/scb-/chroma
cd chroma
# python setup.py develop   ## uninstall first ?</pre>
</div>
<div class="highlight-python"><pre>(chroma_env)delta:~ blyth$ chroma-
(chroma_env)delta:~ blyth$ chroma-cd src/chroma
(chroma_env)delta:chroma blyth$ pwd
/usr/local/env/chroma_env/src/chroma

(chroma_env)delta:chroma blyth$ python setup.py --help

  ## no uninstall command, the "develop" command just plants an egg-link anyhow

(chroma_env)delta:chroma blyth$ cat ../../lib/python2.7/site-packages/Chroma.egg-link
/usr/local/env/chroma_env/src/chroma

.(chroma_env)delta:chroma blyth$ cat ../../lib/python2.7/site-packages/easy-install.pth
import sys; sys.__plen = len(sys.path)
/usr/local/env/chroma_env/src/chroma
./unittest2-0.5.1-py2.7.egg
./Sphinx-1.2-py2.7.egg
./spnav-0.9-py2.7.egg
./uncertainties-2.4.4-py2.7.egg
./Jinja2-2.7.2-py2.7.egg
./Pygments-1.6-py2.7.egg
/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages
./pycollada-0.4-py2.7.egg
./readline-6.2.4.1-py2.7-macosx-10.9-x86_64.egg
import sys; new=sys.path[sys.__plen:]; del sys.path[sys.__plen:]; p=getattr(sys,'__egginsert',0); sys.path[p:p]=new; sys.__egginsert = p+len(new)
(chroma_env)delta:chroma blyth$</pre>
</div>
<p>Plow ahead with the <cite>develop</cite> ontop of existing install:</p>
<div class="highlight-python"><pre>(chroma_env)delta:chroma blyth$ python setup.py develop
running develop
running egg_info
creating Chroma.egg-info
writing requirements to Chroma.egg-info/requires.txt
writing Chroma.egg-info/PKG-INFO
...
Using /usr/local/env/chroma_env/lib/python2.7/site-packages
Finished processing dependencies for Chroma==0.5</pre>
</div>
</div>
<div class="section" id="moved-retainable-chroma-mods-into-bitbucket-fork">
<h2>Moved retainable chroma mods into bitbucket fork<a class="headerlink" href="#moved-retainable-chroma-mods-into-bitbucket-fork" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>only significant mods canned were to camera.py
as the over complicated nature of that makes it
not a good place for development without a major re-write</li>
</ul>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../how_chroma_works/" title="How Chroma Works ?"
             >next</a> |</li>
        <li class="right" >
          <a href="../chroma_issues/" title="Chroma Issues"
             >previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../">Env  documentation</a> &raquo;</li>

          <li><a href="../" >chroma</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>