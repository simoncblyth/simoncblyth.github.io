<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DetSim Configuration &mdash; Env  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/highstock/highstock.js"></script>
    <script type="text/javascript" src="../../../_static/highstock/modules/exporting.js"></script>
    <link rel="top" title="Env  documentation" href="../../../" />
    <link rel="up" title="detsim" href="../" />
    <link rel="next" title="NuWa DetSim DsOpStackAction" href="../detsim_dsopstackaction/" />
    <link rel="prev" title="detsim" href="../" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../detsim_dsopstackaction/" title="NuWa DetSim DsOpStackAction"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="detsim"
             accesskey="P">previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >nuwa</a> &raquo;</li>
          <li><a href="../" accesskey="U">detsim</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> edocs </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">hdocs</a>   </li>
        <li><a href="/e/scm/monitor/" > backup status </a> </li>
</ul>

<h3>Content Skeleton</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing <strong>env</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../base/">Base Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../log/May2012/">LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sysadmin/">Sys Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot/">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scm/">SCM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trac/">Trac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../root/">ROOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sphinxext/">Sphinx Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../matplotlib/">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nose/">nose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../svn/">SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../npy/">Numerical Python, numpy et al</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pypy/">PyPy : faster python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysqlhotcopy/">MySQL hotcopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysql/">MySQL Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sqlite/">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../db/">DB scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fossil/">Fossil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../java/">Java Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pycuda/">pycuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../geant4/">geant4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../muon_simulation/">muon_simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../chroma/">chroma</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../llvm/">llvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../graphics/">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda/">cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../opencl/">opencl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../linux/">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package_management/">Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ui/">ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/">debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mercurial/">mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../javascript/">javascript</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">nuwa</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../dybinst_mavericks/">NuWa on Mavericks</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">detsim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nuwa_cmt_debugging/">NuWa CMT Debugging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ccgpu/">ccgpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pygame/">pygame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zeromq/">zeromq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/">doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../osx/">osx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hg/">hg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../simoncblyth.bitbucket.org/">simoncblyth.bitbucket.org</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/nuwa/detsim/detsim_configuration.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../"
                        title="previous chapter">detsim</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../detsim_dsopstackaction/"
                        title="next chapter">NuWa DetSim DsOpStackAction</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="detsim-configuration">
<h1>DetSim Configuration<a class="headerlink" href="#detsim-configuration" title="Permalink to this headline">¶</a></h1>
<p>On this page:</p>
<ul class="simple">
<li>trace physlist hookup from python DetSim config level via GaussTools and GiGa
to underlying Geant4</li>
<li>GiGa Gauss Geant4 hookup, orchestrated from python level</li>
<li>NB <strong>GiGaPhysListModular</strong> comes from GaussTools not GiGa</li>
<li>giga phys list</li>
<li>giga geometry control</li>
</ul>
<p><cite>NuWa-trunk/dybgaudi/Simulation/DetSim/python/DetSim/Default.py</cite>:</p>
<div class="highlight-python"><pre>01 #!/usr/bin/env python
02
03 # Available physics lists
04 physics_list_basic = [
05     "DsPhysConsGeneral",
06     "DsPhysConsOptical",
07     "DsPhysConsEM",
08     ]
09 physics_list_nuclear = [
10     "DsPhysConsElectroNu",
11     "DsPhysConsHadron",
12     "DsPhysConsIon",
13     ]
..
16 class Configure:
17     '''
18     Do default DetSim configuration.
19     '''
20
21     # Available geometry broken up by site
..
29     giga_dayabay_items = [
30         "/dd/Structure/Sites/db-rock",
31         "/dd/Geometry/AdDetails/AdSurfacesAll",
32         "/dd/Geometry/AdDetails/AdSurfacesNear",
33         "/dd/Geometry/PoolDetails/NearPoolSurfaces",
34         "/dd/Geometry/PoolDetails/PoolSurfacesAll",
35         ]
..
44     def __init__(self,site="far,dayabay,lingao",
45                  physlist = physics_list_basic+physics_list_nuclear,
46                  use_push_algs = True,
47                  use_sim_subseq=False ):
48         '''
49         Configure DetSim.
50
51         "site" can be "far", "dayabay" or "lingao".  Default is all three
52
53         "physlist" specifies the physics lists.  You can use the
54         predefined lists in DetSim.configure.: physics_list_basic and
55         physics_list_nuclear.  Default is to use both.
56
57         After creating this object you may want to call historian() or
58         unobserver() to add to their configuration.
59
60         '''
61
62         from GaussTools.GaussToolsConf import GiGaPhysListModular
63         import GaudiKernel.SystemOfUnits as units
64
65         # Note: we must name this with "GiGa." as it is assumed later when the
66         # properties are looked up.  Really the action of giving it to GiGa
67         # should take care of this.  More bugs in Configurables
68         physics_list = GiGaPhysListModular("GiGa.GiGaPhysListModular")
69         physics_list.CutForElectron = 100*units.micrometer
70         physics_list.CutForPositron = 100*units.micrometer
71         physics_list.CutForGamma = 1*units.millimeter
/////////////////////////////////////////////////////////////////////////
72         physics_list.PhysicsConstructors = physlist
/////////////////////////////////////////////////////////////////////////
73         self.physics_list = physics_list
74
75         from GiGa.GiGaConf import GiGa
76         giga = GiGa()
77         giga.PhysicsList = physics_list

66 def configure(argv=None):
67     try:
68         style = argv[0]
69     except IndexError:
70         Configure()
71         return
72
73     if style == 'basic':
74         Configure(physlist = physics_list_basic)
75         return
76
77     Configure()
78     return</pre>
</div>
<p><cite>NuWa-trunk/lhcb/Sim/GaussTools/src/Components/GiGaPhysListModular.h</cite>:</p>
<div class="highlight-python"><pre>18 class GiGaPhysListModular : public GiGaPhysListBase,
19                             public virtual G4VModularPhysicsList
20 {</pre>
</div>
<p><cite>NuWa-trunk/lhcb/Sim/GaussTools/src/Components/GiGaPhysListModular.cpp</cite>:</p>
<div class="highlight-python"><pre>47 GiGaPhysListModular::GiGaPhysListModular
48 ( const std::string&amp; type   ,
49   const std::string&amp; name   ,
50   const IInterface*  parent )
51   : G4VModularPhysicsList(),
52     GiGaPhysListBase( type , name , parent ),
53     m_dumpCutsTable(false)
54 {
55   declareProperty( "PhysicsConstructors"  , m_physconstr);
56   declareProperty( "DumpCutsTable", m_dumpCutsTable);
57 };
..
70 StatusCode GiGaPhysListModular::initialize()
71 {
72   StatusCode sc=GiGaPhysListBase::initialize ();
..
81   for ( std::vector&lt;std::string&gt;::iterator constructor = m_physconstr.begin() ;
82         m_physconstr.end() != constructor ; ++constructor )
83   {
84     IGiGaPhysicsConstructor* theconstr =
85       tool&lt;IGiGaPhysicsConstructor&gt;( *constructor , this ) ;
86     if( 0 == theconstr ) { return StatusCode::FAILURE ; }
87
88     // NB!!! prevent the deletion of contructors by Gaudi
89     //for( int i = 1 ; i &lt; 1000 ; ++i )
90     //{ theconstr-&gt;addRef() ; }
91
92     if( 0 == theconstr -&gt; physicsConstructor() )
93     { return Error ( "G4PhysicsConstructor* points to NULL!" ) ; }
94
//
// promotion of a string name like "DsPhysConsOptical" into a G4VPhysicsConstructor* instance
//
95     m_constructors.push_back( theconstr );
96
97     // register
98     RegisterPhysics( theconstr -&gt; physicsConstructor() ) ;
99
00     // Print name of physics constructors registered
01     info() &lt;&lt; "Registered " &lt;&lt; theconstr-&gt;name() &lt;&lt; endmsg;
02
03   }
04
05   return StatusCode::SUCCESS;</pre>
</div>
<p><cite>geant4.10.00.p01/source/run/include/G4VModularPhysicsList.hh</cite>:</p>
<div class="highlight-python"><pre>090 class G4VModularPhysicsList: public virtual G4VUserPhysicsList
091 {
...
101   public:  // with description
102     // This method will be invoked in the Construct() method.
103     // each particle type will be instantiated
104     virtual void ConstructParticle();
105
106     // This method will be invoked in the Construct() method.
107     // each physics process will be instantiated and
108     // registered to the process manager of each particle type
109     virtual void ConstructProcess();
110
111   public: // with description
112     // Register Physics Constructor
113     void RegisterPhysics(G4VPhysicsConstructor* );</pre>
</div>
<p><cite>geant4.10.00.p01/source/run/src/G4VModularPhysicsList.cc</cite>:</p>
<div class="highlight-python"><pre>131 void G4VModularPhysicsList::ConstructProcess()
132 {
133     G4AutoLock l(&amp;constructProcessMutex); //Protection to be removed (A.Dotti)
134  AddTransportation();
135
136  G4PhysConstVector::iterator itr;
137  for (itr = G4MT_physicsVector-&gt;begin(); itr!= G4MT_physicsVector-&gt;end(); ++itr) {
138     (*itr)-&gt;ConstructProcess();
139  }
140 }
...
144 void G4VModularPhysicsList::RegisterPhysics(G4VPhysicsConstructor* fPhysics)
145 {
...
155   G4String pName = fPhysics-&gt;GetPhysicsName();
156   G4int pType = fPhysics-&gt;GetPhysicsType();
157   // If physics_type is equal to 0,
158   // following duplication check is omitted
159   // This is TEMPORAL treatment.
160   if (pType == 0) {
161     G4MT_physicsVector-&gt;push_back(fPhysics);
...
170     return;
171   }
172
173   // Check if physics with the physics_type same as one of given physics
174   G4PhysConstVector::iterator itr;
175   for (itr = G4MT_physicsVector-&gt;begin(); itr!= G4MT_physicsVector-&gt;end(); ++itr) {
176     if ( pType == (*itr)-&gt;GetPhysicsType()) break;
177   }
...
197   // register
198   G4MT_physicsVector-&gt;push_back(fPhysics);
199
200 }</pre>
</div>
<p><cite>geant4.10.00.p01/source/run/include/G4VUserPhysicsList.hh</cite>:</p>
<div class="highlight-python"><pre>159 class G4VUserPhysicsList
160 {
...
169   public:  // with description
170    // Each particle type will be instantiated
171    // This method is invoked by the RunManger
172    virtual void ConstructParticle() = 0;
173
174    // By calling the "Construct" method,
175    // process manager and processes are created.
176    void Construct();
177
178    // Each physics process will be instantiated and
179    // registered to the process manager of each particle type
180    // This method is invoked in Construct method
181    virtual void ConstructProcess() = 0;
182
183   protected: // with description
184    //  User must invoke this method in his ConstructProcess()
185    //  implementation in order to insures particle transportation.
186    void AddTransportation();
187
188    //Register a process to the particle type
189    // according to the ordering parameter table
190    //  'true' is returned if the process is registerd successfully
191    G4bool RegisterProcess(G4VProcess*            process,
192               G4ParticleDefinition*  particle);</pre>
</div>
<p><cite>geant4.10.00.p01/source/run/src/G4VUserPhysicsList.cc</cite>:</p>
<div class="highlight-python"><pre>103 class G4VUPLData
104 {
105     //Encapsulate the fields of class G4VUserPhysicsList
106     //that are per-thread.
107 public:
108     void initialize();
109     G4ParticleTable::G4PTblDicIterator* _theParticleIterator;
110     G4UserPhysicsListMessenger* _theMessenger;
111     G4PhysicsListHelper* _thePLHelper;
112     G4bool _fIsPhysicsTableBuilt;
113     G4int _fDisplayThreshold;
114 };
...
155 #define G4MT_thePLHelper ((this-&gt;subInstanceManager.offset[this-&gt;g4vuplInstanceID])._thePLHelper)
...
946 ////////////////////////////////////////////////////////
947 void G4VUserPhysicsList::AddTransportation()
948 {
949   G4MT_thePLHelper-&gt;AddTransportation();
950 }</pre>
</div>
<p><cite>geant4.10.00.p01/source/run/src/G4PhysicsListHelper.cc</cite>:</p>
<div class="highlight-python"><pre>207 void G4PhysicsListHelper::AddTransportation()
208 {
...
220   if ( nParaWorld&gt;0 ||
221        useCoupledTransportation ||
222        G4ScoringManager::GetScoringManagerIfExist()) {
...
230     theTransportationProcess = new G4CoupledTransportation(verboseLevelTransport);
231   } else {
232     theTransportationProcess = new G4Transportation(verboseLevelTransport);
233   }
...
235   // loop over all particles in G4ParticleTable
236   aParticleIterator-&gt;reset();
237   while( (*aParticleIterator)() ){
238     G4ParticleDefinition* particle = aParticleIterator-&gt;value();
239     G4ProcessManager* pmanager = particle-&gt;GetProcessManager();
...
258     // add transportation with ordering = ( -1, "first", "first" )
259     pmanager -&gt;AddProcess(theTransportationProcess);
260     pmanager -&gt;SetProcessOrderingToFirst(theTransportationProcess, idxAlongStep);
261     pmanager -&gt;SetProcessOrderingToFirst(theTransportationProcess, idxPostStep);
262   }
263 }</pre>
</div>
<ul class="simple">
<li>Huh, I though Transportation needed to be last ?</li>
</ul>
<div class="section" id="about-process-ordering">
<h2>About Process Ordering<a class="headerlink" href="#about-process-ordering" title="Permalink to this headline">¶</a></h2>
<div class="section" id="source-one">
<h3>source one<a class="headerlink" href="#source-one" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://www-geant4.kek.jp/g4users/tutorial03/material/4-1.pdf">http://www-geant4.kek.jp/g4users/tutorial03/material/4-1.pdf</a></li>
</ul>
<p>Assuming n processes, the ordering of the AlongGetPhysicalInteractionLength
of the last processes should be:</p>
<div class="highlight-python"><pre>n-2
n-1  Multiple Scattering
n    Transportation</pre>
</div>
<ol class="arabic simple">
<li>Processes return a true path length</li>
<li>Multiple Scattering effectively folds up the true path into a shorter
geometrical path length</li>
<li>Transportation can limit the step based on the shorter geometrical path length</li>
</ol>
</div>
<div class="section" id="source-two">
<h3>source two<a class="headerlink" href="#source-two" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://indico.cern.ch/event/58317/session/12/contribution/6/material/slides/0.pdf">https://indico.cern.ch/event/58317/session/12/contribution/6/material/slides/0.pdf</a></li>
</ul>
<p>Check the physics processes attached and their ordering:</p>
<div class="highlight-python"><pre>/particle/select e-
/particle/processes/dump</pre>
</div>
<p>G4ProcessManager maintains three vectors of actions :</p>
<ol class="arabic simple">
<li><strong>AtRest</strong><ul>
<li><cite>AtRestGetPhysicalInteractionLength()</cite>  Returns a time, not a length</li>
<li><cite>AtRestDoIt()</cite>  process with smallest time DoIt is done</li>
</ul>
</li>
<li><strong>AlongStep</strong> (process ordering important for this, multiple scattering before transportation)<ul>
<li><cite>AlongStepGetPhysicalInteractionLength()</cite></li>
<li><cite>AlongStepDoIt()</cite></li>
</ul>
</li>
<li><strong>PostStep</strong><ul>
<li><cite>PostStepGetPhysicalInteractionLength()</cite></li>
<li><cite>PostStepDoIt()</cite></li>
</ul>
</li>
</ol>
<ul class="simple">
<li><a class="reference external" href="http://geant4.web.cern.ch/geant4/collaboration/workshops/users2002/talks/lectures/PhysicsProcessesInGeneral.pdf">http://geant4.web.cern.ch/geant4/collaboration/workshops/users2002/talks/lectures/PhysicsProcessesInGeneral.pdf</a></li>
</ul>
</div>
</div>
<div class="section" id="processmanager">
<h2>ProcessManager<a class="headerlink" href="#processmanager" title="Permalink to this headline">¶</a></h2>
<p><cite>geant4.10.00.p01/source/processes/management/include/G4ProcessManager.hh</cite>:</p>
<div class="highlight-python"><pre>83 //  Indexes for ProcessVector
84 enum G4ProcessVectorTypeIndex
85 {
86     typeGPIL = 0,   // for GetPhysicalInteractionLength
87     typeDoIt =1     // for DoIt
88 };
89 enum G4ProcessVectorDoItIndex
90 {
91     idxAll = -1,        // for all DoIt/GPIL
92     idxAtRest = 0,      // for AtRestDoIt/GPIL
93     idxAlongStep = 1,   // for AlongStepDoIt/GPIL
94     idxPostStep =2,     // for AlongSTepDoIt/GPIL
95     NDoit =3
96 };
97
98 //  enumeration for Ordering Parameter
99 enum G4ProcessVectorOrdering
00 {
01     ordInActive = -1,   // ordering parameter to indicate InActive DoIt
02     ordDefault = 1000,  // default ordering parameter
03     ordLast    = 9999   // ordering parameter to indicate the last DoIt
04 };
..
86       G4int AddProcess(
87              G4VProcess *aProcess,
88              G4int      ordAtRestDoIt = ordInActive,
89              G4int      ordAlongSteptDoIt = ordInActive,
90              G4int      ordPostStepDoIt = ordInActive
91             );
92       //  Add a process to the process List
93       //  return values are index to the List. Negative return value
94       //  indicates that the process has not be added due to some errors
95       //  The first argument is a pointer to process.
96       //  Following arguments are ordering parameters of the process in
97       //  process vectors. If value is negative, the process is
98       //  not added to the corresponding process vector.
99
00       //  following methods are provided for simple processes
01       //   AtRestProcess has only AtRestDoIt
02       //   ContinuousProcess has only AlongStepDoIt
03       //   DiscreteProcess has only PostStepDoIt
04       //  If the ording parameter is not specified, the process is
05       //  added at the end of List of process vectors
06       //  If a process with same ordering parameter exists,
07       //   this new process will be added just after processes
08       //   with same ordering parameter
09       //  (except for processes assigned to LAST explicitly )
10       //  for both DoIt and GetPhysicalInteractionLength</pre>
</div>
<div class="highlight-python"><pre>223       G4int GetProcessOrdering(
224                    G4VProcess *aProcess,
225                    G4ProcessVectorDoItIndex idDoIt
226                                );
227
228       void SetProcessOrdering(
229                    G4VProcess *aProcess,
230                    G4ProcessVectorDoItIndex idDoIt,
231                    G4int      ordDoIt = ordDefault
232                                );
233       // Set ordering parameter for DoIt specified by typeDoIt.
234       // If a process with same ordering parameter exists,
235       // this new process will be added just after processes
236       // with same ordering parameter
237       // Note: Ordering parameter will bet set to non-zero
238       //       even if you set  ordDoIt = 0
239
240      void SetProcessOrderingToFirst(
241                    G4VProcess *aProcess,
242                    G4ProcessVectorDoItIndex idDoIt
243                    );
244       // Set ordering parameter to the first of all processes
245       // for DoIt specified by idDoIt.
246       //  Note: If you use this method for two processes,
247       //        a process called later will be first.
248
249       void SetProcessOrderingToSecond(
250                    G4VProcess *aProcess,
251                    G4ProcessVectorDoItIndex idDoIt
252                    );
253       // Set ordering parameter to 1 for DoIt specified by idDoIt
254       // and the rpocess will be added just after
255       // the processes with ordering parameter equal to zero
256       //  Note: If you use this method for two processes,
257       //        a process called later will be .</pre>
</div>
<div class="section" id="reversal-between-doit-methods-and-getphysicalinteractionlength">
<h3>Reversal between <cite>DoIt()</cite> methods and <cite>GetPhysicalInteractionLength()</cite><a class="headerlink" href="#reversal-between-doit-methods-and-getphysicalinteractionlength" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>does this explain the below, as the <strong>First</strong> refers to the DoIt
methods (transportation could limit the step)
BUT the distances need to be calculated in
reverse so the multiple scattering fold up can happen ?</li>
</ul>
<div class="highlight-python"><pre>//  add transportation with ordering = ( -1, "first", "first" )
pmanager-&gt;AddProcess(theTransportationProcess);
pmanager-&gt;SetProcessOrderingToFirst(theTransportationProcess, idxAlongStep)
pmanager-&gt;SetProcessOrderingToFirst(theTransportationProcess, idxPostStep);</pre>
</div>
<ul class="simple">
<li><a class="reference external" href="http://geant4.web.cern.ch/geant4/UserDocumentation/UsersGuides/ForApplicationDeveloper/html/ch05s02.html">http://geant4.web.cern.ch/geant4/UserDocumentation/UsersGuides/ForApplicationDeveloper/html/ch05s02.html</a></li>
</ul>
<p>Each process has two groups of methods which play an important role in
tracking, GetPhysicalInteractionLength (GPIL) and DoIt. The GPIL method gives
the step length from the current space-time point to the next space-time point.
It does this by calculating the probability of interaction based on the
process&#8217;s cross section information. At the end of this step the DoIt method
should be invoked. The DoIt method implements the details of the interaction,
changing the particle&#8217;s energy, momentum, direction and position, and producing
secondary tracks if required. These changes are recorded as G4VParticleChange
objects(see Particle Change).</p>
</div>
</div>
<div class="section" id="aleniatutorial">
<h2>aleniaTutorial<a class="headerlink" href="#aleniatutorial" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../detsim_dsopstackaction/" title="NuWa DetSim DsOpStackAction"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="detsim"
             >previous</a> |</li>
    <li><a href="/tracs/env/timeline">env</a> &raquo;</li>
    
        <li><a href="../../../">Env  documentation</a> &raquo;</li>

          <li><a href="../../" >nuwa</a> &raquo;</li>
          <li><a href="../" >detsim</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>