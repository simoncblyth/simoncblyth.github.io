<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Opticks &mdash; Opticks 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Opticks 0.0.1 documentation" href="index.html" />
    <link rel="prev" title="Opticks" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="Opticks"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Opticks 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Opticks</a><ul>
<li><a class="reference internal" href="#get-opticks">Get Opticks</a></li>
<li><a class="reference internal" href="#build-tools">Build Tools</a></li>
<li><a class="reference internal" href="#cmake">CMake</a></li>
<li><a class="reference internal" href="#full-building-example">Full Building Example</a></li>
<li><a class="reference internal" href="#externals">Externals</a><ul>
<li><a class="reference internal" href="#geometry-opengl-related">Geometry/OpenGL related</a></li>
<li><a class="reference internal" href="#boost-infrastructure-libraries">Boost Infrastructure Libraries</a></li>
<li><a class="reference internal" href="#updating-boost">Updating Boost</a></li>
<li><a class="reference internal" href="#cuda-related">CUDA related</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-and-building-opticks">Configuring and Building Opticks</a></li>
<li><a class="reference internal" href="#configuration-machinery">Configuration Machinery</a></li>
<li><a class="reference internal" href="#building-opticks">Building Opticks</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Opticks</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/opticks.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="opticks">
<h1>Opticks<a class="headerlink" href="#opticks" title="Permalink to this headline">¶</a></h1>
<div class="section" id="get-opticks">
<h2>Get Opticks<a class="headerlink" href="#get-opticks" title="Permalink to this headline">¶</a></h2>
<p>Clone the repository from bitbucket:</p>
<div class="highlight-python"><pre>cd
hg clone http://bitbucket.org/simoncblyth/env</pre>
</div>
<p>In future Opticks is intended to move, then you will need to:</p>
<div class="highlight-python"><pre>hg clone http://bitbucket.org/simoncblyth/opticks</pre>
</div>
<p>Connect the opticks bash functions to your shell by adding a line to your .bash_profile:</p>
<div class="highlight-python"><pre>opticks-(){ . $HOME/opticks/opticks.bash &amp;&amp; opticks-env $* ; }</pre>
</div>
<p>This defines the bash function <em>opticks-</em> that is termed a precursor function
as running it will define other functions all starting with <em>opticks-</em> such as <em>opticks-vi</em>
and <em>opticks-usage</em>.</p>
</div>
<div class="section" id="build-tools">
<h2>Build Tools<a class="headerlink" href="#build-tools" title="Permalink to this headline">¶</a></h2>
<p>Getting, configuring, unpacking, building and installing Opticks and
its externals requires unix tools including:</p>
<ul class="simple">
<li>bash shell</li>
<li>mercurial hg</li>
<li>git</li>
<li>curl</li>
<li>tar</li>
<li>zip</li>
<li>cmake 2.8.9+</li>
</ul>
</div>
<div class="section" id="cmake">
<h2>CMake<a class="headerlink" href="#cmake" title="Permalink to this headline">¶</a></h2>
<p>A rather recent cmake version is required. Check your version with:</p>
<div class="highlight-python"><pre>simon:~ blyth$ cmake --version
cmake version 3.4.1</pre>
</div>
<p>Updating build tools is best done via your system package manager.
For example on OSX with macports update cmake with:</p>
<div class="highlight-python"><pre>port info cmake           # check the version the package manager proposes
sudo port install cmake   # do the install</pre>
</div>
<p>If you or your system administrator are unable to update a tool via the system
package manager then a local install of the tool must be done and your
login shell PATH modified to use the updated tool. The Opticks repository
includes bash functions for local installs of cmake with
precursor function <em>cmake-</em>.</p>
</div>
<div class="section" id="full-building-example">
<h2>Full Building Example<a class="headerlink" href="#full-building-example" title="Permalink to this headline">¶</a></h2>
<p>Assuming appropriate build tools and Boost, CUDA (includes Thrust) and OptiX
are already installed the getting, building and installation of the other externals
takes less then 10 minutes and the Opticks build takes less than 5 minutes.:</p>
<div class="highlight-python"><pre>simon:env blyth$ opticks-fullclean | sh
simon:env blyth$ opticks- ; opticks-full
=== opticks-- : START Tue Apr 26 15:33:27 CST 2016
=== opticks-externals-install : START Tue Apr 26 15:33:27 CST 2016
...
=== opticks-externals-install : DONE Tue Apr 26 15:41:22 CST 2016
...
=== opticks-- : DONE Tue Apr 26 15:45:59 CST 2016</pre>
</div>
</div>
<div class="section" id="externals">
<h2>Externals<a class="headerlink" href="#externals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="geometry-opengl-related">
<h3>Geometry/OpenGL related<a class="headerlink" href="#geometry-opengl-related" title="Permalink to this headline">¶</a></h3>
<p>Use the bash function <em>opticks-externals-install</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">opticks</span><span class="o">-</span><span class="n">externals</span><span class="o">-</span><span class="n">install</span>
</pre></div>
</div>
<p>This gets the repositories or tarballs and perform the builds and installation.
Tools like hg, git, curl, tar, zip are assumed to be in your PATH.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="9%" />
<col width="8%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">directory</th>
<th class="head">precursor</th>
<th class="head">pkg name</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>graphics/glm</td>
<td>glm-</td>
<td>GLM</td>
<td>sourceforge tarball 0.9.6.3, header only</td>
</tr>
<tr class="row-odd"><td>graphics/assimp</td>
<td>assimp-</td>
<td>Assimp</td>
<td>github.com/simoncblyth/assimp fork of unspecified github version that handles G4DAE extras, cmake configured</td>
</tr>
<tr class="row-even"><td>graphics/openmesh</td>
<td>openmesh-</td>
<td>OpenMesh</td>
<td>www.openmesh.org OpenMesh 4.1 tarball, cmake configured, provides VS2015 binaries <a class="reference external" href="http://www.openmesh.org/download/">http://www.openmesh.org/download/</a></td>
</tr>
<tr class="row-odd"><td>graphics/glew</td>
<td>glew-</td>
<td>GLEW</td>
<td>sourceforge tarball 1.12.0, OpenGL extensions loading library, cmake build didnt work, includes vc12 sln for windows</td>
</tr>
<tr class="row-even"><td>graphics/glfw</td>
<td>glfw-</td>
<td>GLFW</td>
<td>sourceforge tarball 3.1.1, library for creating windows with OpenGL and receiving input, cmake generation</td>
</tr>
<tr class="row-odd"><td>graphics/gleq</td>
<td>gleq-</td>
<td>GLEQ</td>
<td>github.com/simoncblyth/gleq : GLFW author event handling example, header only</td>
</tr>
<tr class="row-even"><td>graphics/gui/imgui</td>
<td>imgui-</td>
<td>&nbsp;</td>
<td>github.com/simoncblyth/imgui expected to drop source into using project, simple CMakeLists.txt added by me</td>
</tr>
</tbody>
</table>
<p>Dependencies of externals:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="32%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">pkg</th>
<th class="head">depends on</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>glm</td>
<td>&nbsp;</td>
<td>headers only</td>
</tr>
<tr class="row-odd"><td>gleq</td>
<td>&nbsp;</td>
<td>headers only</td>
</tr>
<tr class="row-even"><td>glew</td>
<td>system opengl</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>glfw</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>imgui</td>
<td>glfw glew</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="boost-infrastructure-libraries">
<h3>Boost Infrastructure Libraries<a class="headerlink" href="#boost-infrastructure-libraries" title="Permalink to this headline">¶</a></h3>
<p>The pre-requisite Boost components listed in the table need to be installed.
These are widely available via package managers. Use the standard one for
your system:</p>
<ul class="simple">
<li>yum on Redhat</li>
<li>macports on Mac</li>
<li>nsys2 on Windows.</li>
</ul>
<p>The FindBoost.cmake provided with cmake is used to locate the installation.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="12%" />
<col width="10%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">directory</th>
<th class="head">precursor</th>
<th class="head">pkg name</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>boost</td>
<td>boost-</td>
<td>Boost</td>
<td>components: system thread program_options log log_setup filesystem regex</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="updating-boost">
<h3>Updating Boost<a class="headerlink" href="#updating-boost" title="Permalink to this headline">¶</a></h3>
<p>If your version of Boost is not recent enough the cmake configuring
step will yield errors like the below.:</p>
<div class="highlight-python"><pre>CMake Error at /home/blyth/local/env/tools/cmake/cmake-3.5.2-Linux-x86_64/share/cmake-3.5/Modules/FindBoost.cmake:1657 (message):
Unable to find the requested Boost libraries.

Boost version: 1.41.0

Boost include path: /usr/include

Could not find the following Boost libraries:

        boost_log
        boost_log_setup

Some (but not all) of the required Boost libraries were found.  You may
need to install these additional Boost libraries.  Alternatively, set
BOOST_LIBRARYDIR to the directory containing Boost libraries or BOOST_ROOT
to the location of Boost.
Call Stack (most recent call first):
cmake/Modules/FindOpticksBoost.cmake:16 (find_package)
boost/bpo/bcfg/CMakeLists.txt:8 (find_package)</pre>
</div>
<p>If possible use your system package manager to update Boost. If that is
not possible then do a local Boost install.  Opticks includes bash functions
starting <em>boost-</em> that can get and install Boost locally.</p>
<div class="highlight-python"><pre>opticks-
boost-
opticks-configure -DBOOST_ROOT=$(boost-prefix)</pre>
</div>
</div>
<div class="section" id="cuda-related">
<h3>CUDA related<a class="headerlink" href="#cuda-related" title="Permalink to this headline">¶</a></h3>
<p>OptiX requires your system to have a fairly recent NVIDIA GPU of CUDA compute capability 3.0 at least.
However without such a GPU the OpenGL visualization should still work, using saved propagations.</p>
<p>To download OptiX you need to join the NVIDIA Developer Program.
Use the links in the table to register, it is free but may take a few days to be approved.
Follow the NVIDIA instructions to download and install CUDA and OptiX.
Thrust is installed together with CUDA.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="12%" />
<col width="10%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">directory</th>
<th class="head">precursor</th>
<th class="head">pkg name</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>cuda</td>
<td>cuda-</td>
<td>CUDA</td>
<td><a class="reference external" href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a></td>
</tr>
<tr class="row-odd"><td>optix</td>
<td>optix-</td>
<td>OptiX</td>
<td><a class="reference external" href="https://developer.nvidia.com/optix">https://developer.nvidia.com/optix</a></td>
</tr>
<tr class="row-even"><td>numerics/thrust</td>
<td>thrust-</td>
<td>Thrust</td>
<td>included with CUDA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="configuring-and-building-opticks">
<h2>Configuring and Building Opticks<a class="headerlink" href="#configuring-and-building-opticks" title="Permalink to this headline">¶</a></h2>
<p>CMake is used to configure Opticks and generate Makefiles.
For a visualization only build with system Boost
the defaults should work OK and there is no need to explicitly configure.
If a local Boost was required then:</p>
<div class="highlight-python"><pre>opticks-configure -DBOOST_ROOT=$(boost-prefix)</pre>
</div>
<p>For a full build with CUDA and OptiX configure with:</p>
<div class="highlight-python"><pre>opticks-configure -DCUDA_TOOLKIT_ROOT_DIR=/Developer/NVIDIA/CUDA-7.0 \
                  -DOptiX_INSTALL_DIR=/Developer/OptiX \
                  -DBOOST_ROOT=$(boost-prefix)</pre>
</div>
<p>These configuration values are cached in the CMakeCache.txt file
in the build directory. These values are not overridden by rebuilding
with the <em>opticks&#8211;</em> bash function.
A subsequent <em>opticks-configure</em> however will wipe the build directory
allowing new values to be set.</p>
<dl class="docutils">
<dt>To build::</dt>
<dd>opticks&#8211;</dd>
</dl>
</div>
<div class="section" id="configuration-machinery">
<h2>Configuration Machinery<a class="headerlink" href="#configuration-machinery" title="Permalink to this headline">¶</a></h2>
<p>If the above configuration suceeded for you then
you do not need to understand this machinery.</p>
<p>The below commands from the <em>opticks-cmake</em> bash function
change directory to the build folder and invokes cmake
to generate a configuration cache file and multiple Makefiles.:</p>
<div class="highlight-python"><pre>opticks-bcd
cmake \
    -DCMAKE_BUILD_TYPE=Debug \
    -DCMAKE_INSTALL_PREFIX=$(opticks-prefix) \
    -DOptiX_INSTALL_DIR=$(optix-prefix) \
    $* \
    $(opticks-sdir)</pre>
</div>
<p>CMake is controlled via CMakeLists.txt files.
The top level one includes the below lines that
locate the CUDA and OptiX:</p>
<div class="highlight-python"><pre>set(OPTICKS_CUDA_VERSION 5.5)
set(OPTICKS_OPTIX_VERSION 3.5)
...
find_package(CUDA ${OPTICKS_CUDA_VERSION})
find_package(OptiX ${OPTICKS_OPTIX_VERSION})</pre>
</div>
</div>
<div class="section" id="building-opticks">
<h2>Building Opticks<a class="headerlink" href="#building-opticks" title="Permalink to this headline">¶</a></h2>
<p>To build Opticks run:</p>
<div class="highlight-python"><pre>opticks-
opticks-full</pre>
</div>
<p>After the first full build, faster update builds can be done with:</p>
<div class="highlight-python"><pre>opticks--</pre>
</div>
<p>Full Opticks functionality with GPU simulation of optical photons requires all
the above externals to be installed, however if your GPU is not able to run OptiX or
the CUDA related externals have not been installed it is still possible to make a
partial build of Opticks using cmake switch WITH_OPTIX=OFF.
The partial mode provides OpenGL visualizations of geometry and
photon propagations loaded from file.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="9%" />
<col width="8%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">directory</th>
<th class="head">precursor</th>
<th class="head">pkg name</th>
<th class="head">required find package</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>sysrap</td>
<td>sysrap-</td>
<td>SysRap</td>
<td>PLog</td>
</tr>
<tr class="row-odd"><td>boostrap</td>
<td>brap-</td>
<td>BoostRap</td>
<td>OpticksBoost</td>
</tr>
<tr class="row-even"><td>opticksnpy</td>
<td>npy-</td>
<td>NPY</td>
<td>Boost GLM BoostRap</td>
</tr>
<tr class="row-odd"><td>optickscore</td>
<td>optickscore-</td>
<td>OpticksCore</td>
<td>Boost GLM BRegex BCfg NPY</td>
</tr>
<tr class="row-even"><td>ggeo</td>
<td>ggeo-</td>
<td>GGeo</td>
<td>Boost GLM BRegex BCfg NPY OpticksCore</td>
</tr>
<tr class="row-odd"><td>assimprap</td>
<td>assimprap-</td>
<td>AssimpRap</td>
<td>Boost GLM Assimp GGeo NPY OpticksCore</td>
</tr>
<tr class="row-even"><td>openmeshrap</td>
<td>openmeshrap-</td>
<td>OpenMeshRap</td>
<td>Boost GLM NPY GGeo OpticksCore OpenMesh</td>
</tr>
<tr class="row-odd"><td>opticksgeo</td>
<td>opticksgeo-</td>
<td>OpticksGeo</td>
<td>Boost GLM BRegex BCfg NPY OpticksCore Assimp AssimpRap OpenMesh OpenMeshRap</td>
</tr>
<tr class="row-even"><td>oglrap</td>
<td>oglrap-</td>
<td>OGLRap</td>
<td>GLEW GLFW GLM Boost BCfg Opticks GGeo NPY BRegex ImGui</td>
</tr>
<tr class="row-odd"><td>cudarap</td>
<td>cudarap-</td>
<td>CUDARap</td>
<td>CUDA (ssl)</td>
</tr>
<tr class="row-even"><td>thrustrap</td>
<td>thrustrap-</td>
<td>ThrustRap</td>
<td>CUDA Boost GLM NPY CUDARap</td>
</tr>
<tr class="row-odd"><td>optixrap</td>
<td>optixrap-</td>
<td>OptiXRap</td>
<td>OptiX CUDA Boost GLM NPY OpticksCore Assimp AssimpRap GGeo CUDARap ThrustRap</td>
</tr>
<tr class="row-even"><td>opticksop</td>
<td>opticksop-</td>
<td>OpticksOp</td>
<td>OptiX CUDA Boost GLM BCfg Opticks GGeo NPY OptiXRap CUDARap ThrustRap</td>
</tr>
<tr class="row-odd"><td>opticksgl</td>
<td>opticksgl-</td>
<td>OpticksGL</td>
<td>OptiX CUDA Boost GLM GLEW GLFW OGLRap NPY OpticksCore Assimp AssimpRap GGeo CUDARap ThrustRap OptiXRap OpticksOp</td>
</tr>
<tr class="row-even"><td>ggeoview</td>
<td>ggeoview-</td>
<td>GGeoView</td>
<td>OptiX CUDA Boost GLM GLEW GLFW OGLRap NPY BCfg OpticksCore
Assimp AssimpRap OpenMesh OpenMeshRap GGeo ImGui BRegex OptiXRap CUDARap ThrustRap OpticksOp OpticksGL OpticksGeo</td>
</tr>
<tr class="row-odd"><td>cfg4</td>
<td>cfg4-</td>
<td>CfG4</td>
<td>Boost GLM BRegex BCfg NPY GGeo OpticksCore Geant4 EnvXercesC G4DAE</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>sysrap</dt>
<dd>logging, string handling, envvar handling</dd>
<dt>boostrap</dt>
<dd>filesystem utils, regular expression matching, commandline parsing</dd>
<dt>opticksnpy</dt>
<dd>array handling</dd>
<dt>optickscore</dt>
<dd>definitions, loosely the model of the app</dd>
<dt>ggeo</dt>
<dd>geometry representation</dd>
<dt>assimprap</dt>
<dd>G4DAE parsing into GGeo repr</dd>
<dt>openmeshrap</dt>
<dd>geometry fixing</dd>
<dt>opticksgeo</dt>
<dd>bring together ggeo, assimprap and openmeshrap to load and fix geometry</dd>
<dt>oglrap</dt>
<dd>OpenGL rendering, including GLSL shader sources</dd>
<dt>cudarap</dt>
<dd>loading curand persisted state</dd>
<dt>thrustrap</dt>
<dd>fast GPU photon indexing using interop techniques</dd>
<dt>optixrap</dt>
<dd>conversion of GGeo geometry into OptiX GPU geometry, OptiX programs for propagation</dd>
<dt>opticksop</dt>
<dd>high level OptiX control</dd>
<dt>opticksgl</dt>
<dd>combination of oglrap- OpenGL and OptiX raytracing</dd>
<dt>ggeoview</dt>
<dd>putting together all the above</dd>
<dt>cfg4</dt>
<dd>contained geant4</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="Opticks"
             >previous</a> |</li>
        <li><a href="index.html">Opticks 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>