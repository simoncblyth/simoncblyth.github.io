**orientation** : Opticks Codebase Orientation for Developers
==============================================================

.. contents:: Table of Contents
   :depth: 2


Page Overview
---------------

The focus of this description is on the Opticks usage of NVIDIA OptiX however necessary 
summary contextual info for developers unfamiliar with Opticks is also collected here together
with references to more extensive documentation.

Opticks Objectives
--------------------

1. replace Geant4 optical photon simulation with an equivalent GPU implementation based on NVIDIA OptiX  
2. provide automated geometry translation without approximation, Geant4 -> Opticks (GGeo) -> NVIDIA OptiX, 
3. provide a workflow that integrates the Geant4 simulation of all other particles with 
   Opticks/OptiX simulation of optical photons 


Geant4-Opticks-OptiX workflow
--------------------------------

.. image:: //env/Documents/Geant4OpticksWorkflow/Geant4OpticksWorkflow.001.png
  :width: 1024
  :alt: Geant4-Opticks-OptiX workflow


Physics Background
--------------------

Scintillation and Cerenkov are the two physical processes which are the principal sources 
of light relevant to neutrino and dark matter experiments.

* https://en.wikipedia.org/wiki/Scintillation_(physics)
* https://en.wikipedia.org/wiki/Cherenkov_radiation

After generation the photons propagate through the detector geometry 
being scattered, absorbed, reemitted (in the bulk) and reflected, refracted, detected
or absorbed (on surfaces encountered).  

The objective of simulation is to provide estimates of times and numbers of photons 
that reach detectors such as Photomultipler tubes (PMTs) by creation of large samples with 
various input particles types and parameters. 

Simulation is the best way to understand complex detectors and as a result 
form a better understanding of the physics of interest such as neutrinos coming 
from nuclear reactors or from the sun or from distant galaxies. 
  

Geant4 classes which are partially ported to CUDA/OptiX 
----------------------------------------------------------

* G4Cerenkov (only generation loop)
* G4Scintillation (only generation loop)
* G4OpBoundaryProcess

To quickly view the sources of any Geant4 classes use the opticks bash function g4-cls::

    g4-;g4-cls G4Cerenkov 

CMake Structure 
-----------------

Opticks is structured as a collection of ~20 modular CMake projects organized by
their dependencies. The projects are hooked together into a tree using the CMake *find_package* mechanism 
which uses *BCM* (Boost CMake Modules) to reduce CMake boilerplate.  The upshot is that 
you only need to worry about one level of dependencires 

Bash Functions
----------------

Bash functions are used for building the tree of CMake projects, see *om.bash*





