<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fonts &mdash; Heprez Unversioned directory documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'Unversioned directory',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Heprez Unversioned directory documentation" href="../../" />
    <link rel="up" title="Batik" href="../" />
    <link rel="next" title="Inkscape" href="../../inkscape/" />
    <link rel="prev" title="Squiggle" href="../squiggle/" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../inkscape/" title="Inkscape"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../squiggle/" title="Squiggle"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">Heprez Unversioned directory documentation</a> &raquo;</li>
          <li><a href="../" accesskey="U">Batik</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> /e </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">/h</a>   </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/"> cms01 </a> </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/downloads/"> downloads </a> </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/rezdb/db/hfagc/"> rezdb/db/hfagc/ </a> </li>
</ul>






<h3>Content Skeleton</h3>

<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SOP/">SOP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log/end_of_2011/">LOG</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../heprez/">HEPREZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heprez/#heprez-usage-log">HEPREZ USAGE LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rezdb/">REZDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compilation/">Compilation latex document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../docs/math/">Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hepex/hepex/">Hepex Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../future/">Future of b2c</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environment/">Environment for heprez installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chiba/">Chiba</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chibatomcat/chibatomcat/">CHIBA TOMCAT</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Batik</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../transcoder/">SVG to JPEG demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../squiggle/">Squiggle</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Fonts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#issue-missing-text">Issue : missing text</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#maybe-osx-specific">maybe OSX specific</a></li>
<li class="toctree-l4"><a class="reference internal" href="#try-on-cms01">try on cms01</a></li>
<li class="toctree-l4"><a class="reference internal" href="#try-on-b2mc">try on b2mc</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../inkscape/">Inkscape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dvisvgm/">DVISVGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../images/">Binary Image creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backup/backup/">Partial Backup Machinery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backup/part/build/">BACKUP ANT BUILD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exist_/">LOW LEVEL EXIST USAGE FUNCTIONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exist/">exist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../macports/">macports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../porting/">porting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../eperl/">eperl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../svg/">svg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scrape/">scrape</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/batik/fonts/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../squiggle/"
                        title="previous chapter">Squiggle</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../inkscape/"
                        title="next chapter">Inkscape</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="fonts">
<h1>Fonts<a class="headerlink" href="#fonts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="issue-missing-text">
<h2>Issue : missing text<a class="headerlink" href="#issue-missing-text" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://mail-archives.apache.org/mod_mbox/xmlgraphics-batik-users/200707.mbox/%3Cs68cbe31.001&#64;bristol.gov.uk%3E">http://mail-archives.apache.org/mod_mbox/xmlgraphics-batik-users/200707.mbox/%3Cs68cbe31.001&#64;bristol.gov.uk%3E</a></li>
</ul>
<div class="highlight-python"><pre>  My guess is that it can't find _any_ fonts in the server JVM.
One option would be to use CSS or SVG to point directly to a
TrueType font file for rendering.  You can see an example of this
in "samples/tests/spec/fonts/fontFace.svg".</pre>
</div>
<div class="section" id="maybe-osx-specific">
<h3>maybe OSX specific<a class="headerlink" href="#maybe-osx-specific" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://www.nanoant.com/apple/leopards-java-105-update-2-breaks-quartz-pipeline-font-rendering">http://www.nanoant.com/apple/leopards-java-105-update-2-breaks-quartz-pipeline-font-rendering</a></li>
</ul>
<div class="highlight-python"><pre>simon:batik-svg2jpg blyth$ batik-svgs | grep textStyle
/usr/local/heprez/future/batik/batik-1.7/samples/tests/spec/text/textStyles.svg</pre>
</div>
<p>Both <cite>batik-squiggle</cite> and <cite>batik-qsquiggle</cite> missing chars:</p>
<div class="highlight-python"><pre>simon:batik-svg2jpg blyth$ batik-qsquiggle /usr/local/heprez/future/batik/batik-1.7/samples/tests/spec/text/textStyles.svg
java -Dapple.awt.graphics.UseQuartz=true -jar /usr/local/heprez/future/batik/batik-1.7/batik-squiggle.jar /usr/local/heprez/future/batik/batik-1.7/samples/tests/spec/text/textStyles.svg
Loading document...
Loading document completed in 287 ms
Building document...
Building document completed in 591 ms
Rendering document preparation...
Rendering document preparation completed in 116 ms
Rendering document started...
Rendering document completed in 1219 ms</pre>
</div>
</div>
<div class="section" id="try-on-cms01">
<h3>try on cms01<a class="headerlink" href="#try-on-cms01" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>1000  svn up ~/h
1001  heprez-
1002  batik-
1003  batik-get
1004  batik-svg2jpg-build
1005  batik-svg2jpg-demo
1006  cp /tmp/blyth/heprez/batik-svg2jpg-demo/01218_nometa.jpg ~/</pre>
</div>
<p>No missing text in cms01 transcoded jpg, but still:</p>
<ol class="arabic simple">
<li>dinky math font with some glyph overlapping</li>
</ol>
</div>
<div class="section" id="try-on-b2mc">
<h3>try on b2mc<a class="headerlink" href="#try-on-b2mc" title="Permalink to this headline">¶</a></h3>
<p>AWT Window server permissions:</p>
<div class="highlight-python"><pre>b2mc:~ heprez$ heprez-
b2mc:~ heprez$ batik-
b2mc:~ heprez$ batik-svg2jpg-demo
=== batik-svg2jpg: /Users/heprez/heprez/batik/samples/01218_nometa.svg : /tmp/heprez/heprez/batik-svg2jpg-demo/01218_nometa.jpg
=== batik-svg2jpg: time java -cp /Users/heprez/local/heprez/future/batik/transcoder:/Users/heprez/local/heprez/future/batik/batik-1.7/batik.jar SaveAsJPEG /Users/heprez/heprez/batik/samples/01218_nometa.svg /tmp/heprez/heprez/batik-svg2jpg-demo/01218_nometa.jpg
Apr  4 21:29:45 b2mc.kek.jp java[27969] &lt;Error&gt;: kCGErrorFailure: Set a breakpoint @ CGErrorBreakpoint() to catch errors as they are logged.
Exception in thread "main" java.lang.InternalError: Can't connect to window server - not enough permissions.
        at java.lang.ClassLoader$NativeLibrary.load(Native Method)
        at java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1827)
        at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1724)
        at java.lang.Runtime.loadLibrary0(Runtime.java:823)
        at java.lang.System.loadLibrary(System.java:1045)
        at sun.security.action.LoadLibraryAction.run(LoadLibraryAction.java:50)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.awt.Toolkit.loadLibraries(Toolkit.java:1605)
        at java.awt.Toolkit.&lt;clinit&gt;(Toolkit.java:1627)
        at java.awt.Color.&lt;clinit&gt;(Color.java:263)
        at org.apache.batik.transcoder.image.JPEGTranscoder.&lt;init&gt;(JPEGTranscoder.java:46)
        at SaveAsJPEG.main(SaveAsJPEG.java:12)</pre>
</div>
<p>Require <cite>-Djava.awt.headless=true</cite>:</p>
<div class="highlight-python"><pre>b2mc:~ heprez$ batik-
b2mc:~ heprez$ batik-svg2jpg-demo
=== batik-svg2jpg: /Users/heprez/heprez/batik/samples/01218_nometa.svg : /tmp/heprez/heprez/batik-svg2jpg-demo/01218_nometa.jpg
=== batik-svg2jpg: time java -Djava.awt.headless=true -cp /Users/heprez/local/heprez/future/batik/transcoder:/Users/heprez/local/heprez/future/batik/batik-1.7/batik.jar SaveAsJPEG /Users/heprez/heprez/batik/samples/01218_nometa.svg /tmp/heprez/heprez/batik-svg2jpg-demo/01218_nometa.jpg

real    0m7.948s
user    0m3.742s
sys     0m0.824s
b2mc:~ heprez$</pre>
</div>
<p>Copy back and view, shows no missing text in b2mc (Lion) transcodes:</p>
<div class="highlight-python"><pre>simon:~ blyth$ scp K:01218_nometa.jpg k_01218_nometa.jpg
simon:~ blyth$ open k_01218_nometa.jpg</pre>
</div>
<p>BUT, still have dinky math font and some glyph overlapping</p>
<div class="sidebar">
<p class="first sidebar-title">Just a start</p>
<p class="last">To be able to replace Illustrator need to test the full roundtrip,
ie must be able to convert PDF (created by pdflatex) to SVG.
Also latex2html enters somewhere too for glyph metrics extracted from the html.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../inkscape/" title="Inkscape"
             >next</a> |</li>
        <li class="right" >
          <a href="../squiggle/" title="Squiggle"
             >previous</a> |</li>
        <li><a href="../../">Heprez Unversioned directory documentation</a> &raquo;</li>
          <li><a href="../" >Batik</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>