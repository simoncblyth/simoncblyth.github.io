<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CHIBACVS &mdash; Heprez Unversioned directory documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'Unversioned directory',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Heprez Unversioned directory documentation" href="../../" />
    <link rel="up" title="Chiba" href="../" />
    <link rel="next" title="&lt;no title&gt;" href="../../chibatomcat/" />
    <link rel="prev" title="Chiba Sources" href="../source/" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../chibatomcat/" title="&lt;no title&gt;"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../source/" title="Chiba Sources"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">Heprez Unversioned directory documentation</a> &raquo;</li>
          <li><a href="../" accesskey="U">Chiba</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> /e </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">/h</a>   </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/"> cms01 </a> </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/downloads/"> downloads </a> </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/rezdb/db/hfagc/"> rezdb/db/hfagc/ </a> </li>
</ul>






<h3>Content Skeleton</h3>

<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SOP/">SOP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log/end_of_2011/">LOG</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../heprez/">HEPREZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heprez/#heprez-usage-log">HEPREZ USAGE LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rezdb/">REZDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compilation/">Compilation latex document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../docs/math/">Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hepex/hepex/">Hepex Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../future/">Future of b2c</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environment/">Environment for heprez installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Chiba</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../source/">Chiba Sources</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">CHIBACVS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#chiba-form-tweaking-workflow">Chiba Form tweaking workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#commit-patch-to-chiba">Commit Patch to Chiba</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-testing">BUILD TESTING</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thoughts">THOUGHTS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#functions">FUNCTIONS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#chiba-source-confusion">Chiba Source Confusion</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#comparison-on-cms01">Comparison on cms01</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#source-archeology">Source Archeology</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chibatomcat/chibatomcat/">CHIBA TOMCAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../batik/">Batik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../inkscape/">Inkscape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dvisvgm/">DVISVGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../images/">Binary Image creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backup/backup/">Partial Backup Machinery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backup/part/build/">BACKUP ANT BUILD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exist_/">LOW LEVEL EXIST USAGE FUNCTIONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exist/">exist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../macports/">macports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../porting/">porting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../eperl/">eperl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../svg/">svg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scrape/">scrape</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/chiba/chibacvs.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../source/"
                        title="previous chapter">Chiba Sources</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../chibatomcat/"
                        title="next chapter">&lt;no title&gt;</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="chibacvs">
<h1>CHIBACVS<a class="headerlink" href="#chibacvs" title="Permalink to this headline">¶</a></h1>
<p>Originates from translation of $HEPREZ_FOLDER/xforms/chiba-cvs/build.xml</p>
<p>CVS reminders..</p>
<ul class="simple">
<li><a class="reference external" href="http://cvsbook.red-bean.com/cvsbook.html#Getting%20Snapshots%20(Dates%20And%20Tagging">http://cvsbook.red-bean.com/cvsbook.html#Getting%20Snapshots%20(Dates%20And%20Tagging</a>)</li>
</ul>
<div class="section" id="chiba-form-tweaking-workflow">
<h2>Chiba Form tweaking workflow<a class="headerlink" href="#chiba-form-tweaking-workflow" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Modify .xsl:</p>
<div class="highlight-python"><pre>cd $(chibacvs-trunk)
svn st</pre>
</div>
</li>
<li><p class="first"><em>chibacvs-deploy-web</em>  creates the war</p>
</li>
<li><p class="first">propagate into tomcat/chiba webapp:</p>
<div class="highlight-python"><pre>cd $(chibatomcat-dir) ; rm -rf 2 ; chibatomcat-unwar</pre>
</div>
</li>
<li><p class="first">regenerate the forms:</p>
<div class="highlight-python"><pre>xsd2xhtml-;xsd2xhtml-build</pre>
</div>
</li>
<li><p class="first">check resulting forms, rinse and repeat</p>
</li>
</ol>
</div>
<div class="section" id="commit-patch-to-chiba">
<h2>Commit Patch to Chiba<a class="headerlink" href="#commit-patch-to-chiba" title="Permalink to this headline">¶</a></h2>
<p>To commit a change:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#. *chibacvs-makepatch*</span>
<span class="c">#. *svn diff* on the patch to ensure is the desired change then commit the patch</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Working copy modifications are reverted by <em>chibacvs-build</em> prior to patch application <strong>THE PATCH IS THE SOURCE</strong></p>
</div>
</div>
<div class="section" id="build-testing">
<h2>BUILD TESTING<a class="headerlink" href="#build-testing" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chibacvs</span><span class="o">-</span><span class="n">build</span>
<span class="n">chibatomcat</span><span class="o">-</span><span class="n">unwar</span><span class="o">-</span><span class="n">again</span>
<span class="n">xsd2xhtml</span><span class="o">-</span><span class="n">build</span>
</pre></div>
</div>
<div class="section" id="thoughts">
<h3>THOUGHTS<a class="headerlink" href="#thoughts" title="Permalink to this headline">¶</a></h3>
<p>Using the patch for whole file additions (see <em>chibacvs-svnadd</em>) is
a misuse of patching as it makes it difficult to see changes to the patch
due to the whole file additions</p>
</div>
</div>
<div class="section" id="functions">
<h2>FUNCTIONS<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><em>chibacvs-dir</em></dt>
<dd>operating dir, all manipulations in here, eg /Users/heprez/data/install/chibacvs</dd>
<dt><em>chibacvs-cvsrootdir</em></dt>
<dd>target of the rsync</dd>
<dt><em>chibacvs-cvsrootsfo</em></dt>
<dd>sourceforge CVS repo coords, denies access</dd>
<dt><em>chibacvs-cvsroot</em></dt>
<dd>the root to use for the checkouts</dd>
<dt><em>chibacvs-stamp</em></dt>
<dd>timestamp</dd>
<dt><em>chibacvs-sandbox</em></dt>
<dd>sandbox</dd>
<dt><em>chibacvs-build</em></dt>
<dd>invokes <em>-get</em> <em>-applypatch</em> <em>-deploy-core</em> <em>-deploy-web</em></dd>
<dt><em>chibacvs-rsync</em></dt>
<dd>rsync the complete chiba CVS repository into  chibacvs-rootdir
only needed when sourceforge CVS not working</dd>
<dt><em>chibacvs-get</em></dt>
<dd><em>[added 2013/03]</em>
As original sources no longer accessible,
grab tarball from my cache  <a class="reference external" href="http://dayabay.phys.ntu.edu.tw/cache/chiba-project-svn-trunk-2139.tar.gz">http://dayabay.phys.ntu.edu.tw/cache/chiba-project-svn-trunk-2139.tar.gz</a>
and unpack into <em>chibacvs-dir</em></dd>
</dl>
<p><em>chibacvs-applypatch</em></p>
<blockquote>
<div><p>Contrary to expectations, no hunk problems:</p>
<div class="highlight-python"><pre>b2mc:h heprez$ chibacvs-applypatch
=== chibacvs-applypatch : from /Users/heprez/data/install/chibacvs/chiba-project-svn-trunk-2139 revert and apply patch /Users/heprez/heprez/chiba/patch/chibacvs-2139-final-trunk.patch
patching file chiba-web/src/org/chiba/adapter/servlet/ChibaServlet.java
patching file chiba-web/etc/log4j.xml
patching file chiba-web/web/forms/styles/xforms.css
patching file chiba-web/web/forms/orderlist2.xhtml
patching file chiba-web/web/forms/xslt/html-form-controls-dist-scb-modified.xsl
patching file chiba-web/web/forms/xslt/html-form-controls.xsl
patching file chiba-web/web/forms/xslt/identity.xsl
patching file chiba-sandbox/src/org/chiba/tools/schemabuilder/AbstractSchemaFormBuilder.java
b2mc:h heprez$</pre>
</div>
</div></blockquote>
<dl class="docutils">
<dt><em>chibacvs-final-makepatch</em></dt>
<dd><p class="first"><em>[added 2013/03]</em>
Final as have lost touch with SVN repo.
If further changes are needed, should import to github or some such</p>
<p>Uses <em>svn diff</em> from <em>chiba-finaltrunk</em> to create a patch:</p>
<div class="last highlight-python"><pre>[blyth@cms01 chibacvs]$ chibacvs-finaltrunk
/data/heprez/install/chibacvs/trunk
[blyth@cms01 chibacvs]$ chibacvs-patchpath
/home/blyth/heprez/chiba/patch/chibacvs-2139-final-trunk.patch</pre>
</div>
</dd>
<dt><em>chibacvs-compare-patched-trunks</em></dt>
<dd><p class="first"><em>[added 2013/06]</em>
Oops, rather different:</p>
<div class="highlight-python"><pre>[blyth@cms01 trunk]$ l  /home/blyth/heprez/chiba/patch/
-rw-rw-r--  1 blyth blyth 619128 Jun 19 19:08 chibacvs-2139-final-trunk.patch
-rw-rw-r--  1 blyth blyth 313565 May  6  2009 chibacvs-2139.patch</pre>
</div>
<p class="last">Understanding diffs of diffs is painful, so apply the patches to relevant trunks
and compare the different patched trunks.</p>
</dd>
<dt><em>chibacvs-co-deprecated</em></dt>
<dd><p class="first">getting connection refused on attempting to login to chiba sourceforge CVS.
Chiba has moved to SVN but failed to establish correspondence between my prior
CVS checkout and the purported corresponding SVN tag</p>
<p class="last">HMM, must control the revision in order to get the one that corresponds to patches
try using SVN</p>
</dd>
<dt><em>chibacvs-rsync-to-hfag</em></dt>
<dd>workaround to transfer from cms01 to hfag while hfag does not have SSL capable SVN</dd>
<dt><em>chibacvs-deploy-core</em></dt>
<dd><p class="first">deploy target from <em>chiba-sandbox/build.xml</em>
creates:</p>
<div class="highlight-python"><pre>chiba-sandbox/build
chiba-sandbox/chiba-1.2.0/*</pre>
</div>
<p>On K, succeeds with two warnings regarding</p>
<blockquote>
<div>this.model.getClass().getDeclaredMethod(name, null).invoke(this.model, null);</div></blockquote>
<p class="last">Logfile K:~/chibacvs-deploy-core.log</p>
</dd>
</dl>
<p><em>chibacvs-deploy-web</em></p>
<blockquote>
<div><p>chiba-web/build.xml::install-from-local-core
invokes the sibling chiba-sandbox/build.xml::deploy</p>
<p>chiba-web/build.xml::distribute
creates source distribution files in tar.gz and zip format as well as
a war-file for deployment in a webcontainer</p>
<p>creates:</p>
<div class="highlight-python"><pre>chiba-web/build
chiba-web/chiba-web-2.0.0rc1
chiba-web/dist</pre>
</div>
<p>historical comment: could go direct to deploying for speed, but preferable to go
via the war for direct comparison with the normal build from the distribution</p>
<p>Logfile K:~/chibacvs-deploy-web.log</p>
</div></blockquote>
<dl class="docutils">
<dt><em>chibacvs-diff</em></dt>
<dd>comparisons of the checkouts done by chibacvs-co with the unmanaged morass on HFAG</dd>
</dl>
<div class="section" id="chiba-source-confusion">
<h3>Chiba Source Confusion<a class="headerlink" href="#chiba-source-confusion" title="Permalink to this headline">¶</a></h3>
<p>Due to the chiba sources moving around and now being inaccessible.
Added <em>chibacvs-get</em> to grab from cache <a class="reference external" href="http://dayabay.phys.ntu.edu.tw/cache/chiba-project-svn-trunk-2139.tar.gz">http://dayabay.phys.ntu.edu.tw/cache/chiba-project-svn-trunk-2139.tar.gz</a></p>
<div class="section" id="comparison-on-cms01">
<h4>Comparison on cms01<a class="headerlink" href="#comparison-on-cms01" title="Permalink to this headline">¶</a></h4>
<p>Compare this with the live sources on C (and later G) and check that the patches
can be applied to it to reproduce the live versions.</p>
<p>Before running <em>chibacvs-get</em>:</p>
<div class="highlight-python"><pre>[blyth@cms01 chibacvs]$ pwd
/data/heprez/install/chibacvs
[blyth@cms01 chibacvs]$ ll
total 32
drwxrwxr-x   6 blyth blyth 4096 Apr 30  2009 trunk
drwxrwxr-x   2 blyth blyth 4096 Apr 30  2009 deploy
drwxrwxr-x   4 blyth blyth 4096 Apr 30  2009 .</pre>
</div>
<p>After:</p>
<div class="highlight-python"><pre>[blyth@cms01 chibacvs]$ ll
total 11188
drwxrwxr-x   6 blyth blyth     4096 Apr 30  2009 trunk
drwxrwxr-x   2 blyth blyth     4096 Apr 30  2009 deploy
drwxrwxr-x  18 blyth blyth     4096 Apr 13  2012 ..
-rw-rw-r--   1 blyth blyth 11393150 Jun 19 18:58 chiba-project-svn-trunk-2139.tar.gz
drwxrwxr-x   5 blyth blyth     4096 Jun 19 18:58 .
drwxrwxr-x   5 blyth blyth     4096 Jun 19 18:58 chiba-project-svn-trunk-2139
[blyth@cms01 chibacvs]$</pre>
</div>
<div class="highlight-python"><pre>[blyth@cms01 chibacvs]$ diff -r --brief trunk chiba-project-svn-trunk-2139 | grep -v .svn
Only in trunk/chiba-sandbox: build
Only in trunk/chiba-sandbox: chiba-1.2.0
Only in trunk/chiba-web: build
Only in trunk/chiba-web: dist
Only in trunk/chiba-web: doc
Only in trunk/chiba-web/lib: core
Only in trunk/chiba-web/web/forms: orderlist2.xhtml
Only in trunk/chiba-web/web/forms/xslt: html-form-controls-dist-scb-modified.xsl
Only in trunk/chiba-web/web/forms/xslt: identity.xsl
[blyth@cms01 chibacvs]$</pre>
</div>
</div>
</div>
<div class="section" id="source-archeology">
<h3>Source Archeology<a class="headerlink" href="#source-archeology" title="Permalink to this headline">¶</a></h3>
<p>Use trac to do some archeology to establish source correspondence...</p>
<ul class="simple">
<li><a class="reference external" href="https://www.chiba-project.org/trac/timeline?from=04%2F14%2F06&amp;daysback=90&amp;ticket=on&amp;changeset=on&amp;milestone=on&amp;wiki=on&amp;update=Update">https://www.chiba-project.org/trac/timeline?from=04%2F14%2F06&amp;daysback=90&amp;ticket=on&amp;changeset=on&amp;milestone=on&amp;wiki=on&amp;update=Update</a></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../chibatomcat/" title="&lt;no title&gt;"
             >next</a> |</li>
        <li class="right" >
          <a href="../source/" title="Chiba Sources"
             >previous</a> |</li>
        <li><a href="../../">Heprez Unversioned directory documentation</a> &raquo;</li>
          <li><a href="../" >Chiba</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>