<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SVG PLOT CHECKING/DEVELOPMENT &mdash; Heprez Unversioned directory documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'Unversioned directory',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Heprez Unversioned directory documentation" href="../../" />
    <link rel="up" title="svg" href="../" />
    <link rel="next" title="scrape" href="../../scrape/" />
    <link rel="prev" title="svg" href="../" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../scrape/" title="scrape"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="svg"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">Heprez Unversioned directory documentation</a> &raquo;</li>
          <li><a href="../" accesskey="U">svg</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Links</h3>
<ul class="this-page-menu">
	<li><a href="/tracs/env"> env </a>  <a href="/tracs/env/timeline"> tl </a> <a href="/repos/env/trunk"> repo </a> <a href="/e"> /e </a> </li>
	<li><a href="/tracs/heprez"> heprez </a>  <a href="/tracs/heprez/timeline"> tl </a> <a href="/repos/heprez/trunk"> repo</a> <a href="/h">/h</a>   </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/"> cms01 </a> </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/downloads/"> downloads </a> </li>
	<li> <a href="http://cms01.phys.ntu.edu.tw/rezdb/db/hfagc/"> rezdb/db/hfagc/ </a> </li>
</ul>






<h3>Content Skeleton</h3>

<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SOP/">SOP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TODO/">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log/end_of_2011/">LOG</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../heprez/">HEPREZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heprez/#heprez-usage-log">HEPREZ USAGE LOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rezdb/">REZDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compilation/">Compilation latex document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../docs/math/">Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hepex/hepex/">Hepex Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qxml/">QXML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../future/">Future of b2c</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environment/">Environment for heprez installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chiba/">Chiba</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chibatomcat/chibatomcat/">CHIBA TOMCAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../batik/">Batik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../inkscape/">Inkscape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dvisvgm/">DVISVGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../images/">Binary Image creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backup/backup/">Partial Backup Machinery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backup/part/build/">BACKUP ANT BUILD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exist_/">LOW LEVEL EXIST USAGE FUNCTIONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exist/">exist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../macports/">macports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../porting/">porting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../eperl/">eperl</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">svg</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">SVG PLOT CHECKING/DEVELOPMENT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#convert-plot-svg-to-pdf">CONVERT PLOT SVG TO PDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pycairo">pycairo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inkscape">inkscape</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tracing-plot-sources">TRACING PLOT SOURCES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#remote-access-to-private-servers">remote access to private servers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cocoon-sitemap">cocoon sitemap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-xq-generator-xquery"><em>plot.xq</em> generator XQuery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#make-plot-xqm-xquery-lib"><em>make-plot.xqm</em> XQuery lib</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rezs-qtset2svg-svg-generation"><em>rezs:qtset2svg</em> SVG generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rezs-qt2svglabel"><em>rezs:qt2svglabel</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-the-index">Check the index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-origin-svg-from-dvisvgm">Check Origin SVG from dvisvgm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#centering-the-label">Centering the label</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-the-summary">Check the summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kludge-with-fixed-transform-modifying-query">Kludge with fixed transform modifying query</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kludge-fixed-offset">Kludge fixed offset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-old-function">Check old function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-new-function">Add new function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#svg-path">SVG PATH</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scrape/">scrape</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/svg/svgplot.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../"
                        title="previous chapter">svg</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../scrape/"
                        title="next chapter">scrape</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="svg-plot-checking-development">
<h1>SVG PLOT CHECKING/DEVELOPMENT<a class="headerlink" href="#svg-plot-checking-development" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt><em>svgplot-get</em></dt>
<dd>pull the SVG from the webapp</dd>
<dt><em>svgplot-eta</em></dt>
<dd>demo nofont SVG for single char of form produced by dvisvgm</dd>
</dl>
<div class="section" id="convert-plot-svg-to-pdf">
<h2>CONVERT PLOT SVG TO PDF<a class="headerlink" href="#convert-plot-svg-to-pdf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pycairo">
<h3>pycairo<a class="headerlink" href="#pycairo" title="Permalink to this headline">¶</a></h3>
<p>No path support yet ..</p>
<ul class="simple">
<li><a class="reference external" href="http://cairosvg.org/svg_support/#paths">http://cairosvg.org/svg_support/#paths</a></li>
</ul>
</div>
<div class="section" id="inkscape">
<h3>inkscape<a class="headerlink" href="#inkscape" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="tracing-plot-sources">
<h2>TRACING PLOT SOURCES<a class="headerlink" href="#tracing-plot-sources" title="Permalink to this headline">¶</a></h2>
<div class="section" id="remote-access-to-private-servers">
<h3>remote access to private servers<a class="headerlink" href="#remote-access-to-private-servers" title="Permalink to this headline">¶</a></h3>
<p>Open SSH socks proxy tunnels:</p>
<div class="highlight-python"><pre>simon:~ blyth$ ssh -fND localhost:8080 K
simon:~ blyth$ ssh -fND localhost:9090 K</pre>
</div>
<p>For details, and browser/curl config to use the proxy see <a class="reference external" href="http://dayabay.phys.ntu.edu.tw/tracs/env/intertrac/base/ssh">env:base/ssh</a></p>
</div>
<div class="section" id="cocoon-sitemap">
<h3>cocoon sitemap<a class="headerlink" href="#cocoon-sitemap" title="Permalink to this headline">¶</a></h3>
<p>Directs a URL regexp to cocoon XML generator <em>plot.xq</em></p>
<ul class="simple">
<li><a class="reference external" href="http://dayabay.phys.ntu.edu.tw/tracs/heprez/intertrac/source:hfag/mods/webapp/hfagc/sitemap.xmap.template">heprez:source:hfag/mods/webapp/hfagc/sitemap.xmap.template</a></li>
</ul>
<div class="highlight-python"><pre>851              &lt;map:match type="regexp" pattern="^(0)(\d)(\d)(\d)(\d)/plot/(svg|xml)$"&gt;
852                   &lt;map:generate src="plot.xq" type="xquery" label="sauce"  &gt;</pre>
</div>
</div>
<div class="section" id="plot-xq-generator-xquery">
<h3><em>plot.xq</em> generator XQuery<a class="headerlink" href="#plot-xq-generator-xquery" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://dayabay.phys.ntu.edu.tw/tracs/heprez/intertrac/source:hfag/mods/webapp/hfagc/plot.xq">heprez:source:hfag/mods/webapp/hfagc/plot.xq</a></li>
</ul>
<p>Request parameter handling, fork on individual or combined plot, hand over to <em>make-plot.xqm</em></p>
</div>
<div class="section" id="make-plot-xqm-xquery-lib">
<h3><em>make-plot.xqm</em> XQuery lib<a class="headerlink" href="#make-plot-xqm-xquery-lib" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://dayabay.phys.ntu.edu.tw/tracs/heprez/intertrac/source:hfag/mods/webapp/hfagc/xquery/make-plot.xqm">heprez:source:hfag/mods/webapp/hfagc/xquery/make-plot.xqm</a></li>
</ul>
<p>Mostly cache control, the nitty gritty handed down to <em>rezs.xqm</em></p>
</div>
<div class="section" id="rezs-qtset2svg-svg-generation">
<h3><em>rezs:qtset2svg</em> SVG generation<a class="headerlink" href="#rezs-qtset2svg-svg-generation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><a class="reference external" href="http://dayabay.phys.ntu.edu.tw/tracs/heprez/intertrac/source:hfag/mods/webapp/hfagc/xquery/rezs.xqm">heprez:source:hfag/mods/webapp/hfagc/xquery/rezs.xqm</a></p>
<blockquote>
<div><ul class="simple">
<li><cite>rezs:qtset2svg</cite></li>
<li><cite>rezs:present-vals</cite></li>
<li><cite>rezs:qt2svglabel</cite> <cite>rezs:qt2svgsabel</cite></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="rezs-qt2svglabel">
<h3><em>rezs:qt2svglabel</em><a class="headerlink" href="#rezs-qt2svglabel" title="Permalink to this headline">¶</a></h3>
<p>Label is returned asis from <em>/db/hfagc_system/qtag2svgs.xml</em></p>
<p>After opening the tunnel</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://130.87.106.59:9090/servlet/db/hfagc_system/">http://130.87.106.59:9090/servlet/db/hfagc_system/</a></li>
</ul>
</div></blockquote>
<div class="highlight-python"><pre>0039 declare variable $rezs:qtag2svgs_index  as xs:string { "/db/hfagc_system/qtag2svgs.xml" } ;
....
1618 (:
1619       this is used in individual and combi plot SVGs
1620 :)
1621 declare function rezs:qt2svglabel( $qt as xs:string , $opt as xs:string ) as element() {
1622
1623     let $label := if( doc-available($rezs:qtag2svgs_index) ) then
1624                      doc($rezs:qtag2svgs_index)//qtag[@value=$qt]/svgs/label/*
1625                   else
1626                      &lt;text x="0" y="0"&gt; no label[{$qt}] &lt;/text&gt;</pre>
</div>
</div>
<div class="section" id="check-the-index">
<h3>Check the index<a class="headerlink" href="#check-the-index" title="Permalink to this headline">¶</a></h3>
<p>Use the interactive XQuery form in the context of <em>hfagc_system</em> collection</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://130.87.106.59:9090/xmldb/db/hfagc_system/">http://130.87.106.59:9090/xmldb/db/hfagc_system/</a></li>
</ul>
</div></blockquote>
<p>To grab the indexed SVG labels:</p>
<div class="highlight-python"><pre>doc("qtag2svgs.xml")//qtag[@value='BR:-521:-321,221,443']
doc("qtag2svgs.xml")//qtag[@value='BR:-521:-321,221,443']/svgs/label/*[1]     (: grabs the svg:g elem :)
doc("qtag2svgs.xml")//qtag[@value='BR:-521:-321,221,443']/svgs/sabel/*[1]     (: grabs the svg:g elem :)</pre>
</div>
<p>Observations on the SVG:</p>
<ol class="arabic simple">
<li>absolute path data for each bezier curved glyph has x y ranges in ballpark -9 to +9, maybe ordinary character point size units</li>
<li>crazy large +ve y (down) translation is apparent</li>
</ol>
<div class="highlight-python"><pre>&lt;svg:g exist:id ="14831" exist:source ="/db/hfagc_system/qtag2svgs.xml" id ="slBR_-521_-321+221+443" transform ="translate(154.963,6734.518)" &gt;
     &lt;svg:defs &gt;
         &lt;svg:path d ="M5.7 -3.324C5.76 -3.564 5.796 -3.708 5.796 -4.032C5.796 -4.752 5.376 -5.292 4.464 -5.292C3.396 -5.292 2.832 -4.536 2.616 -4.236C2.58 ....
         ...
     &lt;/svg:defs &gt;
     &lt;svg:g id ="slBR_-521_-321+221+443_page1" transform ="matrix(0.996264 0 0 0.996264 0 0)" &gt;

         &lt;svg:use x ="56.6248" y ="66" xlink:href ="#slBR_-521_-321+221+443_g0-74" /&gt;
         &lt;svg:use x ="63.5776" y ="66" xlink:href ="#slBR_-521_-321+221+443_g0-61" /&gt;

         &lt;svg:use x ="69.4525" y ="66" xlink:href ="#slBR_-521_-321+221+443_g0-32" /&gt;
         &lt;svg:use x ="77.5219" y ="66" xlink:href ="#slBR_-521_-321+221+443_g1-40" /&gt;
         &lt;svg:use x ="82.0913" y ="66" xlink:href ="#slBR_-521_-321+221+443_g1-49" /&gt;
         &lt;svg:use x ="87.9662" y ="66" xlink:href ="#slBR_-521_-321+221+443_g0-83" /&gt;
         &lt;svg:use x ="95.8911" y ="66" xlink:href ="#slBR_-521_-321+221+443_g1-41" /&gt;
         &lt;svg:use x ="100.461" y ="66" xlink:href ="#slBR_-521_-321+221+443_g0-17" /&gt;
         &lt;svg:use x ="106.688" y ="66" xlink:href ="#slBR_-521_-321+221+443_g0-75" /&gt;
         &lt;svg:use x ="117.547" y ="61.6453" xlink:href ="#slBR_-521_-321+221+443_g2-0" /&gt;
     &lt;/svg:g&gt;
 &lt;/svg:g&gt;</pre>
</div>
</div>
<div class="section" id="check-origin-svg-from-dvisvgm">
<h3>Check Origin SVG from dvisvgm<a class="headerlink" href="#check-origin-svg-from-dvisvgm" title="Permalink to this headline">¶</a></h3>
<p><cite>/Users/heprez/data/data/images/qtags/svg_nofonts/slBR_-521_-321+221+443.svg</cite></p>
<div class="highlight-python"><pre>&lt;?xml version='1.0' encoding='ISO-8859-1'?&gt;
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
&lt;!-- This file was generated by dvisvgm 1.3 (x86_64-apple-darwin11.4.0) --&gt;
&lt;!-- Mon Jun 24 12:24:51 2013 --&gt;
&lt;svg height='12.1425pt' version='1.1' viewBox='56.4133 56.5997 67.2806 12.1425' width='67.2806pt' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'&gt;
&lt;defs&gt;
&lt;path d='M5.7 -3.324C5.76 -3.564 5.796 -3.708 5.796 ...

&lt;path d='M5.592 -1.816C5.72 -1.816 5.896 -1.816 5.896 -2S5.72 -2.184 5.592 -2.184H1.008C0.88 -2.184 0.704 -2.184 0.704 -2S0.88 -1.816 1.008 -1.816H5.592Z' id='g2-0'/&gt;
&lt;/defs&gt;
&lt;g id='page1' transform='matrix(0.996264 0 0 0.996264 0 0)'&gt;
&lt;use x='56.6248' xlink:href='#g0-74' y='66'/&gt;
&lt;use x='63.5776' xlink:href='#g0-61' y='66'/&gt;
&lt;use x='69.4525' xlink:href='#g0-32' y='66'/&gt;
&lt;use x='77.5219' xlink:href='#g1-40' y='66'/&gt;
&lt;use x='82.0913' xlink:href='#g1-49' y='66'/&gt;
&lt;use x='87.9662' xlink:href='#g0-83' y='66'/&gt;
&lt;use x='95.8911' xlink:href='#g1-41' y='66'/&gt;
&lt;use x='100.461' xlink:href='#g0-17' y='66'/&gt;
&lt;use x='106.688' xlink:href='#g0-75' y='66'/&gt;
&lt;use x='117.547' xlink:href='#g2-0' y='61.6453'/&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>
</div>
<div class="section" id="centering-the-label">
<h3>Centering the label<a class="headerlink" href="#centering-the-label" title="Permalink to this headline">¶</a></h3>
<p>Taking <cite>/Users/heprez/data/data/images/qtags/svg_nofonts/slBR_-511_-311+83xoBR_-521_-321+83.svg</cite>:</p>
<div class="highlight-python"><pre>&lt;svg height='18.3592pt' version='1.1' viewBox='57.6088 53.7982 44.272 18.3592' width='44.272pt' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'&gt;
&lt;defs&gt;
    ...
&lt;/defs&gt;
&lt;g id='centering' transform='translate(-57.6088,-53.7982)'&gt;
&lt;g id='page1' transform='matrix(0.996264 0 0 0.996264 0 0)'&gt;
   &lt;path id='bbox' d="M57.6088 53.7982 h 44.272 v 18.3592 h -44.272 z" fill="none" stroke="blue" /&gt;
   &lt;use x='58.8804' xlink:href='#g0-89' y='60.69'/&gt;
   &lt;use x='65.6958' xlink:href='#g1-40' y='60.69'/&gt;
   ...
&lt;/g&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>
<p>The <em>centering</em> group and <em>bbox</em> path are based on the <em>viewBox</em> numbers.
Instead of crazy gridification, applying such transforms at <em>svgsmry</em> stage can avoid the kludge
constant offset.</p>
</div>
<div class="section" id="check-the-summary">
<h3>Check the summary<a class="headerlink" href="#check-the-summary" title="Permalink to this headline">¶</a></h3>
<p>Use the interactive XQuery form in the context of <em>hfagc_system</em> collection</p>
<ul class="simple">
<li><a class="reference external" href="http://130.87.106.59:9090/xmldb/db/hfagc_system/">http://130.87.106.59:9090/xmldb/db/hfagc_system/</a></li>
</ul>
<div class="highlight-python"><pre>declare namespace svg="http://www.w3.org/2000/svg" ;
doc("svg-summary.xml")//svg:g[@id='slBR_-521_-321+221+443']</pre>
</div>
<p>The big transforms hail from back in during summary creation (set by the gridification done in summary creation):</p>
<div class="highlight-python"><pre>&lt;svg:g exist:id ="1540" exist:source ="/db/hfagc_system/svg-summary.xml" id ="slBR_-521_-321+221+443" transform ="translate(154.963,6734.518)" &gt;
  &lt;svg:defs &gt;
     &lt;svg:path d ="M5.7 -3.324C5.76 -3.564 5....</pre>
</div>
</div>
<div class="section" id="kludge-with-fixed-transform-modifying-query">
<h3>Kludge with fixed transform modifying query<a class="headerlink" href="#kludge-with-fixed-transform-modifying-query" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://130.87.106.59:9090/xmldb/db/hfagc_system/">http://130.87.106.59:9090/xmldb/db/hfagc_system/</a></li>
</ul>
<p>Grab the <em>svg:g</em> content and construct new <em>svg:g</em> without the transform attribute:</p>
<div class="highlight-python"><pre>declare namespace svg="http://www.w3.org/2000/svg" ;

let $qt := 'BR:-521:-321,221,443'
let $g := doc("qtag2svgs.xml")//qtag[@value=$qt]/svgs/sabel/svg:g[1]
return
       &lt;svg:g&gt;
           {
              attribute id {$g/@id}
              ,
              $g/*
           }
       &lt;/svg:g&gt;</pre>
</div>
</div>
<div class="section" id="kludge-fixed-offset">
<h3>Kludge fixed offset<a class="headerlink" href="#kludge-fixed-offset" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>1620 declare function rezs:qt2svglabel( $qt as xs:string , $opt as xs:string ) as element() {
1621     let $g := doc($rezs:qtag2svgs_index)//qtag[@value=$qt]/svgs/label/svg:g[1]
1622     let $transform := "translate(0,-66)"
1623     return
1624            &lt;svg:g&gt;
1625            {
1626               attribute id {$g/@id}
1627               ,
1628               attribute transform {$transform}
1629               ,
1630               $g/*
1631            }
1632            &lt;/svg:g&gt;
1633 };
1634
1635 declare function rezs:qt2svgsabel( $qt as xs:string , $opt as xs:string ) as element() {
1636     let $g := doc($rezs:qtag2svgs_index)//qtag[@value=$qt]/svgs/sabel/svg:g[1]
1637     let $transform := "translate(0,-66)"
1638     return
1639            &lt;svg:g&gt;
1640            {
1641               attribute id {$g/@id}
1642               ,
1643               attribute transform {$transform}
1644               ,
1645               $g/*
1646            }
1647            &lt;/svg:g&gt;
1648 };
1649</pre>
</div>
</div>
<div class="section" id="check-old-function">
<h3>Check old function<a class="headerlink" href="#check-old-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>import module namespace rezs = "http://hfag.phys.ntu.edu.tw/hfagc/rezs" at "webapp/hfagc/xquery/rezs.xqm" ;
let $qt := 'BR:-521:-321,221,443'
return
      rezs:qt2svgsabel( $qt, "" )</pre>
</div>
</div>
<div class="section" id="add-new-function">
<h3>Add new function<a class="headerlink" href="#add-new-function" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><a class="reference external" href="http://dayabay.phys.ntu.edu.tw/tracs/heprez/intertrac/r908">heprez:r908</a></p>
</li>
<li><p class="first">propagate:</p>
<div class="highlight-python"><pre>b2mc:h heprez$ exist-up webapp/hfagc trial      # observe non-propagated D0 addition as well as the modified label funcs</pre>
</div>
</li>
</ul>
<p>Testing on dynamic plot URL, shows the label positions are now in the ball park</p>
<ul class="simple">
<li><a class="reference external" href="http://130.87.106.59:9090/hfagc/01114/plot/svg">http://130.87.106.59:9090/hfagc/01114/plot/svg</a></li>
<li><a class="reference external" href="http://130.87.106.59:9090/hfagc/01214/plot/svg">http://130.87.106.59:9090/hfagc/01214/plot/svg</a></li>
</ul>
<p>Grab from afar:</p>
<div class="highlight-python"><pre>simon:k blyth$ curl -s --socks5 localhost:9090 http://130.87.106.59:9090/hfagc/01114/plot/svg -o 01114.svg
simon:k blyth$ open 01114.svg
simon:k blyth$ curl -s --socks5 localhost:9090 http://130.87.106.59:9090/hfagc/01214/plot/svg -o 01214.svg
simon:k blyth$ xmllint --format  01214.svg</pre>
</div>
</div>
</div>
<div class="section" id="svg-path">
<h2>SVG PATH<a class="headerlink" href="#svg-path" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.w3.org/TR/SVG/paths.html#Introduction">http://www.w3.org/TR/SVG/paths.html#Introduction</a></li>
<li><a class="reference external" href="http://www.w3.org/TR/SVG/paths.html#PathData">http://www.w3.org/TR/SVG/paths.html#PathData</a>  the value of the <em>d</em> attribute is PathData</li>
</ul>
<dl class="docutils">
<dt><em>M (x y)+</em></dt>
<dd>moveto absolute</dd>
<dt><em>C (x1 y1 x2 y2 x y)+</em></dt>
<dd>curveto absolute</dd>
<dt><em>S (x2 y2 x y)+</em></dt>
<dd>smooth curveto absolute</dd>
<dt><em>L (x y)+</em></dt>
<dd>lineto absolute</dd>
<dt><em>Z</em></dt>
<dd>closepath</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../scrape/" title="scrape"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="svg"
             >previous</a> |</li>
        <li><a href="../../">Heprez Unversioned directory documentation</a> &raquo;</li>
          <li><a href="../" >svg</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>