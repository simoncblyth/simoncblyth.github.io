<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Progress &mdash; OpticksDevNotes 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="OpticksDevNotes 0.0.1 documentation" href="index.html" />
    <link rel="next" title="Ideas" href="ideas.html" />
    <link rel="prev" title="Opticks Abstracts" href="abstracts.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ideas.html" title="Ideas"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="abstracts.html" title="Opticks Abstracts"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Progress</a><ul>
<li><a class="reference internal" href="#december">2017 December</a></li>
<li><a class="reference internal" href="#november">2017 November</a></li>
<li><a class="reference internal" href="#october">2017 October</a></li>
<li><a class="reference internal" href="#september">2017 September</a><ul>
<li><a class="reference internal" href="#big-geometry">Big Geometry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#august-ellipsoid-torus-solve-quartic-troubles-hyperboloid-sor">2017 August : ellipsoid, torus solve-quartic troubles, hyperboloid, SOR</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#solids">Solids</a></li>
<li><a class="reference internal" href="#id1">Big Geometry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#july-solid-level-bbox-validations-via-and-fixes">2017 July : Solid level bbox Validations via  and fixes</a><ul>
<li><a class="reference internal" href="#id2">Solids</a></li>
<li><a class="reference internal" href="#validation-machinery-for-comparison-g4dae-vs-gdml-gltf-geometries">Validation : machinery for comparison G4DAE vs GDML/glTF geometries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#june-tapering-poly-dev-tree-balancing-build-out-validation-machinery-uncoincidence">2017 June : tapering poly dev, tree balancing, build out validation machinery, uncoincidence</a><ul>
<li><a class="reference internal" href="#polygonization-move-on-hy-poly-taking-too-long">Polygonization : move on HY poly taking too long</a></li>
<li><a class="reference internal" href="#solids-analytic-bbox-combination-tree-balancing-positivize-ndisc">Solids : analytic bbox combination, tree balancing positivize, ndisc</a></li>
<li><a class="reference internal" href="#structure">Structure</a></li>
<li><a class="reference internal" href="#validation-intersect-point-sdf-sdf-scanning-containment-child-surf-vs-parent-sdf">Validation : intersect point SDF, SDF scanning, containment(child surf vs parent SDF)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#may-last-primitive-trapezoid-convexpolyhedron-tree-balancing-hybrid-poly-scene-structure">2017 May : last primitive (trapezoid/convexpolyhedron), tree balancing, hybrid poly, scene structure</a><ul>
<li><a class="reference internal" href="#solids-trapezoid-nconvexpolyhedron-tree-balancing">Solids : trapezoid, nconvexpolyhedron : tree balancing</a></li>
<li><a class="reference internal" href="#polygonization-hybrid-implicit-parametric">Polygonization : hybrid implicit/parametric</a></li>
<li><a class="reference internal" href="#structure-gltf-transport">Structure : gltf transport</a></li>
</ul>
</li>
<li><a class="reference internal" href="#apr-faster-im-poly-lots-of-primitives-bit-twiddle-postorder-pushes-height-limit-start-with-gdml">2017 Apr : faster IM poly, lots of primitives, bit twiddle postorder pushes height limit, start with GDML</a><ul>
<li><a class="reference internal" href="#polygonization">Polygonization</a></li>
<li><a class="reference internal" href="#solids-lots-of-new-primitives-ncylinder-nzsphere-ncone-box3">Solids : lots of new primitives ncylinder, nzsphere, ncone, box3</a></li>
<li><a class="reference internal" href="#csg-engine-bit-twiddle-postorder">CSG Engine : bit twiddle postorder</a></li>
<li><a class="reference internal" href="#structure-jump-ship-to-gdml">Structure : jump ship to GDML</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mar-gpu-csg-raytracing-implementation-sdf-modelling-mc-and-dcs-polygonization-of-csg-trees">2017 Mar : GPU CSG raytracing implementation, SDF modelling, MC and DCS polygonization of CSG trees</a><ul>
<li><a class="reference internal" href="#csg-engine-reiteration">CSG Engine : reiteration</a></li>
<li><a class="reference internal" href="#solids-implicit-modelling-with-sdfs">Solids : implicit modelling with SDFs</a></li>
<li><a class="reference internal" href="#polygonization-marching-cubes-dual-contouring">Polygonization : Marching Cubes, Dual Contouring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#feb-gpu-csg-raytracing-prototyping">2017 Feb : GPU CSG raytracing prototyping</a><ul>
<li><a class="reference internal" href="#csg-engine-python-prototyping-recursive-into-iterative">CSG Engine : python prototyping, recursive into iterative</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jan-presentations-proceedings-holidays">2017 Jan : presentations, proceedings, holidays</a></li>
<li><a class="reference internal" href="#dec-g4gun-csg-research">2016 Dec : g4gun, CSG research</a></li>
<li><a class="reference internal" href="#nov-g4-opticks-optical-physics-chisq-minimization">2016 Nov : G4/Opticks optical physics chisq minimization</a></li>
<li><a class="reference internal" href="#oct-g4-opticks-optical-physics-chisq-minimization">2016 Oct : G4/Opticks optical physics chisq minimization</a></li>
<li><a class="reference internal" href="#sep-mostly-g4-opticks-interop">2016 Sep : mostly G4/Opticks interop</a></li>
<li><a class="reference internal" href="#aug-opticksevent-handling-high-level-app-restructure-along-lines-of-dependency">2016 Aug : OpticksEvent handling, high level app restructure along lines of dependency</a></li>
<li><a class="reference internal" href="#jul-porting-to-windows-and-linux-linux-interop-debug">2016 Jul : porting to Windows and Linux, Linux interop debug</a></li>
<li><a class="reference internal" href="#jun-porting-to-windows">2016 Jun : porting to Windows</a></li>
<li><a class="reference internal" href="#may-ctests-cfg4-gdml-handling-non-gpu-photon-indexing">2016 May : CTests, CFG4 GDML handling, non-GPU photon indexing</a></li>
<li><a class="reference internal" href="#apr-build-structure-make-to-cmake-superbuild-spawn-opticks-repo">2016 Apr : build structure make to CMake superbuild, spawn Opticks repo</a></li>
<li><a class="reference internal" href="#mar-opticks-g4-pmt-matching-gpu-textures-making-movie">2016 Mar : Opticks/G4 PMT matching, GPU textures, making movie</a></li>
<li><a class="reference internal" href="#feb-partitioned-analytic-geometry-compositing-raytrace-and-rasterized-viz">2016 Feb : partitioned analytic geometry, compositing raytrace and rasterized viz</a></li>
<li><a class="reference internal" href="#jan-bookmarks-viewpoint-animation-presentations">2016 Jan : Bookmarks, viewpoint animation, presentations</a></li>
<li><a class="reference internal" href="#dec-matching-against-theory-for-prism-rainbow">2015 Dec : matching against theory for prism, rainbow</a></li>
<li><a class="reference internal" href="#nov-refactor-for-dynamic-boundaries-fresnel-reflection-matching-pmt-uncoincidence">2015 Nov : refactor for dynamic boundaries, Fresnel reflection matching, PMT uncoincidence</a></li>
<li><a class="reference internal" href="#oct-meshfixing-instanced-identity-start-analytic-partitioning">2015 Oct : meshfixing, instanced identity, start analytic partitioning</a></li>
<li><a class="reference internal" href="#sep-thrust-for-gpu-resident-photons-openmesh-for-meshfixing">2015 Sep : thrust for GPU resident photons, OpenMesh for meshfixing</a></li>
<li><a class="reference internal" href="#aug-big-geometry-handling-with-instancing">2015 Aug : big geometry handling with Instancing</a></li>
<li><a class="reference internal" href="#jul-photon-index-propagation-histories-linux-port">2015 Jul : photon index, propagation histories, Linux port</a></li>
<li><a class="reference internal" href="#jun-develop-compressed-photon-record-learn-thrust">2015 Jun : develop compressed photon record, learn Thrust</a></li>
<li><a class="reference internal" href="#may-gpu-textures-for-materials-geocache-imgui">2015 May : GPU textures for materials, geocache, ImGui</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="abstracts.html"
                        title="previous chapter">Opticks Abstracts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ideas.html"
                        title="next chapter">Ideas</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/progress.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="progress">
<h1>Progress<a class="headerlink" href="#progress" title="Permalink to this headline">¶</a></h1>
<p>Use <em>hg-month n</em> to review commits for the numbered month,
negative n eg -12 for December of last year.</p>
<p>Dont use colons in section text for easy title grepping.</p>
<div class="section" id="december">
<h2>2017 December<a class="headerlink" href="#december" title="Permalink to this headline">¶</a></h2>
<p><strong>Aim : &#8220;&#8211;align&#8221; mode, taming randomness for perfectly aligned bi-simulation</strong></p>
<ul class="simple">
<li>investigate approaches allowing use of the same RNG sequence with Opticks and Geant4<ul>
<li>if this turns out to be possible, can expect perfect (float precision level) matching</li>
<li>would be an extremely powerful debugging tool, problems will then be directly apparent</li>
</ul>
</li>
<li>add diffuse emitters for testing all angle incidence</li>
<li>rework specular reflection to match Geant4, fixing polarization discrepancy</li>
</ul>
</div>
<div class="section" id="november">
<h2>2017 November<a class="headerlink" href="#november" title="Permalink to this headline">¶</a></h2>
<p><strong>Focus : Improving automation/depth of integration testing</strong></p>
<ul class="simple">
<li>work with LZ user, on AssimpImporter issue</li>
<li>introduce &#8220;&#8211;reflectcheat&#8221; so photons can stay aligned thru BR/SR</li>
<li>direct point-by-point deviation comparisons, for use with common input photons,
photons stay aligned until meet RNG (eg from BR/SR/SC/AB)</li>
<li>introduce &#8220;&#8211;testauto&#8221; mode that dynamically changes surfaces (simplifying photon histories)
allowing checks of intersect positions against SDFs without duplicating all the ~50 integration test
geometries</li>
<li>introduce G4 only universe wrapper volume, to reconcile the boundary-vs-volume
model difference between G4 and Opticks</li>
<li>get bounce truncation to match between Opticks and CFG4, eg for hall-of-mirrors situation</li>
<li>reimplement the cfg4/CRecorder monolith into many pieces including CG4Ctx for better clarity</li>
<li>translation of optical surfaces to Geant4 motivates a reworking of surface geometry
representation, enhanced persisting simplifies processing and conversion to Geant4</li>
</ul>
</div>
<div class="section" id="october">
<h2>2017 October<a class="headerlink" href="#october" title="Permalink to this headline">¶</a></h2>
<p><strong>Focus : push analytic NCSG throughout the Opticks processing/validation chain</strong></p>
<ul class="simple">
<li>enable any CSG solid to emit test photons, generated CPU side such that
Opticks and Geant4 simulations are given exactly the same input photons</li>
<li>pushed Opticks analytic geometry support thru to okg4, allowing Opticks test geometries to
be auto-converted to Geant4 ones : for okg4 comparisons</li>
<li>Opticks integration testing : automate comparison of intersect positions with geometry SDF values</li>
<li>debugged Opticks installs on two new Linux distros, Axel desktop, Shandong headless GPU server</li>
<li>presenting Opticks to the plenary session of the Geant4 Collaboration Meeting in Australia</li>
</ul>
</div>
<div class="section" id="september">
<h2>2017 September<a class="headerlink" href="#september" title="Permalink to this headline">¶</a></h2>
<p><strong>Focus : embedded application of Opticks</strong></p>
<ul class="simple">
<li>work on some techniques to use Opticks on headless GPU server machines,
such as combining pure compute raytrace geometry snapshots into mp4 movies</li>
<li>work with Tao on Opticks/JUNO embedding</li>
<li>implement embedded mode of Opticks operation using okop/OpMgr to run
inside another process, such as JUNO offline</li>
<li>introduce okop/OpMgr (pure compute Opticks manager)
and usage on headless GPU servers</li>
</ul>
<div class="section" id="big-geometry">
<h3>Big Geometry<a class="headerlink" href="#big-geometry" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Eureka : avoiding having two InstLODCull active regains sanity, with this proviso frustum culling and LOD forking are both working</li>
<li>InstLODCull simplifications from moving uniform handling to UBO in RContext</li>
</ul>
</div>
</div>
<div class="section" id="august-ellipsoid-torus-solve-quartic-troubles-hyperboloid-sor">
<h2>2017 August : ellipsoid, torus solve-quartic troubles, hyperboloid, SOR<a class="headerlink" href="#august-ellipsoid-torus-solve-quartic-troubles-hyperboloid-sor" title="Permalink to this headline">¶</a></h2>
<p><strong>Focus : tricky primitives</strong></p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">implemented the primitives needed for JUNO : torus was difficult, also
implemented hyperboloid  : perhaps we can look into replacing torus with
hyperboloid for the PMT (it is much much easier computationally: just quadratics rather than quartics)</p>
</li>
<li><p class="first">moved analytic geometry processing pre-cache : so launch time is
reduced from ~50 s to &lt; 5 s</p>
</li>
<li><p class="first">improved OpenGL visualisation performance using
instance frustum culling and variable level-of-detail meshes for instances (=PMTs) based on
distance to the instance.  These techniques use GPU compute (OpenGL transform feedback)
prior to rendering each frame to skip instances that are not visible and replace distant instances with simpler
geometry.   The improved performance will make it much easier to capture movies…</p>
<p>As Macs only go to OpenGL 4.1 : I am limited to techniques available to that version
which means no OpenGL compute shaders.  I could of use CUDA interop techniques but
if possible it is better to stick with OpenGL for visualisation as that  can work on AMD
(and perhaps even Intel) GPUs, meaning much more users can benefit from it.</p>
</li>
</ul>
</div>
<div class="section" id="solids">
<h3>Solids<a class="headerlink" href="#solids" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>using doubles for quartic/cubic Solve now seems inevitable, issues are much reduced with doubles but not entirely fixed</li>
<li>op &#8211;j1707 &#8211;gltf 3 : fully analytic raytrace works, not having any triangles saves gobs of GPU memory : investigate ways to skip torus intersects</li>
<li>start on hyperbolic hyperboloid of one sheet, hope to model PMT neck with hyperboloid rather than subtracted torus</li>
<li>torus artifacts gone, after move SolveCubicStrobachPolyFit to use initial gamma using SolveCubicPolyDivision instead of the cursed SolveCubicNumeric</li>
</ul>
</div>
<div class="section" id="id1">
<h3>Big Geometry<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>investigate OpenGL LOD and Culling for coping with big geometry</li>
<li>start checking whats needed to enable instance culling, over in  env- instcull-</li>
<li>moving analytic GScene into geocache fixes j1707 slow startup, reducing from 50 secs to under 5 secs</li>
<li>threading LODified meshes thru GGeoLib/GGeoTest</li>
<li>prep for bringing dynamic GPU LOD fork+frustum culling like env- instcull- into oglrap-, plan to use first class citizen RBuf (of Renderer) to simplify the buffer juggling</li>
</ul>
</div>
</div>
<div class="section" id="july-solid-level-bbox-validations-via-and-fixes">
<h2>2017 July : Solid level bbox Validations via  and fixes<a class="headerlink" href="#july-solid-level-bbox-validations-via-and-fixes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Solids<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>fix trapezoid misinterpretation (caused impingment) using new unplaced mesh dumping features added to both branches</li>
<li>fixed cone-z misinterpretation</li>
<li>added deltaphi imp via CSG_SEGMENT intersect, tboolean-cyslab tboolean-segment</li>
<li>start on primitives needed for juno1707</li>
<li>add zcut ellipsoid by using zsphere with scaling adjusted to be 1 for z</li>
<li>investigate torus artifacts, by looking into cubic approach</li>
</ul>
</div>
<div class="section" id="validation-machinery-for-comparison-g4dae-vs-gdml-gltf-geometries">
<h3>Validation : machinery for comparison G4DAE vs GDML/glTF geometries<a class="headerlink" href="#validation-machinery-for-comparison-g4dae-vs-gdml-gltf-geometries" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>generalize GMeshLib to work in analytic and non-analytic branches, regularize GNodeLib to follow same persistency/reldir pattern</li>
<li>factor GMeshLib out of GGeo and add pre-placed base solid mesh persisting into/from geocache, see GMeshLibTest and &#8211;gmeshlib option</li>
<li>get nnode_test_cpp.py codegen to work with nconvexpolyhedron primitives defined by planes and bbox</li>
<li>impingement debug by comparison of GDML/glTF and G4DAE branches</li>
<li>comparing GMesh bbox between branches, reveals lots of discrepancies : GScene_compareMeshes.rst</li>
<li>bbox comparisons are productive : cone-z misinterp, missing tube deltaphi</li>
<li>csg composite/prim bbox avoids polyfail noise reduces discrepant meshes to 12 percent</li>
<li>moving to parsurf bbox, avoids overlarge analytic bbox with complicated CSG trees</li>
<li>adopting adaptive parsurf_level to reach a parsurf_target number of surface points knocks 5 lvidx down the chart</li>
<li>complete classification of top 25 parsurf vs g4poly bbox discrepancies, down to 1mm</li>
</ul>
</div>
</div>
<div class="section" id="june-tapering-poly-dev-tree-balancing-build-out-validation-machinery-uncoincidence">
<h2>2017 June : tapering poly dev, tree balancing, build out validation machinery, uncoincidence<a class="headerlink" href="#june-tapering-poly-dev-tree-balancing-build-out-validation-machinery-uncoincidence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="polygonization-move-on-hy-poly-taking-too-long">
<h3>Polygonization : move on HY poly taking too long<a class="headerlink" href="#polygonization-move-on-hy-poly-taking-too-long" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>try subdivide border tris approach to boolean mesh combination, tboolean-hyctrl</li>
<li>decide to proceed regardless despite subdiv problems, forming a zippering approach</li>
</ul>
</div>
<div class="section" id="solids-analytic-bbox-combination-tree-balancing-positivize-ndisc">
<h3>Solids : analytic bbox combination, tree balancing positivize, ndisc<a class="headerlink" href="#solids-analytic-bbox-combination-tree-balancing-positivize-ndisc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>nbbox::CombineCSG avoids the crazy large bbox</li>
<li>CSG.subdepth to attempt tree balancing by rotation, swapping left right of UNION and INTERSECTIN nodes when that would improve balance</li>
<li>honouring the complement in bbox and sdf, testing with tboolean-positivize</li>
<li>checking deep csg trees with tboolean-sc</li>
<li>nbox::nudge finding coincident surfaces in CSG difference and nudging them to avoid the speckled ghost surface issues</li>
<li>tboolean-uncoincide for debugging uncoincide failure</li>
<li>tboolean-esr : investigate ESR speckles and pole artifacting, from degenerate cylinder</li>
<li>add disc primitive tboolean-disc as degenerate cylinder replacement</li>
<li>make CSG_DISC work as a CSG subobject in boolean expressions by adding otherside intersects and rigidly oriented normals</li>
<li>mono bileaf CSG tree balancing to handle mixed deep trees, used for unions of cylinders with inners done via subtraction</li>
</ul>
</div>
<div class="section" id="structure">
<h3>Structure<a class="headerlink" href="#structure" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>completed transfer of node identity, boundary and sensor info, from triangulated G4DAE to analytic GDML/glTF branches in GScene</li>
<li>moving to absolute tree handling in gltf with selection mask gets steering of the branches much closer</li>
</ul>
</div>
<div class="section" id="validation-intersect-point-sdf-sdf-scanning-containment-child-surf-vs-parent-sdf">
<h3>Validation : intersect point SDF, SDF scanning, containment(child surf vs parent SDF)<a class="headerlink" href="#validation-intersect-point-sdf-sdf-scanning-containment-child-surf-vs-parent-sdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>factor GNodeLib out of GGeo to avoid duplication between GScene and GGeo, aiming to allow comparison of triangulated and analytic node trees</li>
<li>node names and order from full geometry traversals in analytic and triangulated branches are matching, see ana/nodelib.py</li>
<li>analytic geometry shakedown begins</li>
<li>prep automated intersect debug by passing OpticksEvent down from OpticksHub into GScene::debugNodeIntersects</li>
<li>autoscan all CSG trees looking for internal SDF zeros</li>
<li>tablulate zero crossing results for all trees, odd crossings almost all unions, no-crossing mostly subtraction</li>
<li>NScanTest not outside issue fixed via minimum absolute cage delta, all the approx 10 odd crossings CSG trees are cy/cy or cy/co unions in need of uncoincidence nudges</li>
<li>expand parametric surface coverage to most primitives, for object-object coincidence testing of bbox hinted coincidences</li>
<li>nnode::getCompositePoints collecting points on composite CSG solid surface using nnode::selectBySDF on the parametric points of the primitives</li>
<li>NScene::check_surf_points classifying node surface points against parent node SDF reveals many small coincidence/impingement issues</li>
<li>avoiding precision issues in node/parent collision (coincidence/impingement) by using parent frame does not make issue go away</li>
</ul>
</div>
</div>
<div class="section" id="may-last-primitive-trapezoid-convexpolyhedron-tree-balancing-hybrid-poly-scene-structure">
<h2>2017 May : last primitive (trapezoid/convexpolyhedron), tree balancing, hybrid poly, scene structure<a class="headerlink" href="#may-last-primitive-trapezoid-convexpolyhedron-tree-balancing-hybrid-poly-scene-structure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="solids-trapezoid-nconvexpolyhedron-tree-balancing">
<h3>Solids : trapezoid, nconvexpolyhedron : tree balancing<a class="headerlink" href="#solids-trapezoid-nconvexpolyhedron-tree-balancing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>tboolean-trapezoid : trapezoid, nconvexpolyhedron</li>
<li>nconvexpolyhedron referencing sets of planes just like transforms referencing</li>
<li>icosahedron check</li>
<li>investigate 22 deep CSG solids with binary tree height greater than 3 in DYB near geometry</li>
<li>implement complemented primitives : thru the chain from python CSG into npy NCSG, NNode, NPart and on into oxrap csg_intersect_part</li>
<li>Tubs with inner radius needs an inner nudge, making the inner subtracted cylinder slightly thicker than the outer one</li>
<li>handling poles and seams in sphere parametrisation</li>
</ul>
</div>
<div class="section" id="polygonization-hybrid-implicit-parametric">
<h3>Polygonization : hybrid implicit/parametric<a class="headerlink" href="#polygonization-hybrid-implicit-parametric" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>start HY : hybrid implicit/parametric polygonization</li>
<li>parametric primitive meshing with NHybridMesher code HY, test with tboolean-hybrid</li>
<li>try subdivide border tris approach to boolean mesh combinatio</li>
<li>adopt centroid splitting succeeds to stay manifold</li>
</ul>
</div>
<div class="section" id="structure-gltf-transport">
<h3>Structure : gltf transport<a class="headerlink" href="#structure-gltf-transport" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>start on GPU scene conversion sc.py, gltf, NScene, GScene</li>
<li>booting analytic gdml/gltf root from gdml snippets with tgltf-</li>
<li>repeat candidate finding/using (ie instanced analytic and polygonized subtrees) in NScene/GScene</li>
<li>integration with oyoctogl- : for gltf parsing</li>
<li>tgltf-gdml from oil maxdepth 3, now working with skipped overheight csg nodes (may 20th)</li>
</ul>
</div>
</div>
<div class="section" id="apr-faster-im-poly-lots-of-primitives-bit-twiddle-postorder-pushes-height-limit-start-with-gdml">
<h2>2017 Apr : faster IM poly, lots of primitives, bit twiddle postorder pushes height limit, start with GDML<a class="headerlink" href="#apr-faster-im-poly-lots-of-primitives-bit-twiddle-postorder-pushes-height-limit-start-with-gdml" title="Permalink to this headline">¶</a></h2>
<div class="section" id="polygonization">
<h3>Polygonization<a class="headerlink" href="#polygonization" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>integrate implicit mesher IM over a couple of days - much faster than MC or DCS
as uses continuation approach and produces prettier meshes</li>
<li>boot DCS out of Opticks into optional external</li>
<li>conclude polygonization fails for cathode and base are a limitation of current poly techniques,
need new approach to work with thin volumes, find candidate env-;csgparametric-</li>
</ul>
</div>
<div class="section" id="solids-lots-of-new-primitives-ncylinder-nzsphere-ncone-box3">
<h3>Solids : lots of new primitives ncylinder, nzsphere, ncone, box3<a class="headerlink" href="#solids-lots-of-new-primitives-ncylinder-nzsphere-ncone-box3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>start adding transform handling to the CSG tree</li>
<li>add scaling transform support, debug normal transforms</li>
<li>fix implicit assumption of normalized ray directions bug in sphere intersection</li>
<li>introduce python CSG geometry description into tboolean</li>
<li>implement ncylinder</li>
<li>implement nzsphere</li>
<li>implement ncone</li>
<li>implement CSG_BOX3</li>
<li>polycones as unions of cones and cylinders</li>
<li>start looking at CSG tree balancing</li>
</ul>
</div>
<div class="section" id="csg-engine-bit-twiddle-postorder">
<h3>CSG Engine : bit twiddle postorder<a class="headerlink" href="#csg-engine-bit-twiddle-postorder" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>remove CSG tree height limitation by adoption of bit twiddling postorder,
benefiting from morton code experience gained whilst debugging DCS Octree construction</li>
<li>attempts to use unbounded and open geometry as CSG sub-objects drives home
the theory behind CSG - S means SOLID, endcaps are not optional</li>
</ul>
</div>
<div class="section" id="structure-jump-ship-to-gdml">
<h3>Structure : jump ship to GDML<a class="headerlink" href="#structure-jump-ship-to-gdml" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>complete conversion of detdesc PMT into NCSG (no uncoincide yet)</li>
<li>conclude topdown detdesc parse too painful, jump ship to GDML</li>
<li>GDML parse turns out to be much easier</li>
<li>implement GDML tree querying to select general subtrees</li>
</ul>
</div>
</div>
<div class="section" id="mar-gpu-csg-raytracing-implementation-sdf-modelling-mc-and-dcs-polygonization-of-csg-trees">
<h2>2017 Mar : GPU CSG raytracing implementation, SDF modelling, MC and DCS polygonization of CSG trees<a class="headerlink" href="#mar-gpu-csg-raytracing-implementation-sdf-modelling-mc-and-dcs-polygonization-of-csg-trees" title="Permalink to this headline">¶</a></h2>
<div class="section" id="csg-engine-reiteration">
<h3>CSG Engine : reiteration<a class="headerlink" href="#csg-engine-reiteration" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>moving CSG python prototype to CUDA</li>
<li>reiteration, tree gymnastics</li>
<li>CSG stacks in CUDA</li>
<li>fix a real painful rare bug in tree reiteration</li>
</ul>
</div>
<div class="section" id="solids-implicit-modelling-with-sdfs">
<h3>Solids : implicit modelling with SDFs<a class="headerlink" href="#solids-implicit-modelling-with-sdfs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>OpticksCSG unification of type shape codes</li>
<li>learn geometry modelling with implicit functions, SDFs</li>
</ul>
</div>
<div class="section" id="polygonization-marching-cubes-dual-contouring">
<h3>Polygonization : Marching Cubes, Dual Contouring<a class="headerlink" href="#polygonization-marching-cubes-dual-contouring" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>start adding polygonization of CSG trees using SDF isosurface extraction</li>
<li>integrate marching cubes, MC</li>
<li>integrate dual contouring sample DCS, detour into getting Octree operational in acceptably performant,
painful at the time, by got real experience of z-order curves, multi-res and morton codes</li>
</ul>
</div>
</div>
<div class="section" id="feb-gpu-csg-raytracing-prototyping">
<h2>2017 Feb : GPU CSG raytracing prototyping<a class="headerlink" href="#feb-gpu-csg-raytracing-prototyping" title="Permalink to this headline">¶</a></h2>
<div class="section" id="csg-engine-python-prototyping-recursive-into-iterative">
<h3>CSG Engine : python prototyping, recursive into iterative<a class="headerlink" href="#csg-engine-python-prototyping-recursive-into-iterative" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>prototyping GPU CSG in python</li>
<li>Ulyanov iterative CSG paper pseudocode leads me astray</li>
<li>GPU binary tree serialization</li>
<li>adopt XRT boolean lookup tables</li>
<li>learn how to migrate recursive into iterative</li>
</ul>
</div>
</div>
<div class="section" id="jan-presentations-proceedings-holidays">
<h2>2017 Jan : presentations, proceedings, holidays<a class="headerlink" href="#jan-presentations-proceedings-holidays" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>CHEP meeting proceedings bulk of the writing</li>
<li>start looking at GPU CSG implementation</li>
<li>PSROC presentation</li>
<li>PHP</li>
</ul>
</div>
<div class="section" id="dec-g4gun-csg-research">
<h2>2016 Dec : g4gun, CSG research<a class="headerlink" href="#dec-g4gun-csg-research" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Paris trip, review</li>
<li>g4gun</li>
<li>CHEP proceedings</li>
<li>GPU CSG research</li>
</ul>
</div>
<div class="section" id="nov-g4-opticks-optical-physics-chisq-minimization">
<h2>2016 Nov : G4/Opticks optical physics chisq minimization<a class="headerlink" href="#nov-g4-opticks-optical-physics-chisq-minimization" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>scatter debug</li>
<li>groupvel debug</li>
<li>high volume histo chisq numpy comparisons machinery</li>
</ul>
</div>
<div class="section" id="oct-g4-opticks-optical-physics-chisq-minimization">
<h2>2016 Oct : G4/Opticks optical physics chisq minimization<a class="headerlink" href="#oct-g4-opticks-optical-physics-chisq-minimization" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>CHEP meeting</li>
<li>DYB optical physics including reemission teleported into cfg4</li>
<li>CRecorder - for tracing the G4 propagations in Opticks photon record format</li>
<li>reemission continuation handling, so G4 recorded propagations can be directly compared to opticks ones</li>
<li>step-by-step comparisons within the propagations</li>
<li>tlaser testing</li>
<li>tconcentric chisq guided iteration</li>
</ul>
</div>
<div class="section" id="sep-mostly-g4-opticks-interop">
<h2>2016 Sep : mostly G4/Opticks interop<a class="headerlink" href="#sep-mostly-g4-opticks-interop" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>encapsulate Geant4 into CG4</li>
<li>multievent handling rejig, looks to be mostly done in optixrap/OEvent.cc</li>
<li>intro OKMgr and OKG4Mgr the slimmed down replacements for the old App</li>
<li>Integrated Geant4/Opticks running allowing G4GUN steps to be directly Opticks GPU propagated</li>
<li>OptiX buffer control worked out for multi-event running, using buffer control flags system</li>
</ul>
</div>
<div class="section" id="aug-opticksevent-handling-high-level-app-restructure-along-lines-of-dependency">
<h2>2016 Aug : OpticksEvent handling, high level app restructure along lines of dependency<a class="headerlink" href="#aug-opticksevent-handling-high-level-app-restructure-along-lines-of-dependency" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>migration to OptiX 4.0.0 prompts adoption of buffer control system</li>
<li>texture handling reworked for 400</li>
<li>adopt cleaner OpticksEvent layout, with better containment</li>
<li>add OpticksMode (interop,compute,cfg4) to persisted OpticksEvent metadata</li>
<li>fix bizarre swarming photon visualization from noise in compressed buffer</li>
<li>adjust genstep handling to work with natural (mixed) Scintillation and Cerenkov gensteps</li>
<li>start app simplification refactoring with low hanging fruit of splitting up classes along
lines of dependency - intro OpticksHub (beneath viz, hostside config,geometry,event)
and OpticksViz</li>
<li>With eye towards future support for fully integrated but layered(for dendency flexibility)
Opticks/G4 running</li>
<li>take sledge hammer to the monolith App, pulling the pieces into separate classes, by dependency</li>
<li>rework for simultaneous Opticks, G4 simulation - OpticksEvent pairs held in OpticksHub</li>
<li>integration genstep handoff form G4 to Opticks</li>
</ul>
</div>
<div class="section" id="jul-porting-to-windows-and-linux-linux-interop-debug">
<h2>2016 Jul : porting to Windows and Linux, Linux interop debug<a class="headerlink" href="#jul-porting-to-windows-and-linux-linux-interop-debug" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>migrate logging from boostlog to PLOG, as works better on windows - it also turns out to be better overall</li>
<li>learning windows symbol export API approachs</li>
<li>succeed to get all non-CUDA/Thrust/OptiX packages to compile/run with windows VS2015</li>
<li>migrate Opticks from env into new opticks repository, mercurial history manipulations
allowed to bring over the relevant env history into opticks repo</li>
<li>porting to Linux and multi-user environment in prep for SDU Summer school</li>
<li>documenting Opticks and organizing the analysis scripts in prep for school</li>
<li>inconclusive attempts to address Linux interop buffer overwrite issue</li>
</ul>
</div>
<div class="section" id="jun-porting-to-windows">
<h2>2016 Jun : porting to Windows<a class="headerlink" href="#jun-porting-to-windows" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>replacing GCache with OpticksResource for wider applicability</li>
<li>port externals to Windows/MSYS2/MINGW64</li>
<li>move to using new repo opticksdata for sharing inputs</li>
<li>windows port stymied by g4 not supporting MSYS2/MINGW64</li>
<li>rejig to get glew, glfw, imgui, openmesh built and installed on windows with VS2015</li>
<li>boost too</li>
</ul>
</div>
<div class="section" id="may-ctests-cfg4-gdml-handling-non-gpu-photon-indexing">
<h2>2016 May : CTests, CFG4 GDML handling, non-GPU photon indexing<a class="headerlink" href="#may-ctests-cfg4-gdml-handling-non-gpu-photon-indexing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>shifts</li>
<li>getting more CTests to pass</li>
<li>bringing more packages into CMake superbuild</li>
<li>add CGDMLDetector</li>
<li>workaround lack of material MPT in vintage GDML, using G4DAE info</li>
<li>integrating with G4 using CG4</li>
<li>CPU Indexer and Sparse, for non-GPU node indexing</li>
<li>rework event data handling into OpticksEvent</li>
</ul>
</div>
<div class="section" id="apr-build-structure-make-to-cmake-superbuild-spawn-opticks-repo">
<h2>2016 Apr : build structure make to CMake superbuild, spawn Opticks repo<a class="headerlink" href="#apr-build-structure-make-to-cmake-superbuild-spawn-opticks-repo" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>GTC</li>
<li>factoring usage of OptiX to provide functionality on non-CUDA/OptiX capable nodes</li>
<li>CMake superbuild with CTests</li>
<li>external get/build/install scripts</li>
<li>prep for spawning Opticks repository</li>
</ul>
</div>
<div class="section" id="mar-opticks-g4-pmt-matching-gpu-textures-making-movie">
<h2>2016 Mar : Opticks/G4 PMT matching, GPU textures, making movie<a class="headerlink" href="#mar-opticks-g4-pmt-matching-gpu-textures-making-movie" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>resolved PMT skimmer BR BR vs BR BT issue - turned out to be Opticks TIR bug</li>
<li>PmtInBox step-by-step record distribution chi2 comparison</li>
<li>rejig material/surface/boundary buffer layout to match OptiX tex2d float4 textures, with wavelength samples and float4 at the tip of the array serialization</li>
<li>Dayabay presentation</li>
<li>screen capture movie making</li>
<li>GTC presentation</li>
</ul>
</div>
<div class="section" id="feb-partitioned-analytic-geometry-compositing-raytrace-and-rasterized-viz">
<h2>2016 Feb : partitioned analytic geometry, compositing raytrace and rasterized viz<a class="headerlink" href="#feb-partitioned-analytic-geometry-compositing-raytrace-and-rasterized-viz" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>create analytic geometry description of Dayabay PMT</li>
<li>PMTInBox debugging</li>
<li>compositing OptiX raytrace with OpenGL rasterized</li>
</ul>
</div>
<div class="section" id="jan-bookmarks-viewpoint-animation-presentations">
<h2>2016 Jan : Bookmarks, viewpoint animation, presentations<a class="headerlink" href="#jan-bookmarks-viewpoint-animation-presentations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>rework Bookmarks, split off state handling into NState</li>
<li>add InterpolatedView for viewpoint animation</li>
<li>JUNO meeting presentation</li>
<li>PSROC meeting presentation</li>
</ul>
</div>
<div class="section" id="dec-matching-against-theory-for-prism-rainbow">
<h2>2015 Dec : matching against theory for prism, rainbow<a class="headerlink" href="#dec-matching-against-theory-for-prism-rainbow" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>prism test with Plankian light source using GPU texture</li>
<li>rainbow comparisons against expectation</li>
<li>cfg4, new package for comparison against standalone geant4</li>
<li>cfg4 G4StepPoint recording - creating opticks format photon/step/history records with cfg4-</li>
<li>Opticks/Geant4 rainbow scatter matching achieved</li>
<li>enable loading of photons/records into ggv, in pricipal enables visualizing both Opticks and G4 cfg4- generated/propagated events on non-CUDA machines</li>
<li>begin revival of compute mode</li>
</ul>
</div>
<div class="section" id="nov-refactor-for-dynamic-boundaries-fresnel-reflection-matching-pmt-uncoincidence">
<h2>2015 Nov : refactor for dynamic boundaries, Fresnel reflection matching, PMT uncoincidence<a class="headerlink" href="#nov-refactor-for-dynamic-boundaries-fresnel-reflection-matching-pmt-uncoincidence" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>overhaul material/surface/boundary handling to allow dynamic boundary creation post geocache</li>
<li>implement dynamic test geometry creation controlled by commandline argument, using &#8220;&#8211;test&#8221; option</li>
<li>npy analysis for Fresnel reflection testing</li>
<li>adopt more rational PMT partitioning surfaces (not a direct translation)</li>
</ul>
</div>
<div class="section" id="oct-meshfixing-instanced-identity-start-analytic-partitioning">
<h2>2015 Oct : meshfixing, instanced identity, start analytic partitioning<a class="headerlink" href="#oct-meshfixing-instanced-identity-start-analytic-partitioning" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>vertex deduping as standard</li>
<li>IAV and OAV mesh surgery</li>
<li>sensor handling</li>
<li>identity with instancing</li>
<li>analytic geometry description of DYB PMT via detdesc parsing and geometrical partitioning</li>
<li>flexible boundary creation</li>
</ul>
</div>
<div class="section" id="sep-thrust-for-gpu-resident-photons-openmesh-for-meshfixing">
<h2>2015 Sep : thrust for GPU resident photons, OpenMesh for meshfixing<a class="headerlink" href="#sep-thrust-for-gpu-resident-photons-openmesh-for-meshfixing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>use interop Thrust/CUDA/OptiX to make photons fully GPU resident, eliminating overheads</li>
<li>add Torch for testing</li>
<li>investigate bad material for upwards going photons, find cause is bad geometry</li>
<li>integrate OpenMesh to enable mesh fixing</li>
</ul>
</div>
<div class="section" id="aug-big-geometry-handling-with-instancing">
<h2>2015 Aug : big geometry handling with Instancing<a class="headerlink" href="#aug-big-geometry-handling-with-instancing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>OptiX instancing</li>
<li>intro BBox standins</li>
<li>Thrust interop</li>
</ul>
</div>
<div class="section" id="jul-photon-index-propagation-histories-linux-port">
<h2>2015 Jul : photon index, propagation histories, Linux port<a class="headerlink" href="#jul-photon-index-propagation-histories-linux-port" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>photon indexing with Thrust</li>
<li>verifying ThrustIndex by comparison against the much slower SequenceNPY</li>
<li>auto-finding repeated geometry assemblies by progeny transform/mesh-index digests in GTreeCheck</li>
<li>interim Linux compatibility working with Tao</li>
<li>4-GPU machine testing with Tao</li>
<li>OpenGL instancing</li>
<li>trying to get JUNO geometry to work</li>
<li>computeTest timings for Juno Scintillation as vary CUDA core counts</li>
</ul>
</div>
<div class="section" id="jun-develop-compressed-photon-record-learn-thrust">
<h2>2015 Jun : develop compressed photon record, learn Thrust<a class="headerlink" href="#jun-develop-compressed-photon-record-learn-thrust" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>develop highly compressed photon records</li>
<li>ViewNPY machinery for OpenGL uploading</li>
<li>get animation working</li>
<li>add GOpticalSurface, for transporting surface props thru Assimp/AssimpWrap into GGeo</li>
<li>learning Thrust</li>
<li>OptiX 3.8 , CUDA 7.0 update</li>
</ul>
</div>
<div class="section" id="may-gpu-textures-for-materials-geocache-imgui">
<h2>2015 May : GPU textures for materials, geocache, ImGui<a class="headerlink" href="#may-gpu-textures-for-materials-geocache-imgui" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>start bringing materials to GPU via textures</li>
<li>introduce the geocache</li>
<li>material code translation in Lookup</li>
<li>adopt ImGui</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ideas.html" title="Ideas"
             >next</a> |</li>
        <li class="right" >
          <a href="abstracts.html" title="Opticks Abstracts"
             >previous</a> |</li>
        <li><a href="index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>