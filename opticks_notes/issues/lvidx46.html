<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>lvidx46 (15) &mdash; OpticksDevNotes 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpticksDevNotes 0.0.1 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lvidx46 (15)</a><ul>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#parsurf-xy-slimmer">parsurf xy slimmer</a></li>
<li><a class="reference internal" href="#viz">Viz</a></li>
<li><a class="reference internal" href="#gdml">GDML</a></li>
<li><a class="reference internal" href="#opticks-opticks-nnt-46">opticks-;opticks-nnt 46</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/issues/lvidx46.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="lvidx46-15">
<h1>lvidx46 (15)<a class="headerlink" href="#lvidx46-15" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Unusually an xy discrep, parsurf ~symmetrically slimmer in xy</p>
<ul class="simple">
<li>my analytic bbox matches closely the g4poly one</li>
<li>slimmer parsurf could be from my  OpenMesh join kludge</li>
<li>dont think there is issue with underlying CSG</li>
<li>familar PMT shape, intersection of three z-spheres and cylinder,
xy dimension comes from the intersect position of the middle two z-spheres  (b and c)</li>
</ul>
<div class="highlight-python"><pre>op --dlv46 --gltf 3
     g4poly mesh extends lower : is there a multi transform mis interpretation ?

     * ~/opticks_refs/lvidx46_gltf_3_pmthemivac_is_there_a_multitransform_mis_interpretation.png</pre>
</div>
</div>
<div class="section" id="parsurf-xy-slimmer">
<h2>parsurf xy slimmer<a class="headerlink" href="#parsurf-xy-slimmer" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>15   7.54053                   pmt-hemi-vac0xc21e248 lvidx  46 nsp    665                union intersection sphere cylinder   nds[672]  3200 3206 3212 3218 3224 3230 3236 3242 3248 3254 ...
     7.54053                   pmt-hemi-vac0xc21e248 lvidx  46 nsp    665

     amn (    -91.464   -91.464  -164.500)
     bmn (    -98.995   -99.003  -164.504)
     dmn (      7.531     7.539     0.004)

     amx (     91.464    91.464   128.000)
     bmx (     99.005    98.997   128.000)
     dmx (     -7.541    -7.533     0.000)

nnode::composite_bbox  left [ 0:in abc] right [ 0:cy d]  bb  mi (    -99.000   -99.000  -164.500) mx (     99.000    99.000   128.000) si (    198.000   198.000   292.500)</pre>
</div>
</div>
<div class="section" id="viz">
<h2>Viz<a class="headerlink" href="#viz" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>op --dlv46
     as expected loadsa triangulated PMTs in poly and raytrace

op --dlv46 --gltf 1
     as expected loadsa analytic PMTs

op --dlv46 --gltf 3
     g4poly mesh extends lower : is there a multi transform mis interpretation ?

     * ~/opticks_refs/lvidx46_gltf_3_pmthemivac_is_there_a_multitransform_mis_interpretation.png</pre>
</div>
<div class="highlight-python"><pre>78 # generated by tboolean.py : 20170706-1446
79 # opticks-;opticks-tbool 46
80 # opticks-;opticks-tbool-vi 46
81
82
83 a = CSG("sphere", param = [0.000,0.000,0.000,128.000],param1 = [0.000,0.000,0.000,0.000])
84 b = CSG("sphere", param = [0.000,0.000,0.000,99.000],param1 = [0.000,0.000,0.000,0.000])
85 b.transform = [[1.000,0.000,0.000,0.000],[0.000,1.000,0.000,0.000],[0.000,0.000,1.000,0.000],[0.000,0.000,43.000,1.000]]
86 ab = CSG("intersection", left=a, right=b)
87
88 c = CSG("sphere", param = [0.000,0.000,0.000,99.000],param1 = [0.000,0.000,0.000,0.000])
89 c.transform = [[1.000,0.000,0.000,0.000],[0.000,1.000,0.000,0.000],[0.000,0.000,1.000,0.000],[0.000,0.000,69.000,1.000]]
90 abc = CSG("intersection", left=ab, right=c)
91
92 d = CSG("cylinder", param = [0.000,0.000,0.000,39.250],param1 = [-83.000,83.000,0.000,0.000])
93 d.transform = [[1.000,0.000,0.000,0.000],[0.000,1.000,0.000,0.000],[0.000,0.000,1.000,0.000],[0.000,0.000,-81.500,1.000]]
94 abcd = CSG("union", left=abc, right=d)
95
96
97
98 obj = abcd</pre>
</div>
<p>z-Transforms on 3 primitives:</p>
<div class="highlight-python"><pre>.


                           abcd:union

           abc:intersection           d:cylinder
                                      (z -81.500)

     ab:intersection    c:sphere
                         (z +69)
  a:sphere   b:sphere
            (z +43)</pre>
</div>
<p>But they dont combine as not lined up...:</p>
<div class="highlight-python"><pre>// opticks-nnt 46

gt [ 0:in ab] NO gtransform
gt [ 0:sp a]  NO gtransform
gt [ 0:sp b]       gt.t
           1.000   0.000   0.000   0.000
           0.000   1.000   0.000   0.000
           0.000   0.000   1.000   0.000
           0.000   0.000  43.000   1.000

gt [ 0:sp c]       gt.t
           1.000   0.000   0.000   0.000
           0.000   1.000   0.000   0.000
           0.000   0.000   1.000   0.000
           0.000   0.000  69.000   1.000

gt [ 0:cy d]       gt.t
           1.000   0.000   0.000   0.000
           0.000   1.000   0.000   0.000
           0.000   0.000   1.000   0.000
           0.000   0.000 -81.500   1.000</pre>
</div>
</div>
<div class="section" id="gdml">
<h2>GDML<a class="headerlink" href="#gdml" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><em>deltatheta=180</em> is full sphere : so no z-sphere needed</li>
</ul>
<div class="highlight-python"><pre>704     &lt;sphere aunit="deg" deltaphi="360" deltatheta="180" lunit="mm" name="pmt-hemi-face-vac0xbf6d5e0" rmax="128" rmin="0" startphi="0" starttheta="0"/&gt;
705     &lt;sphere aunit="deg" deltaphi="360" deltatheta="180" lunit="mm" name="pmt-hemi-top-vac0xc2f4260" rmax="99" rmin="0" startphi="0" starttheta="0"/&gt;

706     &lt;intersection name="pmt-hemi-face-vac*ChildForpmt-hemi-bulb-vac0xbf1f680"&gt;
707       &lt;first ref="pmt-hemi-face-vac0xbf6d5e0"/&gt;
708       &lt;second ref="pmt-hemi-top-vac0xc2f4260"/&gt;
709       &lt;position name="pmt-hemi-face-vac*ChildForpmt-hemi-bulb-vac0xbf1f680_pos" unit="mm" x="0" y="0" z="43"/&gt;
710     &lt;/intersection&gt;

711     &lt;sphere aunit="deg" deltaphi="360" deltatheta="180" lunit="mm" name="pmt-hemi-bot-vac0xc2f4370" rmax="99" rmin="0" startphi="0" starttheta="0"/&gt;

712     &lt;intersection name="pmt-hemi-bulb-vac0xc21e200"&gt;
713       &lt;first ref="pmt-hemi-face-vac*ChildForpmt-hemi-bulb-vac0xbf1f680"/&gt;
714       &lt;second ref="pmt-hemi-bot-vac0xc2f4370"/&gt;
715       &lt;position name="pmt-hemi-bulb-vac0xc21e200_pos" unit="mm" x="0" y="0" z="69"/&gt;
716     &lt;/intersection&gt;

717     &lt;tube aunit="deg" deltaphi="360" lunit="mm" name="pmt-hemi-base-vac0xc133310" rmax="39.25" rmin="0" startphi="0" z="166"/&gt;

718     &lt;union name="pmt-hemi-vac0xc21e248"&gt;
719       &lt;first ref="pmt-hemi-bulb-vac0xc21e200"/&gt;
720       &lt;second ref="pmt-hemi-base-vac0xc133310"/&gt;
721       &lt;position name="pmt-hemi-vac0xc21e248_pos" unit="mm" x="0" y="0" z="-81.5"/&gt;
722     &lt;/union&gt;</pre>
</div>
</div>
<div class="section" id="opticks-opticks-nnt-46">
<h2>opticks-;opticks-nnt 46<a class="headerlink" href="#opticks-opticks-nnt-46" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>simon:opticks_refs blyth$ opticks-;opticks-nnt 46
opticks-nnt : compiling /usr/local/opticks/opticksdata/export/DayaBay_VGDX_20140414-1300/extras/46/NNodeTest_46.cc
 du [ 0:un abcd] OPER  v:1 2017-07-07 11:59:44.795 INFO  [3793907] [nnode::bbox@414] nnode::bbox [ 0:un abcd]
nbbox::CombineCSG   BB(A+B)
 L  mi (    -99.000   -99.000   -30.000) mx (     99.000    99.000   128.000) si (    198.000   198.000   158.000)
 R  mi (    -39.250   -39.250  -164.500) mx (     39.250    39.250     1.500) si (     78.500    78.500   166.000)
 C  mi (    -99.000   -99.000  -164.500) mx (     99.000    99.000   128.000) si (    198.000   198.000   292.500)
nnode::composite_bbox  left [ 0:in abc] right [ 0:cy d]  bb  mi (    -99.000   -99.000  -164.500) mx (     99.000    99.000   128.000) si (    198.000   198.000   292.500)
 bb  mi (    -99.000   -99.000  -164.500) mx (     99.000    99.000   128.000) si (    198.000   198.000   292.500)

 du [ 0:in abc] OPER  v:0  bb  mi (    -99.000   -99.000   -30.000) mx (     99.000    99.000   128.000) si (    198.000   198.000   158.000)

 du [ 0:in ab] OPER  v:0  bb  mi (    -99.000   -99.000   -56.000) mx (     99.000    99.000   128.000) si (    198.000   198.000   184.000)

 du [ 0:sp a]  PRIM  v:0  bb  mi (   -128.000  -128.000  -128.000) mx (    128.000   128.000   128.000) si (    256.000   256.000   256.000)
 gt [ 0:sp a]  NO gtransform
 du [ 0:sp b]  PRIM  v:0  bb  mi (    -99.000   -99.000   -56.000) mx (     99.000    99.000   142.000) si (    198.000   198.000   198.000)
 gt [ 0:sp b]       gt.t</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>