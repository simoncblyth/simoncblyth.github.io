<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JUNO JPMT Shakedown &mdash; OpticksDevNotes 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="OpticksDevNotes 0.0.1 documentation" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">JUNO JPMT Shakedown</a><ul>
<li><a class="reference internal" href="#issue-default-torch-source-goes-off-somewhere-in-tt">Issue : default torch source goes off somewhere in TT</a></li>
<li><a class="reference internal" href="#issue-segv-due-to-no-input-gensteps">Issue : segv due to no input gensteps</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/issues/geant4_opticks_integration/juno_jpmt_viz_shakedown.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="juno-jpmt-shakedown">
<h1>JUNO JPMT Shakedown<a class="headerlink" href="#juno-jpmt-shakedown" title="Permalink to this headline">¶</a></h1>
<div class="section" id="issue-default-torch-source-goes-off-somewhere-in-tt">
<h2>Issue : default torch source goes off somewhere in TT<a class="headerlink" href="#issue-default-torch-source-goes-off-somewhere-in-tt" title="Permalink to this headline">¶</a></h2>
<p>TODO: reposition into CD</p>
<p>Reproduce:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">op</span> <span class="o">--</span><span class="n">jpmt</span>
</pre></div>
</div>
</div>
<div class="section" id="issue-segv-due-to-no-input-gensteps">
<h2>Issue : segv due to no input gensteps<a class="headerlink" href="#issue-segv-due-to-no-input-gensteps" title="Permalink to this headline">¶</a></h2>
<p>Segv with new override &#8211;noload:</p>
<div class="highlight-python"><pre>simon:optickscore blyth$ tviz-jpmt-cerenkov --noload
288 -rwxr-xr-x  1 blyth  staff  145904 Dec  8 21:07 /usr/local/opticks/lib/OKTest
proceeding : /usr/local/opticks/lib/OKTest --jpmt --jwire --target 64670 --load --animtimemax 200 --timemax 200 --optixviz --fullscreen --cerenkov --noload
2016-12-08 21:09:08.884 INFO  [500343] [OpticksDbg::postconfigure@49] OpticksDbg::postconfigure OpticksDbg  debug_photon  size: 0 elem: () other_photon  size: 0 elem: ()
2016-12-08 21:09:08.884 WARN  [500343] [BTree::loadTree@48] BTree.loadTree: can't find file /usr/local/opticks/opticksdata/export/juno/ChromaMaterialMap.json
2016-12-08 21:09:08.884 FATAL [500343] [NSensorList::read@122] NSensorList::read failed to open /usr/local/opticks/opticksdata/export/juno/test3.idmap
2016-12-08 21:09:08.884 INFO  [500343] [*GMergedMesh::load@591] GMergedMesh::load dir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/0 -&gt; cachedir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/0 index 0 version (null) existsdir 1
2016-12-08 21:09:09.142 INFO  [500343] [*GMergedMesh::load@591] GMergedMesh::load dir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/1 -&gt; cachedir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/1 index 1 version (null) existsdir 1
2016-12-08 21:09:09.180 INFO  [500343] [*GMergedMesh::load@591] GMergedMesh::load dir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/2 -&gt; cachedir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/2 index 2 version (null) existsdir 1
2016-12-08 21:09:09.202 INFO  [500343] [*GMergedMesh::load@591] GMergedMesh::load dir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/3 -&gt; cachedir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/3 index 3 version (null) existsdir 1
2016-12-08 21:09:09.204 INFO  [500343] [*GMergedMesh::load@591] GMergedMesh::load dir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/4 -&gt; cachedir /usr/local/opticks/opticksdata/export/juno/test3.fcc8b4dc9474af8826b29bf172452160.dae/GMergedMesh/4 index 4 version (null) existsdir 1
2016-12-08 21:09:09.218 INFO  [500343] [GMaterialLib::postLoadFromCache@67] GMaterialLib::postLoadFromCache  nore 0 noab 0 nosc 0 xxre 0 xxab 0 xxsc 0 fxre 0 fxab 0 fxsc 0 groupvel 1
2016-12-08 21:09:09.218 INFO  [500343] [GMaterialLib::replaceGROUPVEL@552] GMaterialLib::replaceGROUPVEL  ni 17
2016-12-08 21:09:09.218 INFO  [500343] [GPropertyLib::getIndex@338] GPropertyLib::getIndex type GMaterialLib TRIGGERED A CLOSE  shortname [Acrylic]
2016-12-08 21:09:09.218 INFO  [500343] [GPropertyLib::close@384] GPropertyLib::close type GMaterialLib buf 17,2,39,4
2016-12-08 21:09:09.220 WARN  [500343] [*GPmt::load@51] GPmt::load resource does not exist /usr/local/opticks/opticksdata/export/juno/GPmt/0
2016-12-08 21:09:09.228 WARN  [500343] [OpticksGen::initInputGensteps@58] OpticksGen::initInputGensteps SKIP as isNoInputGensteps
2016-12-08 21:09:09.228 INFO  [500343] [SLog::operator@15] OpticksHub::OpticksHub DONE
2016-12-08 21:09:09.230 FATAL [500343] [OpticksHub::configureState@196] OpticksHub::configureState NState::description /Users/blyth/.opticks/juno/State state dir /Users/blyth/.opticks/juno/State
2016-12-08 21:09:09.230 WARN  [500343] [OpticksViz::prepareScene@179] disable GeometryStyle  WIRE for JUNO as too slow
2016-12-08 21:09:09.230 INFO  [500343] [OpticksViz::prepareScene@190] App::prepareViz axis,genstep,nopstep,photon,record,bb0,bb1,
Full screen windows cannot be moved2016-12-08 21:09:09.881 INFO  [500343] [OpticksViz::uploadGeometry@229] Opticks time 0.0000,200.0000,200.0000,0.0000 space 0.0000,0.0000,9300.0000,33550.0000 wavelength 60.0000,820.0000,20.0000,760.0000
2016-12-08 21:09:09.998 INFO  [500343] [OpticksGeometry::setTarget@129] OpticksGeometry::setTarget  target 0 aim 1 ce  0 0 9300 33550
2016-12-08 21:09:09.998 INFO  [500343] [Composition::setCenterExtent@991] Composition::setCenterExtent ce 0.0000,0.0000,9300.0000,33550.0000
2016-12-08 21:09:09.998 INFO  [500343] [SLog::operator@15] OpticksViz::OpticksViz DONE
2016-12-08 21:09:12.923 INFO  [500343] [SLog::operator@15] OScene::OScene DONE
2016-12-08 21:09:12.923 FATAL [500343] [*OContext::addEntry@44] OContext::addEntry G
2016-12-08 21:09:12.923 INFO  [500343] [SLog::operator@15] OEvent::OEvent DONE
2016-12-08 21:09:14.246 INFO  [500343] [SLog::operator@15] OPropagator::OPropagator DONE
2016-12-08 21:09:14.246 INFO  [500343] [SLog::operator@15] OpEngine::OpEngine DONE
2016-12-08 21:09:14.265 FATAL [500343] [*OContext::addEntry@44] OContext::addEntry P
2016-12-08 21:09:14.265 INFO  [500343] [SLog::operator@15] OKGLTracer::OKGLTracer DONE
2016-12-08 21:09:14.265 INFO  [500343] [SLog::operator@15] OKPropagator::OKPropagator DONE
OKMgr::init
   OptiXVersion :            3080
2016-12-08 21:09:14.265 INFO  [500343] [SLog::operator@15] OKMgr::OKMgr DONE
/Users/blyth/opticks/bin/op.sh: line 580: 54224 Segmentation fault: 11  /usr/local/opticks/lib/OKTest --jpmt --jwire --target 64670 --load --animtimemax 200 --timemax 200 --optixviz --fullscreen --cerenkov --noload
/Users/blyth/opticks/bin/op.sh RC 139
simon:optickscore blyth$
simon:optickscore blyth$
simon:optickscore blyth$ tviz-jpmt-cerenkov --noload</pre>
</div>
<div class="highlight-python"><pre>tviz-;tviz-jpmt-cerenkov --noload --debugger


(lldb) bt
* thread #1: tid = 0x8265a, 0x000000010067cb8d libNPY.dylib`NPYBase::getItemShape(unsigned int) [inlined] std::__1::vector&lt;int, std::__1::allocator&lt;int&gt; &gt;::size(this=0x0000000000000070) const at vector:656, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x78)
  * frame #0: 0x000000010067cb8d libNPY.dylib`NPYBase::getItemShape(unsigned int) [inlined] std::__1::vector&lt;int, std::__1::allocator&lt;int&gt; &gt;::size(this=0x0000000000000070) const at vector:656
    frame #1: 0x000000010067cb8d libNPY.dylib`NPYBase::getItemShape(this=0x0000000000000000, ifr=0) + 1341 at NPYBase.cpp:592
    frame #2: 0x0000000100679c62 libNPY.dylib`NPYBase::getShapeString(this=0x0000000000000000, ifr=0) + 34 at NPYBase.cpp:586
    frame #3: 0x000000010097d5f4 libOpticksCore.dylib`OpticksRun::setGensteps(this=0x00000001055220f0, gensteps=0x0000000000000000) + 180 at OpticksRun.cc:77
    frame #4: 0x00000001037be8b0 libOK.dylib`OKMgr::propagate(this=0x00007fff5fbfea78) + 272 at OKMgr.cc:94
    frame #5: 0x000000010000a9f2 OKTest`main(argc=15, argv=0x00007fff5fbfeb50) + 1378 at OKTest.cc:61
    frame #6: 0x00007fff8aded5fd libdyld.dylib`start + 1
(lldb)

(lldb) f 4
frame #4: 0x00000001037be8b0 libOK.dylib`OKMgr::propagate(this=0x00007fff5fbfea98) + 272 at OKMgr.cc:94
   91           {
   92               m_run-&gt;createEvent(i);
   93
-&gt; 94               m_run-&gt;setGensteps(m_gen-&gt;getInputGensteps());
   95
   96               m_propagator-&gt;propagate();
   97

   75   void OpticksRun::setGensteps(NPY&lt;float&gt;* gensteps)
   76   {
-&gt; 77       LOG(info) &lt;&lt; "OpticksRun::setGensteps " &lt;&lt; gensteps-&gt;getShapeString() ;
   78
   79       assert(m_evt &amp;&amp; m_g4evt &amp;&amp; "must OpticksRun::createEvent prior to OpticksRun::setGensteps");
   80</pre>
</div>
<div class="highlight-python"><pre>2016-12-09 12:33:57.668 INFO  [538973] [SLog::operator@15] OKMgr::OKMgr DONE
2016-12-09 12:33:57.668 FATAL [538973] [OpticksRun::setGensteps@78] OpticksRun::setGensteps given NULL gensteps
Assertion failed: (!no_gensteps), function setGensteps, file /Users/blyth/opticks/optickscore/OpticksRun.cc, line 79.
Process 62799 stopped</pre>
</div>
<p>Hmm the tviz was setup prior to OKG4 so &#8211;noload is not going to work without some effort.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>