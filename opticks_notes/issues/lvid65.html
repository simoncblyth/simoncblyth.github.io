<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>lvidx65 : SstBotCirRibBase0xc26e2d0 /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220 &mdash; OpticksDevNotes 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpticksDevNotes 0.0.1 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lvidx65 : SstBotCirRibBase0xc26e2d0 /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220</a><ul>
<li><a class="reference internal" href="#lvidx65-first-cause-tube-deltaphi-is-not-handled">lvidx65 : First Cause : tube deltaphi is not handled</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/issues/lvid65.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="lvidx65-sstbotcirribbase0xc26e2d0-dd-geometry-addetails-lvsstbotcirribbase0xc26e220">
<h1>lvidx65 : SstBotCirRibBase0xc26e2d0 /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220<a class="headerlink" href="#lvidx65-sstbotcirribbase0xc26e2d0-dd-geometry-addetails-lvsstbotcirribbase0xc26e220" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>CAUSE FOUND : need to implement tube deltaphi</li>
<li><a class="reference internal" href=""><em>lvidx65 : SstBotCirRibBase0xc26e2d0 /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220</em></a></li>
</ul>
<div class="highlight-python"><pre>DBGMESH=SstBotCirRibBase0x NSceneMeshTest

op --dlv65             # just one instance of lvid 65 inside container : gives just small portion of cylinder
op --dlv65 --gltf 1    # hmm .. instancing kicks in and duplicates it...

op --dlv65 --gltf 1 --gltfconfig disable_instancing=1    #  gives entire cylinder with cut ?</pre>
</div>
<div class="highlight-python"><pre>Difference of two big cylinders with two long "spoke" boxes subtracted, ..
but spokes are offset and one is rotated.

~/opticks_refs/lvid65_cycybobo_to_union.png
     changing difference to union, its clear that only one of boxes intersects
     yielding the cut : suspicious



             0:di

         1:di      2:bo

      3:di   4:bo

   7:cy 8:cy</pre>
</div>
<div class="highlight-python"><pre>4214     &lt;volume name="/dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220"&gt;
4215       &lt;materialref ref="/dd/Materials/StainlessSteel0xc2adc00"/&gt;
4216       &lt;solidref ref="SstBotCirRibBase0xc26e2d0"/&gt;
4217     &lt;/volume&gt;

1028     &lt;subtraction name="SstBotCirRibBase0xc26e2d0"&gt;
1029       &lt;first ref="SstBotCirRibPri-ChildForSstBotCirRibBase0xc26e0a0"/&gt;
1030       &lt;second ref="SstBotRibBase10xbfa4950"/&gt;
1031       &lt;position name="SstBotCirRibBase0xc26e2d0_pos" unit="mm" x="887.419010389117" y="887.419010389117" z="0"/&gt;
1032       &lt;rotation name="SstBotCirRibBase0xc26e2d0_rot" unit="deg" x="0" y="0" z="45"/&gt;
1033     &lt;/subtraction&gt;

1022     &lt;subtraction name="SstBotCirRibPri-ChildForSstBotCirRibBase0xc26e0a0"&gt;
1023       &lt;first ref="SstBotCirRibPri0xc26d4e0"/&gt;
1024       &lt;second ref="SstBotRibBase00xc0d1e90"/&gt;
1025       &lt;position name="SstBotCirRibPri-ChildForSstBotCirRibBase0xc26e0a0_pos" unit="mm" x="1255" y="0" z="0"/&gt;
1026     &lt;/subtraction&gt;

1020     &lt;tube aunit="deg" deltaphi="45" lunit="mm" name="SstBotCirRibPri0xc26d4e0" rmax="2000" rmin="1980" startphi="0" z="430"/&gt;
1027     &lt;box lunit="mm" name="SstBotRibBase10xbfa4950" x="2020" y="25" z="440"/&gt;</pre>
</div>
<div class="section" id="lvidx65-first-cause-tube-deltaphi-is-not-handled">
<h2>lvidx65 : First Cause : tube deltaphi is not handled<a class="headerlink" href="#lvidx65-first-cause-tube-deltaphi-is-not-handled" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>simon:boostrap blyth$ grep deltaphi /tmp/g4_00.gdml  | grep -v \"360\"
    &lt;tube aunit="deg" deltaphi="44.6352759021238" lunit="mm" name="BlackCylinder0xc1762e8" rmax="2262.15" rmin="2259.15" startphi="0" z="997"/&gt;
    &lt;tube aunit="deg" deltaphi="45" lunit="mm" name="SstBotCirRibPri0xc26d4e0" rmax="2000" rmin="1980" startphi="0" z="430"/&gt;
    &lt;tube aunit="deg" deltaphi="45" lunit="mm" name="SstTopCirRibPri0xc2648b8" rmax="1220" rmin="1200" startphi="0" z="231.89"/&gt;
    &lt;sphere aunit="deg" deltaphi="180" deltatheta="180" lunit="mm" name="UpperAcrylicHemisphere0xc0b2ac0" rmax="10.035" rmin="0" startphi="0" starttheta="0"/&gt;
    &lt;sphere aunit="deg" deltaphi="180" deltatheta="180" lunit="mm" name="LowerAcrylicHemisphere0xc0b2be8" rmax="10.035" rmin="0" startphi="0" starttheta="0"/&gt;
simon:boostrap blyth$</pre>
</div>
<div class="highlight-python"><pre>opticks-tbool-vi 65
opticks-tbool 65     # ana CSG level viz : looks like a cylinder ring with one cut



62 tbool65--(){ cat &lt;&lt; EOP
63
64 import logging
65 import numpy as np
66 log = logging.getLogger(__name__)
67 from opticks.ana.base import opticks_main
68 from opticks.analytic.csg import CSG
69 args = opticks_main(csgpath="$TMP/tbool/65")
70
71 CSG.boundary = args.testobject
72 CSG.kwa = dict(verbosity="0", poly="IM", resolution="20")
73 #CSG.kwa = dict(verbosity="0", poly="HY", level="5")
74
75
76 a = CSG("cylinder", param = [0.000,0.000,0.000,2000.000],param1 = [-215.000,215.000,0.000,0.000])
77 b = CSG("cylinder", param = [0.000,0.000,0.000,1980.000],param1 = [-217.150,217.150,0.000,0.000])
78 ab = CSG("difference", left=a, right=b)
79
80 c = CSG("box3", param = [2020.000,25.000,440.000,0.000],param1 = [0.000,0.000,0.000,0.000])
81 c.transform = [[1.000,0.000,0.000,0.000],[0.000,1.000,0.000,0.000],[0.000,0.000,1.000,0.000],[1255.000,0.000,0.000,1.000]]
82 abc = CSG("difference", left=ab, right=c)
83
84 d = CSG("box3", param = [2020.000,25.000,440.000,0.000],param1 = [0.000,0.000,0.000,0.000])
85 d.transform = [[0.707,-0.707,0.000,0.000],[0.707,0.707,0.000,0.000],[0.000,0.000,1.000,0.000],[887.419,887.419,0.000,1.000]]
86 abcd = CSG("difference", left=abc, right=d)
87
88
89
90 obj = abcd
91
92 con = CSG("sphere",  param=[0,0,0,10], container="1", containerscale="2", boundary=args.container , poly="IM", resolution="20" )
93 CSG.Serialize([con, obj], args.csgpath )
94
95 EOP
96 }</pre>
</div>
<div class="highlight-python"><pre>DBGMESH=SstBotCirRibBase0x NSceneMeshTest
...
2017-07-03 20:58:17.359 INFO  [2996117] [NScene::dumpCSG@412] NScene::dumpCSG num_csg 249 dbgmesh SstBotCirRibBase0x
2017-07-03 20:58:17.359 INFO  [2996117] [NCSG::dump@905] NCSG::dump
 NCSG  ix   76 surfpoints   33 so SstBotCirRibBase0xc26e2d0                lv /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220
NCSG::dump (root) [ 0:di] OPER  v:0
         L [ 1:di] OPER  v:0
         L [ 3:di] OPER  v:0
         L [ 7:cy] PRIM  v:0 bb  mi  (-2000.00 -2000.00 -215.00)  mx  (2000.00 2000.00  215.00)  si  (4000.00 4000.00  430.00)
         R [ 8:cy] PRIM  v:0 bb  mi  (-1980.00 -1980.00 -217.15)  mx  (1980.00 1980.00  217.15)  si  (3960.00 3960.00  434.30)
         R [ 4:bo] PRIM  v:0 bb  mi  ( 245.00  -12.50 -220.00)  mx  (2265.00   12.50  220.00)  si  (2020.00   25.00  440.00)
         R [ 2:bo] PRIM  v:0 bb  mi  ( 164.40  164.40 -220.00)  mx  (1610.44 1610.44  220.00)  si  (1446.03 1446.03  440.00)
 composite_bb  mi  (-2000.00 -2000.00 -215.00)  mx  (2000.00 2000.00  215.00)  si  (4000.00 4000.00  430.00)
NParameters::dump</pre>
</div>
<div class="highlight-python"><pre>simon:ggeo blyth$ DBGMESH=SstBotCirRibBase0x NSceneMeshTest
2017-07-03 20:58:12.915 INFO  [2996117] [NGLTF::load@35] NGLTF::load path /tmp/blyth/opticks/tgltf-t-/sc.gltf
2017-07-03 20:58:13.431 INFO  [2996117] [NGLTF::load@62] NGLTF::load DONE
2017-07-03 20:58:13.457 INFO  [2996117] [NSceneConfig::NSceneConfig@12] NSceneConfig::NSceneConfig cfg check_surf_containment=0,check_aabb_containment=0
        check_surf_containment :                    0
        check_aabb_containment :                    0
2017-07-03 20:58:13.457 INFO  [2996117] [NScene::init@140] NScene::init START age(s) 12311 days   0.142
2017-07-03 20:58:13.457 INFO  [2996117] [NScene::load_csg_metadata@252] NScene::load_csg_metadata verbosity 1 num_meshes 249
2017-07-03 20:58:13.875 INFO  [2996117] [NScene::postimportnd@491] NScene::postimportnd numNd 12230 num_selected 12230 dbgnode -1 dbgnode_list 0 verbosity 1
2017-07-03 20:58:14.048 INFO  [2996117] [NScene::count_progeny_digests@866] NScene::count_progeny_digests verbosity 1 node_count 12230 digest_size 249
2017-07-03 20:58:15.328 INFO  [2996117] [NNodeUncoincide::uncoincide_treewise@340] NNodeUncoincide::uncoincide_tree TRYING root.left UNCOINCIDE_UNCYCO  root union difference cylinder cone  left union cylinder  right cone
2017-07-03 20:58:15.727 INFO  [2996117] [NNodeUncoincide::uncoincide_treewise@340] NNodeUncoincide::uncoincide_tree TRYING root.left UNCOINCIDE_UNCYCO  root union difference cylinder cone  left union cylinder  right cone
2017-07-03 20:58:15.769 INFO  [2996117] [NNodeUncoincide::uncoincide_treewise@340] NNodeUncoincide::uncoincide_tree TRYING root.left UNCOINCIDE_UNCYCO  root union difference cylinder cone  left union cylinder  right cone
2017-07-03 20:58:17.358 INFO  [2996117] [NScene::postimportmesh@509] NScene::postimportmesh numNd 12230 dbgnode -1 dbgnode_list 0 verbosity 1
                  check_surf_containment : 0
                  check_aabb_containment : 0
2017-07-03 20:58:17.359 INFO  [2996117] [NScene::init@180] NScene::init DONE
2017-07-03 20:58:17.359 INFO  [2996117] [NScene::dumpCSG@412] NScene::dumpCSG num_csg 249 dbgmesh SstBotCirRibBase0x
2017-07-03 20:58:17.359 INFO  [2996117] [NCSG::dump@905] NCSG::dump
 NCSG  ix   76 surfpoints   33 so SstBotCirRibBase0xc26e2d0                lv /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220
NCSG::dump (root) [ 0:di] OPER  v:0
         L [ 1:di] OPER  v:0
         L [ 3:di] OPER  v:0
         L [ 7:cy] PRIM  v:0 bb  mi  (-2000.00 -2000.00 -215.00)  mx  (2000.00 2000.00  215.00)  si  (4000.00 4000.00  430.00)
         R [ 8:cy] PRIM  v:0 bb  mi  (-1980.00 -1980.00 -217.15)  mx  (1980.00 1980.00  217.15)  si  (3960.00 3960.00  434.30)
         R [ 4:bo] PRIM  v:0 bb  mi  ( 245.00  -12.50 -220.00)  mx  (2265.00   12.50  220.00)  si  (2020.00   25.00  440.00)
         R [ 2:bo] PRIM  v:0 bb  mi  ( 164.40  164.40 -220.00)  mx  (1610.44 1610.44  220.00)  si  (1446.03 1446.03  440.00)
 composite_bb  mi  (-2000.00 -2000.00 -215.00)  mx  (2000.00 2000.00  215.00)  si  (4000.00 4000.00  430.00)
NParameters::dump
         lvname : /dd/Geometry/AdDetails/lvSstBotCirRibBase0xc26e220
         soname : SstBotCirRibBase0xc26e2d0
      verbosity :               0
     resolution :              20
           poly :              IM
         height :               3
2017-07-03 20:58:17.359 INFO  [2996117] [NCSG::dump_surface_points@1195] dsp num_sp 33 dmax 200
 i    0 sp (     -0.000  2000.000  -215.000)
 i    1 sp (  -2000.000    -0.000  -215.000)
 i    2 sp (      0.000 -2000.000  -215.000)
 i    3 sp (     -0.000  2000.000  -112.875)
 i    4 sp (  -2000.000    -0.000  -112.875)
 i    5 sp (      0.000 -2000.000  -112.875)
 i    6 sp (     -0.000  2000.000   -10.750)
 i    7 sp (  -2000.000    -0.000   -10.750)
 i    8 sp (      0.000 -2000.000   -10.750)
 i    9 sp (     -0.000  2000.000    91.375)
 i   10 sp (  -2000.000    -0.000    91.375)
 i   11 sp (      0.000 -2000.000    91.375)
 i   12 sp (     -0.000  2000.000   193.500)
 i   13 sp (  -2000.000    -0.000   193.500)
 i   14 sp (      0.000 -2000.000   193.500)
 i   15 sp (     -0.000  2000.000   215.000)
 i   16 sp (  -2000.000    -0.000   215.000)
 i   17 sp (      0.000 -2000.000   215.000)
 i   18 sp (     -0.000  2000.000  -215.000)
 i   19 sp (  -2000.000    -0.000  -215.000)
 i   20 sp (      0.000 -2000.000  -215.000)
 i   21 sp (     -0.000  1980.000  -114.004)
 i   22 sp (  -1980.000    -0.000  -114.004)
 i   23 sp (      0.000 -1980.000  -114.004)
 i   24 sp (     -0.000  1980.000   -10.857)
 i   25 sp (  -1980.000    -0.000   -10.857)
 i   26 sp (      0.000 -1980.000   -10.857)
 i   27 sp (     -0.000  1980.000    92.289)
 i   28 sp (  -1980.000    -0.000    92.289)
 i   29 sp (      0.000 -1980.000    92.289)
 i   30 sp (     -0.000  1980.000   195.435)
 i   31 sp (  -1980.000    -0.000   195.435)
 i   32 sp (      0.000 -1980.000   195.435)
 csg.index (mesh_id) 76 num nodes 16
 node idx :  4440 4441 4442 4443 4444 4445 4446 4447 6100 6101 ...</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">OpticksDevNotes 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Simon C Blyth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>